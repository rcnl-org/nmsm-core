function [Mat] = PatientSpecificSurrogateModel(DOF,DOFVel,nMusc)
onesCol = ones(size(DOF, 1), 1);
zeroCol = zeros(size(DOF, 1), 1);
    switch nMusc
    case 1
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 2
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 3
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 4
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 5
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 6
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 7
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
        LMT = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot2.*theta4 + tdot4.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 5.*tdot4.*theta4.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;];
    case 8
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
        LMT = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        VMT = [ tdot1, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 4.*tdot1.*theta1.^3, 5.*tdot1.*theta1.^4, zeroCol,];
        R1= [ -onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        Mat = [LMT;VMT;R1;];
    case 9
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 10
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 11
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 12
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 13
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 14
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 15
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 16
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 17
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 18
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 19
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 20
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 21
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 22
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 23
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 24
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 25
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
        LMT = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot2.*theta4 + tdot4.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 5.*tdot4.*theta4.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;];
    case 26
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 27
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 28
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 29
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 30
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 31
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
            theta5=DOF(:, 5);
            tdot5=DOFVel(:, 5);
            theta6=DOF(:, 6);
            tdot6=DOFVel(:, 6);
        LMT = [ theta1, theta2, theta3, theta4, theta5, theta6, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^2.*theta5.^2, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta1.^2.*theta5.^3, theta1.^2.*theta6.^2, theta1.^3.*theta5.^2, theta2.^2.*theta4.^3, theta2.^2.*theta5.^2, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta1.^2.*theta6.^3, theta1.^3.*theta6.^2, theta2.^2.*theta5.^3, theta2.^2.*theta6.^2, theta2.^3.*theta5.^2, theta3.^2.*theta4.^3, theta3.^2.*theta5.^2, theta3.^3.*theta4.^2, theta2.^2.*theta6.^3, theta2.^3.*theta6.^2, theta3.^2.*theta5.^3, theta3.^2.*theta6.^2, theta3.^3.*theta5.^2, theta4.^2.*theta5.^2, theta3.^2.*theta6.^3, theta3.^3.*theta6.^2, theta4.^2.*theta5.^3, theta4.^2.*theta6.^2, theta4.^3.*theta5.^2, theta4.^2.*theta6.^3, theta4.^3.*theta6.^2, theta5.^2.*theta6.^2, theta5.^2.*theta6.^3, theta5.^3.*theta6.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta1.*theta5, theta2.*theta4, theta1.*theta6, theta2.*theta5, theta3.*theta4, theta2.*theta6, theta3.*theta5, theta3.*theta6, theta4.*theta5, theta4.*theta6, theta5.*theta6, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta1.*theta5.^2, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^2.*theta5, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta1.*theta5.^3, theta1.*theta6.^2, theta2.*theta3.^4, theta2.*theta4.^3, theta2.*theta5.^2, theta3.*theta4.^2, theta1.^2.*theta6, theta1.^3.*theta5, theta2.^2.*theta5, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta1.*theta5.^4, theta1.*theta6.^3, theta2.*theta4.^4, theta2.*theta5.^3, theta2.*theta6.^2, theta3.*theta4.^3, theta3.*theta5.^2, theta1.^3.*theta6, theta2.^2.*theta6, theta1.^4.*theta5, theta2.^3.*theta5, theta3.^2.*theta5, theta2.^4.*theta4, theta3.^3.*theta4, theta1.*theta6.^4, theta2.*theta5.^4, theta2.*theta6.^3, theta3.*theta4.^4, theta3.*theta5.^3, theta3.*theta6.^2, theta4.*theta5.^2, theta1.^4.*theta6, theta2.^3.*theta6, theta3.^2.*theta6, theta2.^4.*theta5, theta3.^3.*theta5, theta4.^2.*theta5, theta3.^4.*theta4, theta2.*theta6.^4, theta3.*theta5.^4, theta3.*theta6.^3, theta4.*theta5.^3, theta4.*theta6.^2, theta2.^4.*theta6, theta3.^3.*theta6, theta4.^2.*theta6, theta3.^4.*theta5, theta4.^3.*theta5, theta3.*theta6.^4, theta4.*theta5.^4, theta4.*theta6.^3, theta5.*theta6.^2, theta3.^4.*theta6, theta4.^3.*theta6, theta5.^2.*theta6, theta4.^4.*theta5, theta4.*theta6.^4, theta5.*theta6.^3, theta4.^4.*theta6, theta5.^3.*theta6, theta5.*theta6.^4, theta5.^4.*theta6, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta5.^2, theta3.^5, theta4.^4, theta5.^3, theta6.^2, theta4.^5, theta5.^4, theta6.^3, theta5.^5, theta6.^4, theta6.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta2.*theta5.^2, theta1.*theta3.*theta4.^2, theta1.*theta2.^2.*theta5, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta2.*theta5, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta2.*theta5.^3, theta1.*theta2.*theta6.^2, theta1.*theta3.*theta4.^3, theta1.*theta3.*theta5.^2, theta1.*theta2.^2.*theta6, theta1.*theta2.^3.*theta5, theta1.*theta3.^2.*theta5, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^2.*theta2.*theta6, theta1.^2.*theta3.*theta5, theta1.^3.*theta2.*theta5, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta1.*theta2.*theta6.^3, theta1.*theta3.*theta5.^3, theta1.*theta3.*theta6.^2, theta1.*theta4.*theta5.^2, theta1.*theta2.^3.*theta6, theta1.*theta3.^2.*theta6, theta1.*theta3.^3.*theta5, theta1.*theta4.^2.*theta5, theta2.*theta3.*theta4.^3, theta2.*theta3.*theta5.^2, theta2.*theta3.^2.*theta5, theta2.*theta3.^3.*theta4, theta1.^2.*theta3.*theta6, theta1.^2.*theta4.*theta5, theta1.^3.*theta2.*theta6, theta1.^3.*theta3.*theta5, theta2.^2.*theta3.*theta5, theta2.^3.*theta3.*theta4, theta1.*theta3.*theta6.^3, theta1.*theta4.*theta5.^3, theta1.*theta4.*theta6.^2, theta1.*theta3.^3.*theta6, theta1.*theta4.^2.*theta6, theta1.*theta4.^3.*theta5, theta2.*theta3.*theta5.^3, theta2.*theta3.*theta6.^2, theta2.*theta4.*theta5.^2, theta2.*theta3.^2.*theta6, theta2.*theta3.^3.*theta5, theta2.*theta4.^2.*theta5, theta1.^2.*theta4.*theta6, theta1.^3.*theta3.*theta6, theta1.^3.*theta4.*theta5, theta2.^2.*theta3.*theta6, theta2.^2.*theta4.*theta5, theta2.^3.*theta3.*theta5, theta1.*theta4.*theta6.^3, theta1.*theta5.*theta6.^2, theta1.*theta4.^3.*theta6, theta1.*theta5.^2.*theta6, theta2.*theta3.*theta6.^3, theta2.*theta4.*theta5.^3, theta2.*theta4.*theta6.^2, theta2.*theta3.^3.*theta6, theta2.*theta4.^2.*theta6, theta2.*theta4.^3.*theta5, theta3.*theta4.*theta5.^2, theta3.*theta4.^2.*theta5, theta1.^2.*theta5.*theta6, theta1.^3.*theta4.*theta6, theta2.^2.*theta4.*theta6, theta2.^3.*theta3.*theta6, theta2.^3.*theta4.*theta5, theta3.^2.*theta4.*theta5, theta1.*theta5.*theta6.^3, theta1.*theta5.^3.*theta6, theta2.*theta4.*theta6.^3, theta2.*theta5.*theta6.^2, theta2.*theta4.^3.*theta6, theta2.*theta5.^2.*theta6, theta3.*theta4.*theta5.^3, theta3.*theta4.*theta6.^2, theta3.*theta4.^2.*theta6, theta3.*theta4.^3.*theta5, theta1.^3.*theta5.*theta6, theta2.^2.*theta5.*theta6, theta2.^3.*theta4.*theta6, theta3.^2.*theta4.*theta6, theta3.^3.*theta4.*theta5, theta2.*theta5.*theta6.^3, theta2.*theta5.^3.*theta6, theta3.*theta4.*theta6.^3, theta3.*theta5.*theta6.^2, theta3.*theta4.^3.*theta6, theta3.*theta5.^2.*theta6, theta2.^3.*theta5.*theta6, theta3.^2.*theta5.*theta6, theta3.^3.*theta4.*theta6, theta3.*theta5.*theta6.^3, theta3.*theta5.^3.*theta6, theta4.*theta5.*theta6.^2, theta4.*theta5.^2.*theta6, theta3.^3.*theta5.*theta6, theta4.^2.*theta5.*theta6, theta4.*theta5.*theta6.^3, theta4.*theta5.^3.*theta6, theta4.^3.*theta5.*theta6, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta2.^2.*theta5.^2, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta5.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta2.^2.*theta5, theta1.^2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta6.^2, theta1.*theta3.^2.*theta5.^2, theta2.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta6.^2, theta1.^2.*theta3.*theta5.^2, theta1.^2.*theta2.^2.*theta6, theta1.^2.*theta3.^2.*theta5, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta3.^2.*theta6.^2, theta1.*theta4.^2.*theta5.^2, theta2.*theta3.^2.*theta5.^2, theta1.^2.*theta3.*theta6.^2, theta1.^2.*theta4.*theta5.^2, theta1.^2.*theta3.^2.*theta6, theta1.^2.*theta4.^2.*theta5, theta2.^2.*theta3.*theta5.^2, theta2.^2.*theta3.^2.*theta5, theta1.*theta4.^2.*theta6.^2, theta2.*theta3.^2.*theta6.^2, theta2.*theta4.^2.*theta5.^2, theta1.^2.*theta4.*theta6.^2, theta1.^2.*theta4.^2.*theta6, theta2.^2.*theta3.*theta6.^2, theta2.^2.*theta4.*theta5.^2, theta2.^2.*theta3.^2.*theta6, theta2.^2.*theta4.^2.*theta5, theta1.*theta5.^2.*theta6.^2, theta2.*theta4.^2.*theta6.^2, theta3.*theta4.^2.*theta5.^2, theta1.^2.*theta5.*theta6.^2, theta1.^2.*theta5.^2.*theta6, theta2.^2.*theta4.*theta6.^2, theta2.^2.*theta4.^2.*theta6, theta3.^2.*theta4.*theta5.^2, theta3.^2.*theta4.^2.*theta5, theta2.*theta5.^2.*theta6.^2, theta3.*theta4.^2.*theta6.^2, theta2.^2.*theta5.*theta6.^2, theta2.^2.*theta5.^2.*theta6, theta3.^2.*theta4.*theta6.^2, theta3.^2.*theta4.^2.*theta6, theta3.*theta5.^2.*theta6.^2, theta3.^2.*theta5.*theta6.^2, theta3.^2.*theta5.^2.*theta6, theta4.*theta5.^2.*theta6.^2, theta4.^2.*theta5.*theta6.^2, theta4.^2.*theta5.^2.*theta6, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta2.*theta5, theta1.*theta3.*theta4, theta1.*theta2.*theta6, theta1.*theta3.*theta5, theta2.*theta3.*theta4, theta1.*theta3.*theta6, theta1.*theta4.*theta5, theta2.*theta3.*theta5, theta1.*theta4.*theta6, theta2.*theta3.*theta6, theta2.*theta4.*theta5, theta1.*theta5.*theta6, theta2.*theta4.*theta6, theta3.*theta4.*theta5, theta2.*theta5.*theta6, theta3.*theta4.*theta6, theta3.*theta5.*theta6, theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6, theta1.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6, theta1.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6, theta1.*theta3.*theta4.*theta6, theta2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6, theta2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6, theta2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5.^2, theta1.*theta2.*theta3.^2.*theta5, theta1.*theta2.^2.*theta3.*theta5, theta1.^2.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6.^2, theta1.*theta2.*theta4.*theta5.^2, theta1.*theta2.*theta3.^2.*theta6, theta1.*theta2.*theta4.^2.*theta5, theta1.*theta2.^2.*theta3.*theta6, theta1.*theta2.^2.*theta4.*theta5, theta1.^2.*theta2.*theta3.*theta6, theta1.^2.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6.^2, theta1.*theta2.*theta4.^2.*theta6, theta1.*theta3.*theta4.*theta5.^2, theta1.*theta3.*theta4.^2.*theta5, theta1.*theta2.^2.*theta4.*theta6, theta1.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta4.*theta6, theta1.^2.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6.^2, theta1.*theta2.*theta5.^2.*theta6, theta1.*theta3.*theta4.*theta6.^2, theta1.*theta3.*theta4.^2.*theta6, theta1.*theta2.^2.*theta5.*theta6, theta1.*theta3.^2.*theta4.*theta6, theta2.*theta3.*theta4.*theta5.^2, theta2.*theta3.*theta4.^2.*theta5, theta2.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta5.*theta6, theta1.^2.*theta3.*theta4.*theta6, theta2.^2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6.^2, theta1.*theta3.*theta5.^2.*theta6, theta1.*theta3.^2.*theta5.*theta6, theta2.*theta3.*theta4.*theta6.^2, theta2.*theta3.*theta4.^2.*theta6, theta2.*theta3.^2.*theta4.*theta6, theta1.^2.*theta3.*theta5.*theta6, theta2.^2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6.^2, theta1.*theta4.*theta5.^2.*theta6, theta1.*theta4.^2.*theta5.*theta6, theta2.*theta3.*theta5.*theta6.^2, theta2.*theta3.*theta5.^2.*theta6, theta2.*theta3.^2.*theta5.*theta6, theta1.^2.*theta4.*theta5.*theta6, theta2.^2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6.^2, theta2.*theta4.*theta5.^2.*theta6, theta2.*theta4.^2.*theta5.*theta6, theta2.^2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6.^2, theta3.*theta4.*theta5.^2.*theta6, theta3.*theta4.^2.*theta5.*theta6, theta3.^2.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.*theta5, theta1.*theta2.*theta3.*theta4.*theta6, theta1.*theta2.*theta3.*theta5.*theta6, theta1.*theta2.*theta4.*theta5.*theta6, theta1.*theta3.*theta4.*theta5.*theta6, theta2.*theta3.*theta4.*theta5.*theta6, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, tdot5, tdot6, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot1.*theta1.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta5, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot1.*theta1.*theta5.^3 + 3.*tdot5.*theta1.^2.*theta5.^2, 2.*tdot1.*theta1.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta6, 2.*tdot5.*theta1.^3.*theta5 + 3.*tdot1.*theta1.^2.*theta5.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot2.*theta2.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta5, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot1.*theta1.*theta6.^3 + 3.*tdot6.*theta1.^2.*theta6.^2, 2.*tdot6.*theta1.^3.*theta6 + 3.*tdot1.*theta1.^2.*theta6.^2, 2.*tdot2.*theta2.*theta5.^3 + 3.*tdot5.*theta2.^2.*theta5.^2, 2.*tdot2.*theta2.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta6, 2.*tdot5.*theta2.^3.*theta5 + 3.*tdot2.*theta2.^2.*theta5.^2, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot3.*theta3.*theta5.^2 + 2.*tdot5.*theta3.^2.*theta5, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, 2.*tdot2.*theta2.*theta6.^3 + 3.*tdot6.*theta2.^2.*theta6.^2, 2.*tdot6.*theta2.^3.*theta6 + 3.*tdot2.*theta2.^2.*theta6.^2, 2.*tdot3.*theta3.*theta5.^3 + 3.*tdot5.*theta3.^2.*theta5.^2, 2.*tdot3.*theta3.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta6, 2.*tdot5.*theta3.^3.*theta5 + 3.*tdot3.*theta3.^2.*theta5.^2, 2.*tdot4.*theta4.*theta5.^2 + 2.*tdot5.*theta4.^2.*theta5, 2.*tdot3.*theta3.*theta6.^3 + 3.*tdot6.*theta3.^2.*theta6.^2, 2.*tdot6.*theta3.^3.*theta6 + 3.*tdot3.*theta3.^2.*theta6.^2, 2.*tdot4.*theta4.*theta5.^3 + 3.*tdot5.*theta4.^2.*theta5.^2, 2.*tdot4.*theta4.*theta6.^2 + 2.*tdot6.*theta4.^2.*theta6, 2.*tdot5.*theta4.^3.*theta5 + 3.*tdot4.*theta4.^2.*theta5.^2, 2.*tdot4.*theta4.*theta6.^3 + 3.*tdot6.*theta4.^2.*theta6.^2, 2.*tdot6.*theta4.^3.*theta6 + 3.*tdot4.*theta4.^2.*theta6.^2, 2.*tdot5.*theta5.*theta6.^2 + 2.*tdot6.*theta5.^2.*theta6, 2.*tdot5.*theta5.*theta6.^3 + 3.*tdot6.*theta5.^2.*theta6.^2, 2.*tdot6.*theta5.^3.*theta6 + 3.*tdot5.*theta5.^2.*theta6.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta5 + tdot5.*theta1, tdot2.*theta4 + tdot4.*theta2, tdot1.*theta6 + tdot6.*theta1, tdot2.*theta5 + tdot5.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot2.*theta6 + tdot6.*theta2, tdot3.*theta5 + tdot5.*theta3, tdot3.*theta6 + tdot6.*theta3, tdot4.*theta5 + tdot5.*theta4, tdot4.*theta6 + tdot6.*theta4, tdot5.*theta6 + tdot6.*theta5, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot1.*theta5.^2 + 2.*tdot5.*theta1.*theta5, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot5.*theta1.^2 + 2.*tdot1.*theta1.*theta5, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot1.*theta5.^3 + 3.*tdot5.*theta1.*theta5.^2, tdot1.*theta6.^2 + 2.*tdot6.*theta1.*theta6, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot2.*theta5.^2 + 2.*tdot5.*theta2.*theta5, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot6.*theta1.^2 + 2.*tdot1.*theta1.*theta6, tdot5.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta5, tdot5.*theta2.^2 + 2.*tdot2.*theta2.*theta5, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot1.*theta5.^4 + 4.*tdot5.*theta1.*theta5.^3, tdot1.*theta6.^3 + 3.*tdot6.*theta1.*theta6.^2, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot2.*theta5.^3 + 3.*tdot5.*theta2.*theta5.^2, tdot2.*theta6.^2 + 2.*tdot6.*theta2.*theta6, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot3.*theta5.^2 + 2.*tdot5.*theta3.*theta5, tdot6.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta6, tdot6.*theta2.^2 + 2.*tdot2.*theta2.*theta6, tdot5.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta5, tdot5.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta5, tdot5.*theta3.^2 + 2.*tdot3.*theta3.*theta5, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot1.*theta6.^4 + 4.*tdot6.*theta1.*theta6.^3, tdot2.*theta5.^4 + 4.*tdot5.*theta2.*theta5.^3, tdot2.*theta6.^3 + 3.*tdot6.*theta2.*theta6.^2, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot3.*theta5.^3 + 3.*tdot5.*theta3.*theta5.^2, tdot3.*theta6.^2 + 2.*tdot6.*theta3.*theta6, tdot4.*theta5.^2 + 2.*tdot5.*theta4.*theta5, tdot6.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta6, tdot6.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta6, tdot6.*theta3.^2 + 2.*tdot3.*theta3.*theta6, tdot5.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta5, tdot5.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta5, tdot5.*theta4.^2 + 2.*tdot4.*theta4.*theta5, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, tdot2.*theta6.^4 + 4.*tdot6.*theta2.*theta6.^3, tdot3.*theta5.^4 + 4.*tdot5.*theta3.*theta5.^3, tdot3.*theta6.^3 + 3.*tdot6.*theta3.*theta6.^2, tdot4.*theta5.^3 + 3.*tdot5.*theta4.*theta5.^2, tdot4.*theta6.^2 + 2.*tdot6.*theta4.*theta6, tdot6.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta6, tdot6.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta6, tdot6.*theta4.^2 + 2.*tdot4.*theta4.*theta6, tdot5.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta5, tdot5.*theta4.^3 + 3.*tdot4.*theta4.^2.*theta5, tdot3.*theta6.^4 + 4.*tdot6.*theta3.*theta6.^3, tdot4.*theta5.^4 + 4.*tdot5.*theta4.*theta5.^3, tdot4.*theta6.^3 + 3.*tdot6.*theta4.*theta6.^2, tdot5.*theta6.^2 + 2.*tdot6.*theta5.*theta6, tdot6.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta6, tdot6.*theta4.^3 + 3.*tdot4.*theta4.^2.*theta6, tdot6.*theta5.^2 + 2.*tdot5.*theta5.*theta6, tdot5.*theta4.^4 + 4.*tdot4.*theta4.^3.*theta5, tdot4.*theta6.^4 + 4.*tdot6.*theta4.*theta6.^3, tdot5.*theta6.^3 + 3.*tdot6.*theta5.*theta6.^2, tdot6.*theta4.^4 + 4.*tdot4.*theta4.^3.*theta6, tdot6.*theta5.^3 + 3.*tdot5.*theta5.^2.*theta6, tdot5.*theta6.^4 + 4.*tdot6.*theta5.*theta6.^3, tdot6.*theta5.^4 + 4.*tdot5.*theta5.^3.*theta6, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 2.*tdot5.*theta5, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 3.*tdot5.*theta5.^2, 2.*tdot6.*theta6, 5.*tdot4.*theta4.^4, 4.*tdot5.*theta5.^3, 3.*tdot6.*theta6.^2, 5.*tdot5.*theta5.^4, 4.*tdot6.*theta6.^3, 5.*tdot6.*theta6.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta2.*theta5.^2 + tdot2.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta5, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta5, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot2.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta5, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta2.*theta5.^3 + tdot2.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta2.*theta5.^2, tdot1.*theta2.*theta6.^2 + tdot2.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta6, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.*theta5.^2 + tdot3.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta5, tdot1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta6, tdot1.*theta2.^3.*theta5 + tdot5.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta5, tdot1.*theta3.^2.*theta5 + tdot5.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta5, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta6, tdot3.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta5, tdot2.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta5, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot1.*theta2.*theta6.^3 + tdot2.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta2.*theta6.^2, tdot1.*theta3.*theta5.^3 + tdot3.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta3.*theta5.^2, tdot1.*theta3.*theta6.^2 + tdot3.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta6, tdot1.*theta4.*theta5.^2 + tdot4.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta4.*theta5, tdot1.*theta2.^3.*theta6 + tdot6.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta6, tdot1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta6, tdot1.*theta3.^3.*theta5 + tdot5.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta5, tdot1.*theta4.^2.*theta5 + tdot5.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta4.*theta5, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.*theta5.^2 + tdot3.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta5, tdot2.*theta3.^2.*theta5 + tdot5.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta5, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta6, tdot4.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta4 + 2.*tdot1.*theta1.*theta4.*theta5, tdot2.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta6, tdot3.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta5, tdot3.*theta2.^2.*theta5 + tdot5.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta5, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta3.*theta6.^3 + tdot3.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta3.*theta6.^2, tdot1.*theta4.*theta5.^3 + tdot4.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta4.*theta5.^2, tdot1.*theta4.*theta6.^2 + tdot4.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta4.*theta6, tdot1.*theta3.^3.*theta6 + tdot6.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta6, tdot1.*theta4.^2.*theta6 + tdot6.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta4.*theta6, tdot1.*theta4.^3.*theta5 + tdot5.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2.*theta5, tdot2.*theta3.*theta5.^3 + tdot3.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta3.*theta5.^2, tdot2.*theta3.*theta6.^2 + tdot3.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta6, tdot2.*theta4.*theta5.^2 + tdot4.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta4.*theta5, tdot2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta6, tdot2.*theta3.^3.*theta5 + tdot5.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta5, tdot2.*theta4.^2.*theta5 + tdot5.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta4.*theta5, tdot4.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta4 + 2.*tdot1.*theta1.*theta4.*theta6, tdot3.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta6, tdot4.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.*theta5, tdot3.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta6, tdot4.*theta2.^2.*theta5 + tdot5.*theta2.^2.*theta4 + 2.*tdot2.*theta2.*theta4.*theta5, tdot3.*theta2.^3.*theta5 + tdot5.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta5, tdot1.*theta4.*theta6.^3 + tdot4.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta4.*theta6.^2, tdot1.*theta5.*theta6.^2 + tdot5.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta5.*theta6, tdot1.*theta4.^3.*theta6 + tdot6.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2.*theta6, tdot1.*theta5.^2.*theta6 + tdot6.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta5.*theta6, tdot2.*theta3.*theta6.^3 + tdot3.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta3.*theta6.^2, tdot2.*theta4.*theta5.^3 + tdot4.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta4.*theta5.^2, tdot2.*theta4.*theta6.^2 + tdot4.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta4.*theta6, tdot2.*theta3.^3.*theta6 + tdot6.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta6, tdot2.*theta4.^2.*theta6 + tdot6.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta4.*theta6, tdot2.*theta4.^3.*theta5 + tdot5.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2.*theta5, tdot3.*theta4.*theta5.^2 + tdot4.*theta3.*theta5.^2 + 2.*tdot5.*theta3.*theta4.*theta5, tdot3.*theta4.^2.*theta5 + tdot5.*theta3.*theta4.^2 + 2.*tdot4.*theta3.*theta4.*theta5, tdot5.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta5 + 2.*tdot1.*theta1.*theta5.*theta6, tdot4.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.*theta6, tdot4.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta4 + 2.*tdot2.*theta2.*theta4.*theta6, tdot3.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta6, tdot4.*theta2.^3.*theta5 + tdot5.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.*theta5, tdot4.*theta3.^2.*theta5 + tdot5.*theta3.^2.*theta4 + 2.*tdot3.*theta3.*theta4.*theta5, tdot1.*theta5.*theta6.^3 + tdot5.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta5.*theta6.^2, tdot1.*theta5.^3.*theta6 + tdot6.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta5.^2.*theta6, tdot2.*theta4.*theta6.^3 + tdot4.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta4.*theta6.^2, tdot2.*theta5.*theta6.^2 + tdot5.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta5.*theta6, tdot2.*theta4.^3.*theta6 + tdot6.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2.*theta6, tdot2.*theta5.^2.*theta6 + tdot6.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta5.*theta6, tdot3.*theta4.*theta5.^3 + tdot4.*theta3.*theta5.^3 + 3.*tdot5.*theta3.*theta4.*theta5.^2, tdot3.*theta4.*theta6.^2 + tdot4.*theta3.*theta6.^2 + 2.*tdot6.*theta3.*theta4.*theta6, tdot3.*theta4.^2.*theta6 + tdot6.*theta3.*theta4.^2 + 2.*tdot4.*theta3.*theta4.*theta6, tdot3.*theta4.^3.*theta5 + tdot5.*theta3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2.*theta5, tdot5.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta5 + 3.*tdot1.*theta1.^2.*theta5.*theta6, tdot5.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta5 + 2.*tdot2.*theta2.*theta5.*theta6, tdot4.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.*theta6, tdot4.*theta3.^2.*theta6 + tdot6.*theta3.^2.*theta4 + 2.*tdot3.*theta3.*theta4.*theta6, tdot4.*theta3.^3.*theta5 + tdot5.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.*theta5, tdot2.*theta5.*theta6.^3 + tdot5.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta5.*theta6.^2, tdot2.*theta5.^3.*theta6 + tdot6.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta5.^2.*theta6, tdot3.*theta4.*theta6.^3 + tdot4.*theta3.*theta6.^3 + 3.*tdot6.*theta3.*theta4.*theta6.^2, tdot3.*theta5.*theta6.^2 + tdot5.*theta3.*theta6.^2 + 2.*tdot6.*theta3.*theta5.*theta6, tdot3.*theta4.^3.*theta6 + tdot6.*theta3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2.*theta6, tdot3.*theta5.^2.*theta6 + tdot6.*theta3.*theta5.^2 + 2.*tdot5.*theta3.*theta5.*theta6, tdot5.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta5 + 3.*tdot2.*theta2.^2.*theta5.*theta6, tdot5.*theta3.^2.*theta6 + tdot6.*theta3.^2.*theta5 + 2.*tdot3.*theta3.*theta5.*theta6, tdot4.*theta3.^3.*theta6 + tdot6.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.*theta6, tdot3.*theta5.*theta6.^3 + tdot5.*theta3.*theta6.^3 + 3.*tdot6.*theta3.*theta5.*theta6.^2, tdot3.*theta5.^3.*theta6 + tdot6.*theta3.*theta5.^3 + 3.*tdot5.*theta3.*theta5.^2.*theta6, tdot4.*theta5.*theta6.^2 + tdot5.*theta4.*theta6.^2 + 2.*tdot6.*theta4.*theta5.*theta6, tdot4.*theta5.^2.*theta6 + tdot6.*theta4.*theta5.^2 + 2.*tdot5.*theta4.*theta5.*theta6, tdot5.*theta3.^3.*theta6 + tdot6.*theta3.^3.*theta5 + 3.*tdot3.*theta3.^2.*theta5.*theta6, tdot5.*theta4.^2.*theta6 + tdot6.*theta4.^2.*theta5 + 2.*tdot4.*theta4.*theta5.*theta6, tdot4.*theta5.*theta6.^3 + tdot5.*theta4.*theta6.^3 + 3.*tdot6.*theta4.*theta5.*theta6.^2, tdot4.*theta5.^3.*theta6 + tdot6.*theta4.*theta5.^3 + 3.*tdot5.*theta4.*theta5.^2.*theta6, tdot5.*theta4.^3.*theta6 + tdot6.*theta4.^3.*theta5 + 3.*tdot4.*theta4.^2.*theta5.*theta6, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.^2.*theta5, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot2.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta2.*theta5, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot5.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta5 + 2.*tdot2.*theta1.^2.*theta2.*theta5, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.^2.*theta6, tdot1.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.^2.*theta5, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot2.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta2.*theta6, tdot3.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta3.*theta5, tdot6.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta6 + 2.*tdot2.*theta1.^2.*theta2.*theta6, tdot5.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta5 + 2.*tdot3.*theta1.^2.*theta3.*theta5, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.^2.*theta6, tdot1.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.*theta4.^2.*theta5, tdot2.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.^2.*theta5, tdot3.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta3.*theta6, tdot4.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta4.*theta5, tdot6.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta6 + 2.*tdot3.*theta1.^2.*theta3.*theta6, tdot5.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta4.^2.*theta5 + 2.*tdot4.*theta1.^2.*theta4.*theta5, tdot3.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta3.*theta5, tdot5.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta5 + 2.*tdot3.*theta2.^2.*theta3.*theta5, tdot1.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.*theta4.^2.*theta6, tdot2.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.^2.*theta6, tdot2.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.*theta4.^2.*theta5, tdot4.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta4.*theta6, tdot6.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta4.^2.*theta6 + 2.*tdot4.*theta1.^2.*theta4.*theta6, tdot3.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta3.*theta6, tdot4.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta4.*theta5, tdot6.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta6 + 2.*tdot3.*theta2.^2.*theta3.*theta6, tdot5.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta4.^2.*theta5 + 2.*tdot4.*theta2.^2.*theta4.*theta5, tdot1.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta1.*theta5.*theta6.^2 + 2.*tdot6.*theta1.*theta5.^2.*theta6, tdot2.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.*theta4.^2.*theta6, tdot3.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.*theta4.^2.*theta5, tdot5.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta5.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta5.*theta6, tdot6.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta5.^2.*theta6 + 2.*tdot5.*theta1.^2.*theta5.*theta6, tdot4.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta4.*theta6, tdot6.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta4.^2.*theta6 + 2.*tdot4.*theta2.^2.*theta4.*theta6, tdot4.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.^2.*theta4.*theta5, tdot5.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta3.*theta4.^2.*theta5 + 2.*tdot4.*theta3.^2.*theta4.*theta5, tdot2.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta2.*theta5.*theta6.^2 + 2.*tdot6.*theta2.*theta5.^2.*theta6, tdot3.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.*theta4.^2.*theta6, tdot5.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta5.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta5.*theta6, tdot6.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta5.^2.*theta6 + 2.*tdot5.*theta2.^2.*theta5.*theta6, tdot4.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta4.*theta6, tdot6.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta3.*theta4.^2.*theta6 + 2.*tdot4.*theta3.^2.*theta4.*theta6, tdot3.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta3.*theta5.*theta6.^2 + 2.*tdot6.*theta3.*theta5.^2.*theta6, tdot5.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta3.*theta5.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta5.*theta6, tdot6.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta3.*theta5.^2.*theta6 + 2.*tdot5.*theta3.^2.*theta5.*theta6, tdot4.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta4.*theta5.*theta6.^2 + 2.*tdot6.*theta4.*theta5.^2.*theta6, tdot5.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta4.*theta5.*theta6.^2 + 2.*tdot6.*theta4.^2.*theta5.*theta6, tdot6.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta4.*theta5.^2.*theta6 + 2.*tdot5.*theta4.^2.*theta5.*theta6, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta2.*theta5 + tdot2.*theta1.*theta5 + tdot5.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot1.*theta2.*theta6 + tdot2.*theta1.*theta6 + tdot6.*theta1.*theta2, tdot1.*theta3.*theta5 + tdot3.*theta1.*theta5 + tdot5.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta3.*theta6 + tdot3.*theta1.*theta6 + tdot6.*theta1.*theta3, tdot1.*theta4.*theta5 + tdot4.*theta1.*theta5 + tdot5.*theta1.*theta4, tdot2.*theta3.*theta5 + tdot3.*theta2.*theta5 + tdot5.*theta2.*theta3, tdot1.*theta4.*theta6 + tdot4.*theta1.*theta6 + tdot6.*theta1.*theta4, tdot2.*theta3.*theta6 + tdot3.*theta2.*theta6 + tdot6.*theta2.*theta3, tdot2.*theta4.*theta5 + tdot4.*theta2.*theta5 + tdot5.*theta2.*theta4, tdot1.*theta5.*theta6 + tdot5.*theta1.*theta6 + tdot6.*theta1.*theta5, tdot2.*theta4.*theta6 + tdot4.*theta2.*theta6 + tdot6.*theta2.*theta4, tdot3.*theta4.*theta5 + tdot4.*theta3.*theta5 + tdot5.*theta3.*theta4, tdot2.*theta5.*theta6 + tdot5.*theta2.*theta6 + tdot6.*theta2.*theta5, tdot3.*theta4.*theta6 + tdot4.*theta3.*theta6 + tdot6.*theta3.*theta4, tdot3.*theta5.*theta6 + tdot5.*theta3.*theta6 + tdot6.*theta3.*theta5, tdot4.*theta5.*theta6 + tdot5.*theta4.*theta6 + tdot6.*theta4.*theta5, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta5 + tdot2.*theta1.*theta3.*theta5 + tdot3.*theta1.*theta2.*theta5 + tdot5.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta6 + tdot2.*theta1.*theta3.*theta6 + tdot3.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta3, tdot1.*theta2.*theta4.*theta5 + tdot2.*theta1.*theta4.*theta5 + tdot4.*theta1.*theta2.*theta5 + tdot5.*theta1.*theta2.*theta4, tdot1.*theta2.*theta4.*theta6 + tdot2.*theta1.*theta4.*theta6 + tdot4.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta4, tdot1.*theta3.*theta4.*theta5 + tdot3.*theta1.*theta4.*theta5 + tdot4.*theta1.*theta3.*theta5 + tdot5.*theta1.*theta3.*theta4, tdot1.*theta2.*theta5.*theta6 + tdot2.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta5, tdot1.*theta3.*theta4.*theta6 + tdot3.*theta1.*theta4.*theta6 + tdot4.*theta1.*theta3.*theta6 + tdot6.*theta1.*theta3.*theta4, tdot2.*theta3.*theta4.*theta5 + tdot3.*theta2.*theta4.*theta5 + tdot4.*theta2.*theta3.*theta5 + tdot5.*theta2.*theta3.*theta4, tdot1.*theta3.*theta5.*theta6 + tdot3.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta3.*theta6 + tdot6.*theta1.*theta3.*theta5, tdot2.*theta3.*theta4.*theta6 + tdot3.*theta2.*theta4.*theta6 + tdot4.*theta2.*theta3.*theta6 + tdot6.*theta2.*theta3.*theta4, tdot1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta4.*theta6 + tdot6.*theta1.*theta4.*theta5, tdot2.*theta3.*theta5.*theta6 + tdot3.*theta2.*theta5.*theta6 + tdot5.*theta2.*theta3.*theta6 + tdot6.*theta2.*theta3.*theta5, tdot2.*theta4.*theta5.*theta6 + tdot4.*theta2.*theta5.*theta6 + tdot5.*theta2.*theta4.*theta6 + tdot6.*theta2.*theta4.*theta5, tdot3.*theta4.*theta5.*theta6 + tdot4.*theta3.*theta5.*theta6 + tdot5.*theta3.*theta4.*theta6 + tdot6.*theta3.*theta4.*theta5, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta5.^2 + tdot2.*theta1.*theta3.*theta5.^2 + tdot3.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta3.^2.*theta5 + tdot2.*theta1.*theta3.^2.*theta5 + tdot5.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.^2.*theta3.*theta5 + tdot3.*theta1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta5, tdot2.*theta1.^2.*theta3.*theta5 + tdot3.*theta1.^2.*theta2.*theta5 + tdot5.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta3.*theta6.^2 + tdot2.*theta1.*theta3.*theta6.^2 + tdot3.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.*theta4.*theta5.^2 + tdot2.*theta1.*theta4.*theta5.^2 + tdot4.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.*theta3.^2.*theta6 + tdot2.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.*theta4.^2.*theta5 + tdot2.*theta1.*theta4.^2.*theta5 + tdot5.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.^2.*theta3.*theta6 + tdot3.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.^2.*theta4.*theta5 + tdot4.*theta1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.*theta2.*theta4.*theta5, tdot2.*theta1.^2.*theta3.*theta6 + tdot3.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta6, tdot2.*theta1.^2.*theta4.*theta5 + tdot4.*theta1.^2.*theta2.*theta5 + tdot5.*theta1.^2.*theta2.*theta4 + 2.*tdot1.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.*theta4.*theta6.^2 + tdot2.*theta1.*theta4.*theta6.^2 + tdot4.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta4.*theta6, tdot1.*theta2.*theta4.^2.*theta6 + tdot2.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4.*theta6, tdot1.*theta3.*theta4.*theta5.^2 + tdot3.*theta1.*theta4.*theta5.^2 + tdot4.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta4.*theta5, tdot1.*theta3.*theta4.^2.*theta5 + tdot3.*theta1.*theta4.^2.*theta5 + tdot5.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4.*theta5, tdot1.*theta2.^2.*theta4.*theta6 + tdot4.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.*theta2.*theta4.*theta6, tdot1.*theta3.^2.*theta4.*theta5 + tdot4.*theta1.*theta3.^2.*theta5 + tdot5.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.*theta3.*theta4.*theta5, tdot2.*theta1.^2.*theta4.*theta6 + tdot4.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta4 + 2.*tdot1.*theta1.*theta2.*theta4.*theta6, tdot3.*theta1.^2.*theta4.*theta5 + tdot4.*theta1.^2.*theta3.*theta5 + tdot5.*theta1.^2.*theta3.*theta4 + 2.*tdot1.*theta1.*theta3.*theta4.*theta5, tdot1.*theta2.*theta5.*theta6.^2 + tdot2.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta5.*theta6, tdot1.*theta2.*theta5.^2.*theta6 + tdot2.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta5.*theta6, tdot1.*theta3.*theta4.*theta6.^2 + tdot3.*theta1.*theta4.*theta6.^2 + tdot4.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta4.*theta6, tdot1.*theta3.*theta4.^2.*theta6 + tdot3.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4.*theta6, tdot1.*theta2.^2.*theta5.*theta6 + tdot5.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta5 + 2.*tdot2.*theta1.*theta2.*theta5.*theta6, tdot1.*theta3.^2.*theta4.*theta6 + tdot4.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.*theta3.*theta4.*theta6, tdot2.*theta3.*theta4.*theta5.^2 + tdot3.*theta2.*theta4.*theta5.^2 + tdot4.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta4.*theta5, tdot2.*theta3.*theta4.^2.*theta5 + tdot3.*theta2.*theta4.^2.*theta5 + tdot5.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4.*theta5, tdot2.*theta3.^2.*theta4.*theta5 + tdot4.*theta2.*theta3.^2.*theta5 + tdot5.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.*theta3.*theta4.*theta5, tdot2.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta5 + 2.*tdot1.*theta1.*theta2.*theta5.*theta6, tdot3.*theta1.^2.*theta4.*theta6 + tdot4.*theta1.^2.*theta3.*theta6 + tdot6.*theta1.^2.*theta3.*theta4 + 2.*tdot1.*theta1.*theta3.*theta4.*theta6, tdot3.*theta2.^2.*theta4.*theta5 + tdot4.*theta2.^2.*theta3.*theta5 + tdot5.*theta2.^2.*theta3.*theta4 + 2.*tdot2.*theta2.*theta3.*theta4.*theta5, tdot1.*theta3.*theta5.*theta6.^2 + tdot3.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta5.*theta6, tdot1.*theta3.*theta5.^2.*theta6 + tdot3.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta5.*theta6, tdot1.*theta3.^2.*theta5.*theta6 + tdot5.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2.*theta5 + 2.*tdot3.*theta1.*theta3.*theta5.*theta6, tdot2.*theta3.*theta4.*theta6.^2 + tdot3.*theta2.*theta4.*theta6.^2 + tdot4.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta4.*theta6, tdot2.*theta3.*theta4.^2.*theta6 + tdot3.*theta2.*theta4.^2.*theta6 + tdot6.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4.*theta6, tdot2.*theta3.^2.*theta4.*theta6 + tdot4.*theta2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.*theta3.*theta4.*theta6, tdot3.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta3.*theta6 + tdot6.*theta1.^2.*theta3.*theta5 + 2.*tdot1.*theta1.*theta3.*theta5.*theta6, tdot3.*theta2.^2.*theta4.*theta6 + tdot4.*theta2.^2.*theta3.*theta6 + tdot6.*theta2.^2.*theta3.*theta4 + 2.*tdot2.*theta2.*theta3.*theta4.*theta6, tdot1.*theta4.*theta5.*theta6.^2 + tdot4.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.*theta4.*theta5.*theta6, tdot1.*theta4.*theta5.^2.*theta6 + tdot4.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.*theta4.*theta5.*theta6, tdot1.*theta4.^2.*theta5.*theta6 + tdot5.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta4.^2.*theta5 + 2.*tdot4.*theta1.*theta4.*theta5.*theta6, tdot2.*theta3.*theta5.*theta6.^2 + tdot3.*theta2.*theta5.*theta6.^2 + tdot5.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta5.*theta6, tdot2.*theta3.*theta5.^2.*theta6 + tdot3.*theta2.*theta5.^2.*theta6 + tdot6.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta5.*theta6, tdot2.*theta3.^2.*theta5.*theta6 + tdot5.*theta2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2.*theta5 + 2.*tdot3.*theta2.*theta3.*theta5.*theta6, tdot4.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta4.*theta6 + tdot6.*theta1.^2.*theta4.*theta5 + 2.*tdot1.*theta1.*theta4.*theta5.*theta6, tdot3.*theta2.^2.*theta5.*theta6 + tdot5.*theta2.^2.*theta3.*theta6 + tdot6.*theta2.^2.*theta3.*theta5 + 2.*tdot2.*theta2.*theta3.*theta5.*theta6, tdot2.*theta4.*theta5.*theta6.^2 + tdot4.*theta2.*theta5.*theta6.^2 + tdot5.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.*theta4.*theta5.*theta6, tdot2.*theta4.*theta5.^2.*theta6 + tdot4.*theta2.*theta5.^2.*theta6 + tdot6.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.*theta4.*theta5.*theta6, tdot2.*theta4.^2.*theta5.*theta6 + tdot5.*theta2.*theta4.^2.*theta6 + tdot6.*theta2.*theta4.^2.*theta5 + 2.*tdot4.*theta2.*theta4.*theta5.*theta6, tdot4.*theta2.^2.*theta5.*theta6 + tdot5.*theta2.^2.*theta4.*theta6 + tdot6.*theta2.^2.*theta4.*theta5 + 2.*tdot2.*theta2.*theta4.*theta5.*theta6, tdot3.*theta4.*theta5.*theta6.^2 + tdot4.*theta3.*theta5.*theta6.^2 + tdot5.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.*theta4.*theta5.*theta6, tdot3.*theta4.*theta5.^2.*theta6 + tdot4.*theta3.*theta5.^2.*theta6 + tdot6.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.*theta4.*theta5.*theta6, tdot3.*theta4.^2.*theta5.*theta6 + tdot5.*theta3.*theta4.^2.*theta6 + tdot6.*theta3.*theta4.^2.*theta5 + 2.*tdot4.*theta3.*theta4.*theta5.*theta6, tdot4.*theta3.^2.*theta5.*theta6 + tdot5.*theta3.^2.*theta4.*theta6 + tdot6.*theta3.^2.*theta4.*theta5 + 2.*tdot3.*theta3.*theta4.*theta5.*theta6, tdot1.*theta2.*theta3.*theta4.*theta5 + tdot2.*theta1.*theta3.*theta4.*theta5 + tdot3.*theta1.*theta2.*theta4.*theta5 + tdot4.*theta1.*theta2.*theta3.*theta5 + tdot5.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta4.*theta6 + tdot2.*theta1.*theta3.*theta4.*theta6 + tdot3.*theta1.*theta2.*theta4.*theta6 + tdot4.*theta1.*theta2.*theta3.*theta6 + tdot6.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta5.*theta6 + tdot2.*theta1.*theta3.*theta5.*theta6 + tdot3.*theta1.*theta2.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta3.*theta6 + tdot6.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta4.*theta5.*theta6 + tdot2.*theta1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta2.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta4.*theta6 + tdot6.*theta1.*theta2.*theta4.*theta5, tdot1.*theta3.*theta4.*theta5.*theta6 + tdot3.*theta1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta3.*theta5.*theta6 + tdot5.*theta1.*theta3.*theta4.*theta6 + tdot6.*theta1.*theta3.*theta4.*theta5, tdot2.*theta3.*theta4.*theta5.*theta6 + tdot3.*theta2.*theta4.*theta5.*theta6 + tdot4.*theta2.*theta3.*theta5.*theta6 + tdot5.*theta2.*theta3.*theta4.*theta6 + tdot6.*theta2.*theta3.*theta4.*theta5, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -2.*theta1.*theta5.^2, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.^3, -2.*theta1.*theta6.^2, -3.*theta1.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6.^3, -3.*theta1.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta5, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, -3.*theta1.^2.*theta5, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6, zeroCol, -4.*theta1.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta2.*theta5.^2, -theta3.*theta4.^2, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta2.*theta5, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta2.*theta5.^3, -theta2.*theta6.^2, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^2.*theta6, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -2.*theta1.*theta3.*theta5, -3.*theta1.^2.*theta2.*theta5, -3.*theta1.^2.*theta3.*theta4, zeroCol, -theta2.*theta6.^3, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -2.*theta1.*theta4.*theta5, -3.*theta1.^2.*theta2.*theta6, -3.*theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.^2.*theta3.*theta6, -3.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6, -3.*theta1.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta2.^2.*theta5.^2, -theta3.^2.*theta4.^2, -2.*theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta2.^2.*theta5, -2.*theta1.*theta3.^2.*theta4, -theta2.^2.*theta6.^2, -theta3.^2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta6.^2, -2.*theta1.*theta3.*theta5.^2, -2.*theta1.*theta2.^2.*theta6, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, -2.*theta1.*theta3.*theta6.^2, -2.*theta1.*theta4.*theta5.^2, -2.*theta1.*theta3.^2.*theta6, -2.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6.^2, -2.*theta1.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta2.*theta5, -theta3.*theta4, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta5, -theta2.*theta3.*theta6, -theta2.*theta4.*theta5, -theta2.*theta4.*theta6, -theta3.*theta4.*theta5, -theta2.*theta5.*theta6, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta2.*theta3.*theta6.^2, -theta2.*theta4.*theta5.^2, -theta2.*theta3.^2.*theta6, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta3.*theta6, -theta2.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta6, -theta3.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta4.*theta6, -2.*theta1.*theta3.*theta4.*theta5, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta2.^2.*theta5.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.*theta6, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.^3, -2.*theta2.*theta5.^2, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.^3, -2.*theta2.*theta6.^2, -3.*theta2.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6.^3, -3.*theta2.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, -3.*theta2.^2.*theta5, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6, zeroCol, -4.*theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta5, -3.*theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -3.*theta1.*theta2.^2.*theta5, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -2.*theta2.*theta3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -2.*theta2.*theta3.*theta5, -3.*theta2.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, -2.*theta2.*theta4.*theta5, -3.*theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.^2.*theta3.*theta6, -3.*theta2.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta2.^2.*theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, -2.*theta1.*theta2.*theta5.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -2.*theta1.*theta2.*theta6.^2, zeroCol, -theta3.^2.*theta4.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, -theta3.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.^2.*theta5, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6.^2, -2.*theta2.*theta4.*theta5.^2, -2.*theta2.*theta3.^2.*theta6, -2.*theta2.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.^2.*theta6, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6.^2, -2.*theta2.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3, -theta1.*theta4, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta3.*theta4, zeroCol, zeroCol, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta3.*theta5, -theta1.*theta3.*theta6, -theta1.*theta4.*theta5, -theta1.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5, zeroCol, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, -theta4.*theta5.*theta6, zeroCol, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta1.^2.*theta3.*theta5, -theta1.*theta3.*theta6.^2, -theta1.*theta4.*theta5.^2, -theta1.*theta3.^2.*theta6, -theta1.*theta4.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta1.^2.*theta3.*theta6, -theta1.^2.*theta4.*theta5, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, zeroCol, -theta1.^2.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, -theta1.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta5.*theta6, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta2.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta5.*theta6, -theta1.*theta4.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.*theta6, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^3, -2.*theta3.*theta5.^2, -3.*theta3.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta5.^3, -2.*theta3.*theta6.^2, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.*theta6.^3, -3.*theta3.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, -theta2, zeroCol, zeroCol, zeroCol, zeroCol, -theta4, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta3.^3, zeroCol, zeroCol, -theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, -3.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -3.*theta3.^2.*theta5, zeroCol, -4.*theta3.^3.*theta4, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta6, zeroCol, -4.*theta3.^3.*theta5, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, -4.*theta3.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta2.^2.*theta4, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -3.*theta1.*theta3.^2.*theta5, zeroCol, -theta2.*theta4.^3, -theta2.*theta5.^2, -2.*theta2.*theta3.*theta5, -3.*theta2.*theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, -3.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta6, -3.*theta2.*theta3.^2.*theta5, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2.*theta6, zeroCol, zeroCol, -theta4.*theta5.^2, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta6, zeroCol, -2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6, -3.*theta3.^2.*theta4.*theta5, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, -2.*theta3.*theta5.*theta6, -3.*theta3.^2.*theta4.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta3.*theta5, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta5.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta5.^2, -2.*theta2.^2.*theta3.*theta5, zeroCol, -2.*theta2.*theta3.*theta6.^2, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta6.^2, zeroCol, -2.*theta2.^2.*theta3.*theta6, zeroCol, zeroCol, zeroCol, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta5.^2, -2.*theta3.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.^2.*theta6, -theta5.^2.*theta6.^2, -2.*theta3.*theta5.*theta6.^2, -2.*theta3.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta4, zeroCol, -theta1.*theta5, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta4.*theta5, zeroCol, -theta4.*theta6, -theta5.*theta6, zeroCol, -theta1.*theta2.*theta4, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta4.*theta5, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta4.*theta5, -theta1.*theta5.*theta6, -theta2.*theta4.*theta6, zeroCol, -theta2.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.^2.*theta5, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -theta1.^2.*theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, -2.*theta1.*theta3.*theta4.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta4.*theta5, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta3.*theta5.*theta6, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -2.*theta2.*theta3.*theta4.*theta6, -theta1.^2.*theta5.*theta6, -theta2.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta3.*theta5.*theta6, zeroCol, -theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta1.*theta2.*theta4.*theta5, -theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta5.*theta6, zeroCol, -theta1.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta4.^2, zeroCol, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta4.^2, zeroCol, -2.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5.^2, zeroCol, zeroCol, -2.*theta4.*theta5.^3, -2.*theta4.*theta6.^2, -3.*theta4.^2.*theta5.^2, -2.*theta4.*theta6.^3, -3.*theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, zeroCol, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, zeroCol, zeroCol, -3.*theta2.*theta4.^2, zeroCol, -2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta4.^3, zeroCol, zeroCol, -3.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, zeroCol, zeroCol, zeroCol, -4.*theta3.*theta4.^3, zeroCol, zeroCol, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5, -theta3.^4, zeroCol, zeroCol, zeroCol, -theta5.^3, -theta6.^2, zeroCol, zeroCol, -2.*theta4.*theta6, zeroCol, -3.*theta4.^2.*theta5, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, -3.*theta4.^2.*theta6, zeroCol, -4.*theta4.^3.*theta5, -theta6.^4, zeroCol, -4.*theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, zeroCol, -4.*theta4.^3, zeroCol, zeroCol, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, -3.*theta1.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5, -3.*theta2.*theta3.*theta4.^2, zeroCol, zeroCol, -theta2.*theta3.^3, zeroCol, -theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta3, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta4.*theta5, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -theta2.^2.*theta5, zeroCol, -theta1.*theta6.^3, zeroCol, -3.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.*theta4.^2.*theta5, -theta3.*theta5.^2, -2.*theta3.*theta4.*theta5, zeroCol, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, -theta3.^2.*theta5, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, -3.*theta2.*theta4.^2.*theta6, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -2.*theta3.*theta4.*theta6, -3.*theta3.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, zeroCol, -3.*theta3.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.^3.*theta6, zeroCol, zeroCol, -theta5.*theta6.^2, -theta5.^2.*theta6, zeroCol, -2.*theta4.*theta5.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, -3.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, zeroCol, -2.*theta1.*theta3.^2.*theta4, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta5.^2, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta4.*theta6, zeroCol, -theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta4.*theta6, -theta3.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta5, zeroCol, -2.*theta3.*theta4.*theta6.^2, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, -2.*theta4.*theta5.*theta6.^2, -2.*theta4.*theta5.^2.*theta6, zeroCol, -theta1.*theta2, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta2.*theta3, zeroCol, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, zeroCol, -theta5.*theta6, -theta1.*theta2.*theta3, zeroCol, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, -theta1.*theta3.*theta5, zeroCol, -theta1.*theta3.*theta6, -theta2.*theta3.*theta5, zeroCol, -theta2.*theta3.*theta6, -theta1.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6, -theta3.*theta5.*theta6, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.^2.*theta5, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta2.^2.*theta6, -theta1.*theta3.^2.*theta5, -theta1.^2.*theta2.*theta6, -theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta1.*theta3.^2.*theta6, -theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.^2.*theta5, zeroCol, -theta1.^2.*theta3.*theta6, -theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.^2.*theta6, zeroCol, -theta2.^2.*theta3.*theta6, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta4.*theta5.*theta6, -theta2.^2.*theta5.*theta6, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta3.^2.*theta5.*theta6, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta5.*theta6, -theta1.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.*theta6, zeroCol,];
        R5= [ zeroCol, zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^3.*theta5, zeroCol, -2.*theta2.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^3.*theta5, zeroCol, -2.*theta3.^2.*theta5, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.^3.*theta5, -2.*theta4.^2.*theta5, zeroCol, zeroCol, -3.*theta4.^2.*theta5.^2, zeroCol, -2.*theta4.^3.*theta5, zeroCol, zeroCol, -2.*theta5.*theta6.^2, -2.*theta5.*theta6.^3, -3.*theta5.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta5.^3, zeroCol, zeroCol, -3.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta5.^3, zeroCol, zeroCol, -3.*theta3.*theta5.^2, zeroCol, -2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta5.^3, zeroCol, -3.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, zeroCol, -4.*theta4.*theta5.^3, zeroCol, -theta6.^2, zeroCol, zeroCol, -2.*theta5.*theta6, -theta4.^4, zeroCol, -theta6.^3, zeroCol, -3.*theta5.^2.*theta6, -theta6.^4, -4.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta5, zeroCol, zeroCol, -3.*theta5.^2, zeroCol, zeroCol, -4.*theta5.^3, zeroCol, -5.*theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, -3.*theta1.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta5.^2, zeroCol, -2.*theta1.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, -2.*theta2.*theta3.*theta5, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -3.*theta2.*theta3.*theta5.^2, zeroCol, -2.*theta2.*theta4.*theta5, zeroCol, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta5.*theta6, zeroCol, -3.*theta2.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta2.*theta4.^3, -2.*theta3.*theta4.*theta5, -theta3.*theta4.^2, -theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta4, -theta3.^2.*theta4, -theta1.*theta6.^3, -3.*theta1.*theta5.^2.*theta6, zeroCol, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta3.*theta4.^3, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, zeroCol, -theta3.^3.*theta4, -theta2.*theta6.^3, -3.*theta2.*theta5.^2.*theta6, zeroCol, -theta3.*theta6.^2, zeroCol, -2.*theta3.*theta5.*theta6, -theta2.^3.*theta6, -theta3.^2.*theta6, zeroCol, -theta3.*theta6.^3, -3.*theta3.*theta5.^2.*theta6, -theta4.*theta6.^2, -2.*theta4.*theta5.*theta6, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.*theta6.^3, -3.*theta4.*theta5.^2.*theta6, -theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta5, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta5, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.^2.*theta5, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta5, -theta2.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -theta2.^2.*theta4.^2, -2.*theta1.*theta5.*theta6.^2, zeroCol, -2.*theta3.*theta4.^2.*theta5, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.^2.*theta4.*theta5, -theta3.^2.*theta4.^2, -2.*theta2.*theta5.*theta6.^2, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.*theta5.*theta6.^2, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta5.*theta6, -2.*theta4.*theta5.*theta6.^2, -theta4.^2.*theta6.^2, -2.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, zeroCol, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta3.*theta4, -theta2.*theta6, zeroCol, -theta3.*theta6, -theta4.*theta6, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta2.*theta6, zeroCol, -theta2.*theta3.*theta4, -theta1.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta3.*theta6, -theta2.*theta4.*theta6, -theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta4.^2, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.^2, zeroCol, -theta1.*theta3.^2.*theta4, zeroCol, -theta1.^2.*theta3.*theta4, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta2.*theta6, zeroCol, -theta2.^2.*theta3.*theta4, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.^2.*theta6, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.^2.*theta6, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta3.*theta6, -theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.^2.*theta6, -theta2.^2.*theta4.*theta6, -theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, -theta1.*theta2.*theta3.*theta4, zeroCol, -theta1.*theta2.*theta3.*theta6, -theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.*theta6, zeroCol,];
        R6= [ zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6.^2, -2.*theta1.^3.*theta6, zeroCol, -2.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6.^2, -2.*theta2.^3.*theta6, zeroCol, -2.*theta3.^2.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta6.^2, -2.*theta3.^3.*theta6, zeroCol, -2.*theta4.^2.*theta6, zeroCol, -3.*theta4.^2.*theta6.^2, -2.*theta4.^3.*theta6, -2.*theta5.^2.*theta6, -3.*theta5.^2.*theta6.^2, -2.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, -theta3, zeroCol, -theta4, -theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta6.^3, zeroCol, -3.*theta2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta6.^3, zeroCol, -3.*theta3.*theta6.^2, zeroCol, -2.*theta4.*theta6, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta6.^3, zeroCol, -3.*theta4.*theta6.^2, -2.*theta5.*theta6, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, -4.*theta4.*theta6.^3, -3.*theta5.*theta6.^2, -theta4.^4, -theta5.^3, -4.*theta5.*theta6.^3, -theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta6, zeroCol, zeroCol, -3.*theta6.^2, zeroCol, -4.*theta6.^3, -5.*theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta3.*theta6, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, zeroCol, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, -theta1.^3.*theta3, zeroCol, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta5.*theta6, -theta1.*theta4.^3, -theta1.*theta5.^2, -3.*theta2.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, zeroCol, -3.*theta1.*theta5.*theta6.^2, -theta1.*theta5.^3, -3.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta5.*theta6, -theta2.*theta4.^3, -theta2.*theta5.^2, zeroCol, -2.*theta3.*theta4.*theta6, -theta3.*theta4.^2, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, zeroCol, -3.*theta2.*theta5.*theta6.^2, -theta2.*theta5.^3, -3.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta5.*theta6, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, -3.*theta3.*theta5.*theta6.^2, -theta3.*theta5.^3, -2.*theta4.*theta5.*theta6, -theta4.*theta5.^2, -theta3.^3.*theta5, -theta4.^2.*theta5, -3.*theta4.*theta5.*theta6.^2, -theta4.*theta5.^3, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta6, -2.*theta2.*theta3.^2.*theta6, zeroCol, -2.*theta1.^2.*theta4.*theta6, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta5.^2.*theta6, -2.*theta2.*theta4.^2.*theta6, zeroCol, -2.*theta1.^2.*theta5.*theta6, -theta1.^2.*theta5.^2, -2.*theta2.^2.*theta4.*theta6, -theta2.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta5.^2.*theta6, -2.*theta3.*theta4.^2.*theta6, -2.*theta2.^2.*theta5.*theta6, -theta2.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta6, -theta3.^2.*theta4.^2, -2.*theta3.*theta5.^2.*theta6, -2.*theta3.^2.*theta5.*theta6, -theta3.^2.*theta5.^2, -2.*theta4.*theta5.^2.*theta6, -2.*theta4.^2.*theta5.*theta6, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, -theta1.*theta5, -theta2.*theta4, zeroCol, -theta2.*theta5, -theta3.*theta4, -theta3.*theta5, -theta4.*theta5, zeroCol, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta3.*theta4, zeroCol, -theta1.*theta3.*theta5, -theta2.*theta3.*theta4, -theta1.*theta4.*theta5, -theta2.*theta3.*theta5, -theta2.*theta4.*theta5, -theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta3.^2, zeroCol, -theta1.*theta2.^2.*theta3, zeroCol, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta4.^2, zeroCol, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta4.^2, -theta1.*theta2.^2.*theta5, -theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta3.*theta5, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta1.^2.*theta4.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta5, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta4.*theta5, -theta1.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta5, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;R5;R6;];
    case 32
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
            theta5=DOF(:, 5);
            tdot5=DOFVel(:, 5);
            theta6=DOF(:, 6);
            tdot6=DOFVel(:, 6);
        LMT = [ theta1, theta2, theta3, theta4, theta5, theta6, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^2.*theta5.^2, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta1.^2.*theta5.^3, theta1.^2.*theta6.^2, theta1.^3.*theta5.^2, theta2.^2.*theta4.^3, theta2.^2.*theta5.^2, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta1.^2.*theta6.^3, theta1.^3.*theta6.^2, theta2.^2.*theta5.^3, theta2.^2.*theta6.^2, theta2.^3.*theta5.^2, theta3.^2.*theta4.^3, theta3.^2.*theta5.^2, theta3.^3.*theta4.^2, theta2.^2.*theta6.^3, theta2.^3.*theta6.^2, theta3.^2.*theta5.^3, theta3.^2.*theta6.^2, theta3.^3.*theta5.^2, theta4.^2.*theta5.^2, theta3.^2.*theta6.^3, theta3.^3.*theta6.^2, theta4.^2.*theta5.^3, theta4.^2.*theta6.^2, theta4.^3.*theta5.^2, theta4.^2.*theta6.^3, theta4.^3.*theta6.^2, theta5.^2.*theta6.^2, theta5.^2.*theta6.^3, theta5.^3.*theta6.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta1.*theta5, theta2.*theta4, theta1.*theta6, theta2.*theta5, theta3.*theta4, theta2.*theta6, theta3.*theta5, theta3.*theta6, theta4.*theta5, theta4.*theta6, theta5.*theta6, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta1.*theta5.^2, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^2.*theta5, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta1.*theta5.^3, theta1.*theta6.^2, theta2.*theta3.^4, theta2.*theta4.^3, theta2.*theta5.^2, theta3.*theta4.^2, theta1.^2.*theta6, theta1.^3.*theta5, theta2.^2.*theta5, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta1.*theta5.^4, theta1.*theta6.^3, theta2.*theta4.^4, theta2.*theta5.^3, theta2.*theta6.^2, theta3.*theta4.^3, theta3.*theta5.^2, theta1.^3.*theta6, theta2.^2.*theta6, theta1.^4.*theta5, theta2.^3.*theta5, theta3.^2.*theta5, theta2.^4.*theta4, theta3.^3.*theta4, theta1.*theta6.^4, theta2.*theta5.^4, theta2.*theta6.^3, theta3.*theta4.^4, theta3.*theta5.^3, theta3.*theta6.^2, theta4.*theta5.^2, theta1.^4.*theta6, theta2.^3.*theta6, theta3.^2.*theta6, theta2.^4.*theta5, theta3.^3.*theta5, theta4.^2.*theta5, theta3.^4.*theta4, theta2.*theta6.^4, theta3.*theta5.^4, theta3.*theta6.^3, theta4.*theta5.^3, theta4.*theta6.^2, theta2.^4.*theta6, theta3.^3.*theta6, theta4.^2.*theta6, theta3.^4.*theta5, theta4.^3.*theta5, theta3.*theta6.^4, theta4.*theta5.^4, theta4.*theta6.^3, theta5.*theta6.^2, theta3.^4.*theta6, theta4.^3.*theta6, theta5.^2.*theta6, theta4.^4.*theta5, theta4.*theta6.^4, theta5.*theta6.^3, theta4.^4.*theta6, theta5.^3.*theta6, theta5.*theta6.^4, theta5.^4.*theta6, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta5.^2, theta3.^5, theta4.^4, theta5.^3, theta6.^2, theta4.^5, theta5.^4, theta6.^3, theta5.^5, theta6.^4, theta6.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta2.*theta5.^2, theta1.*theta3.*theta4.^2, theta1.*theta2.^2.*theta5, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta2.*theta5, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta2.*theta5.^3, theta1.*theta2.*theta6.^2, theta1.*theta3.*theta4.^3, theta1.*theta3.*theta5.^2, theta1.*theta2.^2.*theta6, theta1.*theta2.^3.*theta5, theta1.*theta3.^2.*theta5, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^2.*theta2.*theta6, theta1.^2.*theta3.*theta5, theta1.^3.*theta2.*theta5, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta1.*theta2.*theta6.^3, theta1.*theta3.*theta5.^3, theta1.*theta3.*theta6.^2, theta1.*theta4.*theta5.^2, theta1.*theta2.^3.*theta6, theta1.*theta3.^2.*theta6, theta1.*theta3.^3.*theta5, theta1.*theta4.^2.*theta5, theta2.*theta3.*theta4.^3, theta2.*theta3.*theta5.^2, theta2.*theta3.^2.*theta5, theta2.*theta3.^3.*theta4, theta1.^2.*theta3.*theta6, theta1.^2.*theta4.*theta5, theta1.^3.*theta2.*theta6, theta1.^3.*theta3.*theta5, theta2.^2.*theta3.*theta5, theta2.^3.*theta3.*theta4, theta1.*theta3.*theta6.^3, theta1.*theta4.*theta5.^3, theta1.*theta4.*theta6.^2, theta1.*theta3.^3.*theta6, theta1.*theta4.^2.*theta6, theta1.*theta4.^3.*theta5, theta2.*theta3.*theta5.^3, theta2.*theta3.*theta6.^2, theta2.*theta4.*theta5.^2, theta2.*theta3.^2.*theta6, theta2.*theta3.^3.*theta5, theta2.*theta4.^2.*theta5, theta1.^2.*theta4.*theta6, theta1.^3.*theta3.*theta6, theta1.^3.*theta4.*theta5, theta2.^2.*theta3.*theta6, theta2.^2.*theta4.*theta5, theta2.^3.*theta3.*theta5, theta1.*theta4.*theta6.^3, theta1.*theta5.*theta6.^2, theta1.*theta4.^3.*theta6, theta1.*theta5.^2.*theta6, theta2.*theta3.*theta6.^3, theta2.*theta4.*theta5.^3, theta2.*theta4.*theta6.^2, theta2.*theta3.^3.*theta6, theta2.*theta4.^2.*theta6, theta2.*theta4.^3.*theta5, theta3.*theta4.*theta5.^2, theta3.*theta4.^2.*theta5, theta1.^2.*theta5.*theta6, theta1.^3.*theta4.*theta6, theta2.^2.*theta4.*theta6, theta2.^3.*theta3.*theta6, theta2.^3.*theta4.*theta5, theta3.^2.*theta4.*theta5, theta1.*theta5.*theta6.^3, theta1.*theta5.^3.*theta6, theta2.*theta4.*theta6.^3, theta2.*theta5.*theta6.^2, theta2.*theta4.^3.*theta6, theta2.*theta5.^2.*theta6, theta3.*theta4.*theta5.^3, theta3.*theta4.*theta6.^2, theta3.*theta4.^2.*theta6, theta3.*theta4.^3.*theta5, theta1.^3.*theta5.*theta6, theta2.^2.*theta5.*theta6, theta2.^3.*theta4.*theta6, theta3.^2.*theta4.*theta6, theta3.^3.*theta4.*theta5, theta2.*theta5.*theta6.^3, theta2.*theta5.^3.*theta6, theta3.*theta4.*theta6.^3, theta3.*theta5.*theta6.^2, theta3.*theta4.^3.*theta6, theta3.*theta5.^2.*theta6, theta2.^3.*theta5.*theta6, theta3.^2.*theta5.*theta6, theta3.^3.*theta4.*theta6, theta3.*theta5.*theta6.^3, theta3.*theta5.^3.*theta6, theta4.*theta5.*theta6.^2, theta4.*theta5.^2.*theta6, theta3.^3.*theta5.*theta6, theta4.^2.*theta5.*theta6, theta4.*theta5.*theta6.^3, theta4.*theta5.^3.*theta6, theta4.^3.*theta5.*theta6, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta2.^2.*theta5.^2, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta5.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta2.^2.*theta5, theta1.^2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta6.^2, theta1.*theta3.^2.*theta5.^2, theta2.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta6.^2, theta1.^2.*theta3.*theta5.^2, theta1.^2.*theta2.^2.*theta6, theta1.^2.*theta3.^2.*theta5, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta3.^2.*theta6.^2, theta1.*theta4.^2.*theta5.^2, theta2.*theta3.^2.*theta5.^2, theta1.^2.*theta3.*theta6.^2, theta1.^2.*theta4.*theta5.^2, theta1.^2.*theta3.^2.*theta6, theta1.^2.*theta4.^2.*theta5, theta2.^2.*theta3.*theta5.^2, theta2.^2.*theta3.^2.*theta5, theta1.*theta4.^2.*theta6.^2, theta2.*theta3.^2.*theta6.^2, theta2.*theta4.^2.*theta5.^2, theta1.^2.*theta4.*theta6.^2, theta1.^2.*theta4.^2.*theta6, theta2.^2.*theta3.*theta6.^2, theta2.^2.*theta4.*theta5.^2, theta2.^2.*theta3.^2.*theta6, theta2.^2.*theta4.^2.*theta5, theta1.*theta5.^2.*theta6.^2, theta2.*theta4.^2.*theta6.^2, theta3.*theta4.^2.*theta5.^2, theta1.^2.*theta5.*theta6.^2, theta1.^2.*theta5.^2.*theta6, theta2.^2.*theta4.*theta6.^2, theta2.^2.*theta4.^2.*theta6, theta3.^2.*theta4.*theta5.^2, theta3.^2.*theta4.^2.*theta5, theta2.*theta5.^2.*theta6.^2, theta3.*theta4.^2.*theta6.^2, theta2.^2.*theta5.*theta6.^2, theta2.^2.*theta5.^2.*theta6, theta3.^2.*theta4.*theta6.^2, theta3.^2.*theta4.^2.*theta6, theta3.*theta5.^2.*theta6.^2, theta3.^2.*theta5.*theta6.^2, theta3.^2.*theta5.^2.*theta6, theta4.*theta5.^2.*theta6.^2, theta4.^2.*theta5.*theta6.^2, theta4.^2.*theta5.^2.*theta6, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta2.*theta5, theta1.*theta3.*theta4, theta1.*theta2.*theta6, theta1.*theta3.*theta5, theta2.*theta3.*theta4, theta1.*theta3.*theta6, theta1.*theta4.*theta5, theta2.*theta3.*theta5, theta1.*theta4.*theta6, theta2.*theta3.*theta6, theta2.*theta4.*theta5, theta1.*theta5.*theta6, theta2.*theta4.*theta6, theta3.*theta4.*theta5, theta2.*theta5.*theta6, theta3.*theta4.*theta6, theta3.*theta5.*theta6, theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6, theta1.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6, theta1.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6, theta1.*theta3.*theta4.*theta6, theta2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6, theta2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6, theta2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5.^2, theta1.*theta2.*theta3.^2.*theta5, theta1.*theta2.^2.*theta3.*theta5, theta1.^2.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6.^2, theta1.*theta2.*theta4.*theta5.^2, theta1.*theta2.*theta3.^2.*theta6, theta1.*theta2.*theta4.^2.*theta5, theta1.*theta2.^2.*theta3.*theta6, theta1.*theta2.^2.*theta4.*theta5, theta1.^2.*theta2.*theta3.*theta6, theta1.^2.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6.^2, theta1.*theta2.*theta4.^2.*theta6, theta1.*theta3.*theta4.*theta5.^2, theta1.*theta3.*theta4.^2.*theta5, theta1.*theta2.^2.*theta4.*theta6, theta1.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta4.*theta6, theta1.^2.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6.^2, theta1.*theta2.*theta5.^2.*theta6, theta1.*theta3.*theta4.*theta6.^2, theta1.*theta3.*theta4.^2.*theta6, theta1.*theta2.^2.*theta5.*theta6, theta1.*theta3.^2.*theta4.*theta6, theta2.*theta3.*theta4.*theta5.^2, theta2.*theta3.*theta4.^2.*theta5, theta2.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta5.*theta6, theta1.^2.*theta3.*theta4.*theta6, theta2.^2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6.^2, theta1.*theta3.*theta5.^2.*theta6, theta1.*theta3.^2.*theta5.*theta6, theta2.*theta3.*theta4.*theta6.^2, theta2.*theta3.*theta4.^2.*theta6, theta2.*theta3.^2.*theta4.*theta6, theta1.^2.*theta3.*theta5.*theta6, theta2.^2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6.^2, theta1.*theta4.*theta5.^2.*theta6, theta1.*theta4.^2.*theta5.*theta6, theta2.*theta3.*theta5.*theta6.^2, theta2.*theta3.*theta5.^2.*theta6, theta2.*theta3.^2.*theta5.*theta6, theta1.^2.*theta4.*theta5.*theta6, theta2.^2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6.^2, theta2.*theta4.*theta5.^2.*theta6, theta2.*theta4.^2.*theta5.*theta6, theta2.^2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6.^2, theta3.*theta4.*theta5.^2.*theta6, theta3.*theta4.^2.*theta5.*theta6, theta3.^2.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.*theta5, theta1.*theta2.*theta3.*theta4.*theta6, theta1.*theta2.*theta3.*theta5.*theta6, theta1.*theta2.*theta4.*theta5.*theta6, theta1.*theta3.*theta4.*theta5.*theta6, theta2.*theta3.*theta4.*theta5.*theta6, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, tdot5, tdot6, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot1.*theta1.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta5, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot1.*theta1.*theta5.^3 + 3.*tdot5.*theta1.^2.*theta5.^2, 2.*tdot1.*theta1.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta6, 2.*tdot5.*theta1.^3.*theta5 + 3.*tdot1.*theta1.^2.*theta5.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot2.*theta2.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta5, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot1.*theta1.*theta6.^3 + 3.*tdot6.*theta1.^2.*theta6.^2, 2.*tdot6.*theta1.^3.*theta6 + 3.*tdot1.*theta1.^2.*theta6.^2, 2.*tdot2.*theta2.*theta5.^3 + 3.*tdot5.*theta2.^2.*theta5.^2, 2.*tdot2.*theta2.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta6, 2.*tdot5.*theta2.^3.*theta5 + 3.*tdot2.*theta2.^2.*theta5.^2, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot3.*theta3.*theta5.^2 + 2.*tdot5.*theta3.^2.*theta5, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, 2.*tdot2.*theta2.*theta6.^3 + 3.*tdot6.*theta2.^2.*theta6.^2, 2.*tdot6.*theta2.^3.*theta6 + 3.*tdot2.*theta2.^2.*theta6.^2, 2.*tdot3.*theta3.*theta5.^3 + 3.*tdot5.*theta3.^2.*theta5.^2, 2.*tdot3.*theta3.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta6, 2.*tdot5.*theta3.^3.*theta5 + 3.*tdot3.*theta3.^2.*theta5.^2, 2.*tdot4.*theta4.*theta5.^2 + 2.*tdot5.*theta4.^2.*theta5, 2.*tdot3.*theta3.*theta6.^3 + 3.*tdot6.*theta3.^2.*theta6.^2, 2.*tdot6.*theta3.^3.*theta6 + 3.*tdot3.*theta3.^2.*theta6.^2, 2.*tdot4.*theta4.*theta5.^3 + 3.*tdot5.*theta4.^2.*theta5.^2, 2.*tdot4.*theta4.*theta6.^2 + 2.*tdot6.*theta4.^2.*theta6, 2.*tdot5.*theta4.^3.*theta5 + 3.*tdot4.*theta4.^2.*theta5.^2, 2.*tdot4.*theta4.*theta6.^3 + 3.*tdot6.*theta4.^2.*theta6.^2, 2.*tdot6.*theta4.^3.*theta6 + 3.*tdot4.*theta4.^2.*theta6.^2, 2.*tdot5.*theta5.*theta6.^2 + 2.*tdot6.*theta5.^2.*theta6, 2.*tdot5.*theta5.*theta6.^3 + 3.*tdot6.*theta5.^2.*theta6.^2, 2.*tdot6.*theta5.^3.*theta6 + 3.*tdot5.*theta5.^2.*theta6.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta5 + tdot5.*theta1, tdot2.*theta4 + tdot4.*theta2, tdot1.*theta6 + tdot6.*theta1, tdot2.*theta5 + tdot5.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot2.*theta6 + tdot6.*theta2, tdot3.*theta5 + tdot5.*theta3, tdot3.*theta6 + tdot6.*theta3, tdot4.*theta5 + tdot5.*theta4, tdot4.*theta6 + tdot6.*theta4, tdot5.*theta6 + tdot6.*theta5, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot1.*theta5.^2 + 2.*tdot5.*theta1.*theta5, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot5.*theta1.^2 + 2.*tdot1.*theta1.*theta5, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot1.*theta5.^3 + 3.*tdot5.*theta1.*theta5.^2, tdot1.*theta6.^2 + 2.*tdot6.*theta1.*theta6, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot2.*theta5.^2 + 2.*tdot5.*theta2.*theta5, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot6.*theta1.^2 + 2.*tdot1.*theta1.*theta6, tdot5.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta5, tdot5.*theta2.^2 + 2.*tdot2.*theta2.*theta5, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot1.*theta5.^4 + 4.*tdot5.*theta1.*theta5.^3, tdot1.*theta6.^3 + 3.*tdot6.*theta1.*theta6.^2, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot2.*theta5.^3 + 3.*tdot5.*theta2.*theta5.^2, tdot2.*theta6.^2 + 2.*tdot6.*theta2.*theta6, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot3.*theta5.^2 + 2.*tdot5.*theta3.*theta5, tdot6.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta6, tdot6.*theta2.^2 + 2.*tdot2.*theta2.*theta6, tdot5.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta5, tdot5.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta5, tdot5.*theta3.^2 + 2.*tdot3.*theta3.*theta5, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot1.*theta6.^4 + 4.*tdot6.*theta1.*theta6.^3, tdot2.*theta5.^4 + 4.*tdot5.*theta2.*theta5.^3, tdot2.*theta6.^3 + 3.*tdot6.*theta2.*theta6.^2, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot3.*theta5.^3 + 3.*tdot5.*theta3.*theta5.^2, tdot3.*theta6.^2 + 2.*tdot6.*theta3.*theta6, tdot4.*theta5.^2 + 2.*tdot5.*theta4.*theta5, tdot6.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta6, tdot6.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta6, tdot6.*theta3.^2 + 2.*tdot3.*theta3.*theta6, tdot5.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta5, tdot5.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta5, tdot5.*theta4.^2 + 2.*tdot4.*theta4.*theta5, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, tdot2.*theta6.^4 + 4.*tdot6.*theta2.*theta6.^3, tdot3.*theta5.^4 + 4.*tdot5.*theta3.*theta5.^3, tdot3.*theta6.^3 + 3.*tdot6.*theta3.*theta6.^2, tdot4.*theta5.^3 + 3.*tdot5.*theta4.*theta5.^2, tdot4.*theta6.^2 + 2.*tdot6.*theta4.*theta6, tdot6.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta6, tdot6.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta6, tdot6.*theta4.^2 + 2.*tdot4.*theta4.*theta6, tdot5.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta5, tdot5.*theta4.^3 + 3.*tdot4.*theta4.^2.*theta5, tdot3.*theta6.^4 + 4.*tdot6.*theta3.*theta6.^3, tdot4.*theta5.^4 + 4.*tdot5.*theta4.*theta5.^3, tdot4.*theta6.^3 + 3.*tdot6.*theta4.*theta6.^2, tdot5.*theta6.^2 + 2.*tdot6.*theta5.*theta6, tdot6.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta6, tdot6.*theta4.^3 + 3.*tdot4.*theta4.^2.*theta6, tdot6.*theta5.^2 + 2.*tdot5.*theta5.*theta6, tdot5.*theta4.^4 + 4.*tdot4.*theta4.^3.*theta5, tdot4.*theta6.^4 + 4.*tdot6.*theta4.*theta6.^3, tdot5.*theta6.^3 + 3.*tdot6.*theta5.*theta6.^2, tdot6.*theta4.^4 + 4.*tdot4.*theta4.^3.*theta6, tdot6.*theta5.^3 + 3.*tdot5.*theta5.^2.*theta6, tdot5.*theta6.^4 + 4.*tdot6.*theta5.*theta6.^3, tdot6.*theta5.^4 + 4.*tdot5.*theta5.^3.*theta6, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 2.*tdot5.*theta5, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 3.*tdot5.*theta5.^2, 2.*tdot6.*theta6, 5.*tdot4.*theta4.^4, 4.*tdot5.*theta5.^3, 3.*tdot6.*theta6.^2, 5.*tdot5.*theta5.^4, 4.*tdot6.*theta6.^3, 5.*tdot6.*theta6.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta2.*theta5.^2 + tdot2.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta5, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta5, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot2.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta5, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta2.*theta5.^3 + tdot2.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta2.*theta5.^2, tdot1.*theta2.*theta6.^2 + tdot2.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta6, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.*theta5.^2 + tdot3.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta5, tdot1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta6, tdot1.*theta2.^3.*theta5 + tdot5.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta5, tdot1.*theta3.^2.*theta5 + tdot5.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta5, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta6, tdot3.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta5, tdot2.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta5, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot1.*theta2.*theta6.^3 + tdot2.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta2.*theta6.^2, tdot1.*theta3.*theta5.^3 + tdot3.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta3.*theta5.^2, tdot1.*theta3.*theta6.^2 + tdot3.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta6, tdot1.*theta4.*theta5.^2 + tdot4.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta4.*theta5, tdot1.*theta2.^3.*theta6 + tdot6.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta6, tdot1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta6, tdot1.*theta3.^3.*theta5 + tdot5.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta5, tdot1.*theta4.^2.*theta5 + tdot5.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta4.*theta5, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.*theta5.^2 + tdot3.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta5, tdot2.*theta3.^2.*theta5 + tdot5.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta5, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta6, tdot4.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta4 + 2.*tdot1.*theta1.*theta4.*theta5, tdot2.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta6, tdot3.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta5, tdot3.*theta2.^2.*theta5 + tdot5.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta5, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta3.*theta6.^3 + tdot3.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta3.*theta6.^2, tdot1.*theta4.*theta5.^3 + tdot4.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta4.*theta5.^2, tdot1.*theta4.*theta6.^2 + tdot4.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta4.*theta6, tdot1.*theta3.^3.*theta6 + tdot6.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta6, tdot1.*theta4.^2.*theta6 + tdot6.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta4.*theta6, tdot1.*theta4.^3.*theta5 + tdot5.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2.*theta5, tdot2.*theta3.*theta5.^3 + tdot3.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta3.*theta5.^2, tdot2.*theta3.*theta6.^2 + tdot3.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta6, tdot2.*theta4.*theta5.^2 + tdot4.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta4.*theta5, tdot2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta6, tdot2.*theta3.^3.*theta5 + tdot5.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta5, tdot2.*theta4.^2.*theta5 + tdot5.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta4.*theta5, tdot4.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta4 + 2.*tdot1.*theta1.*theta4.*theta6, tdot3.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta6, tdot4.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.*theta5, tdot3.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta6, tdot4.*theta2.^2.*theta5 + tdot5.*theta2.^2.*theta4 + 2.*tdot2.*theta2.*theta4.*theta5, tdot3.*theta2.^3.*theta5 + tdot5.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta5, tdot1.*theta4.*theta6.^3 + tdot4.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta4.*theta6.^2, tdot1.*theta5.*theta6.^2 + tdot5.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta5.*theta6, tdot1.*theta4.^3.*theta6 + tdot6.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2.*theta6, tdot1.*theta5.^2.*theta6 + tdot6.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta5.*theta6, tdot2.*theta3.*theta6.^3 + tdot3.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta3.*theta6.^2, tdot2.*theta4.*theta5.^3 + tdot4.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta4.*theta5.^2, tdot2.*theta4.*theta6.^2 + tdot4.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta4.*theta6, tdot2.*theta3.^3.*theta6 + tdot6.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta6, tdot2.*theta4.^2.*theta6 + tdot6.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta4.*theta6, tdot2.*theta4.^3.*theta5 + tdot5.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2.*theta5, tdot3.*theta4.*theta5.^2 + tdot4.*theta3.*theta5.^2 + 2.*tdot5.*theta3.*theta4.*theta5, tdot3.*theta4.^2.*theta5 + tdot5.*theta3.*theta4.^2 + 2.*tdot4.*theta3.*theta4.*theta5, tdot5.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta5 + 2.*tdot1.*theta1.*theta5.*theta6, tdot4.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.*theta6, tdot4.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta4 + 2.*tdot2.*theta2.*theta4.*theta6, tdot3.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta6, tdot4.*theta2.^3.*theta5 + tdot5.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.*theta5, tdot4.*theta3.^2.*theta5 + tdot5.*theta3.^2.*theta4 + 2.*tdot3.*theta3.*theta4.*theta5, tdot1.*theta5.*theta6.^3 + tdot5.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta5.*theta6.^2, tdot1.*theta5.^3.*theta6 + tdot6.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta5.^2.*theta6, tdot2.*theta4.*theta6.^3 + tdot4.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta4.*theta6.^2, tdot2.*theta5.*theta6.^2 + tdot5.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta5.*theta6, tdot2.*theta4.^3.*theta6 + tdot6.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2.*theta6, tdot2.*theta5.^2.*theta6 + tdot6.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta5.*theta6, tdot3.*theta4.*theta5.^3 + tdot4.*theta3.*theta5.^3 + 3.*tdot5.*theta3.*theta4.*theta5.^2, tdot3.*theta4.*theta6.^2 + tdot4.*theta3.*theta6.^2 + 2.*tdot6.*theta3.*theta4.*theta6, tdot3.*theta4.^2.*theta6 + tdot6.*theta3.*theta4.^2 + 2.*tdot4.*theta3.*theta4.*theta6, tdot3.*theta4.^3.*theta5 + tdot5.*theta3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2.*theta5, tdot5.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta5 + 3.*tdot1.*theta1.^2.*theta5.*theta6, tdot5.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta5 + 2.*tdot2.*theta2.*theta5.*theta6, tdot4.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.*theta6, tdot4.*theta3.^2.*theta6 + tdot6.*theta3.^2.*theta4 + 2.*tdot3.*theta3.*theta4.*theta6, tdot4.*theta3.^3.*theta5 + tdot5.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.*theta5, tdot2.*theta5.*theta6.^3 + tdot5.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta5.*theta6.^2, tdot2.*theta5.^3.*theta6 + tdot6.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta5.^2.*theta6, tdot3.*theta4.*theta6.^3 + tdot4.*theta3.*theta6.^3 + 3.*tdot6.*theta3.*theta4.*theta6.^2, tdot3.*theta5.*theta6.^2 + tdot5.*theta3.*theta6.^2 + 2.*tdot6.*theta3.*theta5.*theta6, tdot3.*theta4.^3.*theta6 + tdot6.*theta3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2.*theta6, tdot3.*theta5.^2.*theta6 + tdot6.*theta3.*theta5.^2 + 2.*tdot5.*theta3.*theta5.*theta6, tdot5.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta5 + 3.*tdot2.*theta2.^2.*theta5.*theta6, tdot5.*theta3.^2.*theta6 + tdot6.*theta3.^2.*theta5 + 2.*tdot3.*theta3.*theta5.*theta6, tdot4.*theta3.^3.*theta6 + tdot6.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.*theta6, tdot3.*theta5.*theta6.^3 + tdot5.*theta3.*theta6.^3 + 3.*tdot6.*theta3.*theta5.*theta6.^2, tdot3.*theta5.^3.*theta6 + tdot6.*theta3.*theta5.^3 + 3.*tdot5.*theta3.*theta5.^2.*theta6, tdot4.*theta5.*theta6.^2 + tdot5.*theta4.*theta6.^2 + 2.*tdot6.*theta4.*theta5.*theta6, tdot4.*theta5.^2.*theta6 + tdot6.*theta4.*theta5.^2 + 2.*tdot5.*theta4.*theta5.*theta6, tdot5.*theta3.^3.*theta6 + tdot6.*theta3.^3.*theta5 + 3.*tdot3.*theta3.^2.*theta5.*theta6, tdot5.*theta4.^2.*theta6 + tdot6.*theta4.^2.*theta5 + 2.*tdot4.*theta4.*theta5.*theta6, tdot4.*theta5.*theta6.^3 + tdot5.*theta4.*theta6.^3 + 3.*tdot6.*theta4.*theta5.*theta6.^2, tdot4.*theta5.^3.*theta6 + tdot6.*theta4.*theta5.^3 + 3.*tdot5.*theta4.*theta5.^2.*theta6, tdot5.*theta4.^3.*theta6 + tdot6.*theta4.^3.*theta5 + 3.*tdot4.*theta4.^2.*theta5.*theta6, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.^2.*theta5, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot2.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta2.*theta5, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot5.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta5 + 2.*tdot2.*theta1.^2.*theta2.*theta5, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.^2.*theta6, tdot1.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.^2.*theta5, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot2.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta2.*theta6, tdot3.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta3.*theta5, tdot6.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta6 + 2.*tdot2.*theta1.^2.*theta2.*theta6, tdot5.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta5 + 2.*tdot3.*theta1.^2.*theta3.*theta5, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.^2.*theta6, tdot1.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.*theta4.^2.*theta5, tdot2.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.^2.*theta5, tdot3.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta3.*theta6, tdot4.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta4.*theta5, tdot6.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta6 + 2.*tdot3.*theta1.^2.*theta3.*theta6, tdot5.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta4.^2.*theta5 + 2.*tdot4.*theta1.^2.*theta4.*theta5, tdot3.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta3.*theta5, tdot5.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta5 + 2.*tdot3.*theta2.^2.*theta3.*theta5, tdot1.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.*theta4.^2.*theta6, tdot2.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.^2.*theta6, tdot2.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.*theta4.^2.*theta5, tdot4.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta4.*theta6, tdot6.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta4.^2.*theta6 + 2.*tdot4.*theta1.^2.*theta4.*theta6, tdot3.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta3.*theta6, tdot4.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta4.*theta5, tdot6.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta6 + 2.*tdot3.*theta2.^2.*theta3.*theta6, tdot5.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta4.^2.*theta5 + 2.*tdot4.*theta2.^2.*theta4.*theta5, tdot1.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta1.*theta5.*theta6.^2 + 2.*tdot6.*theta1.*theta5.^2.*theta6, tdot2.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.*theta4.^2.*theta6, tdot3.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.*theta4.^2.*theta5, tdot5.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta5.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta5.*theta6, tdot6.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta5.^2.*theta6 + 2.*tdot5.*theta1.^2.*theta5.*theta6, tdot4.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta4.*theta6, tdot6.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta4.^2.*theta6 + 2.*tdot4.*theta2.^2.*theta4.*theta6, tdot4.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.^2.*theta4.*theta5, tdot5.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta3.*theta4.^2.*theta5 + 2.*tdot4.*theta3.^2.*theta4.*theta5, tdot2.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta2.*theta5.*theta6.^2 + 2.*tdot6.*theta2.*theta5.^2.*theta6, tdot3.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.*theta4.^2.*theta6, tdot5.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta5.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta5.*theta6, tdot6.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta5.^2.*theta6 + 2.*tdot5.*theta2.^2.*theta5.*theta6, tdot4.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta4.*theta6, tdot6.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta3.*theta4.^2.*theta6 + 2.*tdot4.*theta3.^2.*theta4.*theta6, tdot3.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta3.*theta5.*theta6.^2 + 2.*tdot6.*theta3.*theta5.^2.*theta6, tdot5.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta3.*theta5.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta5.*theta6, tdot6.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta3.*theta5.^2.*theta6 + 2.*tdot5.*theta3.^2.*theta5.*theta6, tdot4.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta4.*theta5.*theta6.^2 + 2.*tdot6.*theta4.*theta5.^2.*theta6, tdot5.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta4.*theta5.*theta6.^2 + 2.*tdot6.*theta4.^2.*theta5.*theta6, tdot6.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta4.*theta5.^2.*theta6 + 2.*tdot5.*theta4.^2.*theta5.*theta6, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta2.*theta5 + tdot2.*theta1.*theta5 + tdot5.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot1.*theta2.*theta6 + tdot2.*theta1.*theta6 + tdot6.*theta1.*theta2, tdot1.*theta3.*theta5 + tdot3.*theta1.*theta5 + tdot5.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta3.*theta6 + tdot3.*theta1.*theta6 + tdot6.*theta1.*theta3, tdot1.*theta4.*theta5 + tdot4.*theta1.*theta5 + tdot5.*theta1.*theta4, tdot2.*theta3.*theta5 + tdot3.*theta2.*theta5 + tdot5.*theta2.*theta3, tdot1.*theta4.*theta6 + tdot4.*theta1.*theta6 + tdot6.*theta1.*theta4, tdot2.*theta3.*theta6 + tdot3.*theta2.*theta6 + tdot6.*theta2.*theta3, tdot2.*theta4.*theta5 + tdot4.*theta2.*theta5 + tdot5.*theta2.*theta4, tdot1.*theta5.*theta6 + tdot5.*theta1.*theta6 + tdot6.*theta1.*theta5, tdot2.*theta4.*theta6 + tdot4.*theta2.*theta6 + tdot6.*theta2.*theta4, tdot3.*theta4.*theta5 + tdot4.*theta3.*theta5 + tdot5.*theta3.*theta4, tdot2.*theta5.*theta6 + tdot5.*theta2.*theta6 + tdot6.*theta2.*theta5, tdot3.*theta4.*theta6 + tdot4.*theta3.*theta6 + tdot6.*theta3.*theta4, tdot3.*theta5.*theta6 + tdot5.*theta3.*theta6 + tdot6.*theta3.*theta5, tdot4.*theta5.*theta6 + tdot5.*theta4.*theta6 + tdot6.*theta4.*theta5, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta5 + tdot2.*theta1.*theta3.*theta5 + tdot3.*theta1.*theta2.*theta5 + tdot5.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta6 + tdot2.*theta1.*theta3.*theta6 + tdot3.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta3, tdot1.*theta2.*theta4.*theta5 + tdot2.*theta1.*theta4.*theta5 + tdot4.*theta1.*theta2.*theta5 + tdot5.*theta1.*theta2.*theta4, tdot1.*theta2.*theta4.*theta6 + tdot2.*theta1.*theta4.*theta6 + tdot4.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta4, tdot1.*theta3.*theta4.*theta5 + tdot3.*theta1.*theta4.*theta5 + tdot4.*theta1.*theta3.*theta5 + tdot5.*theta1.*theta3.*theta4, tdot1.*theta2.*theta5.*theta6 + tdot2.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta5, tdot1.*theta3.*theta4.*theta6 + tdot3.*theta1.*theta4.*theta6 + tdot4.*theta1.*theta3.*theta6 + tdot6.*theta1.*theta3.*theta4, tdot2.*theta3.*theta4.*theta5 + tdot3.*theta2.*theta4.*theta5 + tdot4.*theta2.*theta3.*theta5 + tdot5.*theta2.*theta3.*theta4, tdot1.*theta3.*theta5.*theta6 + tdot3.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta3.*theta6 + tdot6.*theta1.*theta3.*theta5, tdot2.*theta3.*theta4.*theta6 + tdot3.*theta2.*theta4.*theta6 + tdot4.*theta2.*theta3.*theta6 + tdot6.*theta2.*theta3.*theta4, tdot1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta4.*theta6 + tdot6.*theta1.*theta4.*theta5, tdot2.*theta3.*theta5.*theta6 + tdot3.*theta2.*theta5.*theta6 + tdot5.*theta2.*theta3.*theta6 + tdot6.*theta2.*theta3.*theta5, tdot2.*theta4.*theta5.*theta6 + tdot4.*theta2.*theta5.*theta6 + tdot5.*theta2.*theta4.*theta6 + tdot6.*theta2.*theta4.*theta5, tdot3.*theta4.*theta5.*theta6 + tdot4.*theta3.*theta5.*theta6 + tdot5.*theta3.*theta4.*theta6 + tdot6.*theta3.*theta4.*theta5, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta5.^2 + tdot2.*theta1.*theta3.*theta5.^2 + tdot3.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta3.^2.*theta5 + tdot2.*theta1.*theta3.^2.*theta5 + tdot5.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.^2.*theta3.*theta5 + tdot3.*theta1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta5, tdot2.*theta1.^2.*theta3.*theta5 + tdot3.*theta1.^2.*theta2.*theta5 + tdot5.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta3.*theta6.^2 + tdot2.*theta1.*theta3.*theta6.^2 + tdot3.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.*theta4.*theta5.^2 + tdot2.*theta1.*theta4.*theta5.^2 + tdot4.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.*theta3.^2.*theta6 + tdot2.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.*theta4.^2.*theta5 + tdot2.*theta1.*theta4.^2.*theta5 + tdot5.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.^2.*theta3.*theta6 + tdot3.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.^2.*theta4.*theta5 + tdot4.*theta1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.*theta2.*theta4.*theta5, tdot2.*theta1.^2.*theta3.*theta6 + tdot3.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta6, tdot2.*theta1.^2.*theta4.*theta5 + tdot4.*theta1.^2.*theta2.*theta5 + tdot5.*theta1.^2.*theta2.*theta4 + 2.*tdot1.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.*theta4.*theta6.^2 + tdot2.*theta1.*theta4.*theta6.^2 + tdot4.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta4.*theta6, tdot1.*theta2.*theta4.^2.*theta6 + tdot2.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4.*theta6, tdot1.*theta3.*theta4.*theta5.^2 + tdot3.*theta1.*theta4.*theta5.^2 + tdot4.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta4.*theta5, tdot1.*theta3.*theta4.^2.*theta5 + tdot3.*theta1.*theta4.^2.*theta5 + tdot5.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4.*theta5, tdot1.*theta2.^2.*theta4.*theta6 + tdot4.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.*theta2.*theta4.*theta6, tdot1.*theta3.^2.*theta4.*theta5 + tdot4.*theta1.*theta3.^2.*theta5 + tdot5.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.*theta3.*theta4.*theta5, tdot2.*theta1.^2.*theta4.*theta6 + tdot4.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta4 + 2.*tdot1.*theta1.*theta2.*theta4.*theta6, tdot3.*theta1.^2.*theta4.*theta5 + tdot4.*theta1.^2.*theta3.*theta5 + tdot5.*theta1.^2.*theta3.*theta4 + 2.*tdot1.*theta1.*theta3.*theta4.*theta5, tdot1.*theta2.*theta5.*theta6.^2 + tdot2.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta5.*theta6, tdot1.*theta2.*theta5.^2.*theta6 + tdot2.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta5.*theta6, tdot1.*theta3.*theta4.*theta6.^2 + tdot3.*theta1.*theta4.*theta6.^2 + tdot4.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta4.*theta6, tdot1.*theta3.*theta4.^2.*theta6 + tdot3.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4.*theta6, tdot1.*theta2.^2.*theta5.*theta6 + tdot5.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta5 + 2.*tdot2.*theta1.*theta2.*theta5.*theta6, tdot1.*theta3.^2.*theta4.*theta6 + tdot4.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.*theta3.*theta4.*theta6, tdot2.*theta3.*theta4.*theta5.^2 + tdot3.*theta2.*theta4.*theta5.^2 + tdot4.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta4.*theta5, tdot2.*theta3.*theta4.^2.*theta5 + tdot3.*theta2.*theta4.^2.*theta5 + tdot5.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4.*theta5, tdot2.*theta3.^2.*theta4.*theta5 + tdot4.*theta2.*theta3.^2.*theta5 + tdot5.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.*theta3.*theta4.*theta5, tdot2.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta5 + 2.*tdot1.*theta1.*theta2.*theta5.*theta6, tdot3.*theta1.^2.*theta4.*theta6 + tdot4.*theta1.^2.*theta3.*theta6 + tdot6.*theta1.^2.*theta3.*theta4 + 2.*tdot1.*theta1.*theta3.*theta4.*theta6, tdot3.*theta2.^2.*theta4.*theta5 + tdot4.*theta2.^2.*theta3.*theta5 + tdot5.*theta2.^2.*theta3.*theta4 + 2.*tdot2.*theta2.*theta3.*theta4.*theta5, tdot1.*theta3.*theta5.*theta6.^2 + tdot3.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta5.*theta6, tdot1.*theta3.*theta5.^2.*theta6 + tdot3.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta5.*theta6, tdot1.*theta3.^2.*theta5.*theta6 + tdot5.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2.*theta5 + 2.*tdot3.*theta1.*theta3.*theta5.*theta6, tdot2.*theta3.*theta4.*theta6.^2 + tdot3.*theta2.*theta4.*theta6.^2 + tdot4.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta4.*theta6, tdot2.*theta3.*theta4.^2.*theta6 + tdot3.*theta2.*theta4.^2.*theta6 + tdot6.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4.*theta6, tdot2.*theta3.^2.*theta4.*theta6 + tdot4.*theta2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.*theta3.*theta4.*theta6, tdot3.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta3.*theta6 + tdot6.*theta1.^2.*theta3.*theta5 + 2.*tdot1.*theta1.*theta3.*theta5.*theta6, tdot3.*theta2.^2.*theta4.*theta6 + tdot4.*theta2.^2.*theta3.*theta6 + tdot6.*theta2.^2.*theta3.*theta4 + 2.*tdot2.*theta2.*theta3.*theta4.*theta6, tdot1.*theta4.*theta5.*theta6.^2 + tdot4.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.*theta4.*theta5.*theta6, tdot1.*theta4.*theta5.^2.*theta6 + tdot4.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.*theta4.*theta5.*theta6, tdot1.*theta4.^2.*theta5.*theta6 + tdot5.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta4.^2.*theta5 + 2.*tdot4.*theta1.*theta4.*theta5.*theta6, tdot2.*theta3.*theta5.*theta6.^2 + tdot3.*theta2.*theta5.*theta6.^2 + tdot5.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta5.*theta6, tdot2.*theta3.*theta5.^2.*theta6 + tdot3.*theta2.*theta5.^2.*theta6 + tdot6.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta5.*theta6, tdot2.*theta3.^2.*theta5.*theta6 + tdot5.*theta2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2.*theta5 + 2.*tdot3.*theta2.*theta3.*theta5.*theta6, tdot4.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta4.*theta6 + tdot6.*theta1.^2.*theta4.*theta5 + 2.*tdot1.*theta1.*theta4.*theta5.*theta6, tdot3.*theta2.^2.*theta5.*theta6 + tdot5.*theta2.^2.*theta3.*theta6 + tdot6.*theta2.^2.*theta3.*theta5 + 2.*tdot2.*theta2.*theta3.*theta5.*theta6, tdot2.*theta4.*theta5.*theta6.^2 + tdot4.*theta2.*theta5.*theta6.^2 + tdot5.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.*theta4.*theta5.*theta6, tdot2.*theta4.*theta5.^2.*theta6 + tdot4.*theta2.*theta5.^2.*theta6 + tdot6.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.*theta4.*theta5.*theta6, tdot2.*theta4.^2.*theta5.*theta6 + tdot5.*theta2.*theta4.^2.*theta6 + tdot6.*theta2.*theta4.^2.*theta5 + 2.*tdot4.*theta2.*theta4.*theta5.*theta6, tdot4.*theta2.^2.*theta5.*theta6 + tdot5.*theta2.^2.*theta4.*theta6 + tdot6.*theta2.^2.*theta4.*theta5 + 2.*tdot2.*theta2.*theta4.*theta5.*theta6, tdot3.*theta4.*theta5.*theta6.^2 + tdot4.*theta3.*theta5.*theta6.^2 + tdot5.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.*theta4.*theta5.*theta6, tdot3.*theta4.*theta5.^2.*theta6 + tdot4.*theta3.*theta5.^2.*theta6 + tdot6.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.*theta4.*theta5.*theta6, tdot3.*theta4.^2.*theta5.*theta6 + tdot5.*theta3.*theta4.^2.*theta6 + tdot6.*theta3.*theta4.^2.*theta5 + 2.*tdot4.*theta3.*theta4.*theta5.*theta6, tdot4.*theta3.^2.*theta5.*theta6 + tdot5.*theta3.^2.*theta4.*theta6 + tdot6.*theta3.^2.*theta4.*theta5 + 2.*tdot3.*theta3.*theta4.*theta5.*theta6, tdot1.*theta2.*theta3.*theta4.*theta5 + tdot2.*theta1.*theta3.*theta4.*theta5 + tdot3.*theta1.*theta2.*theta4.*theta5 + tdot4.*theta1.*theta2.*theta3.*theta5 + tdot5.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta4.*theta6 + tdot2.*theta1.*theta3.*theta4.*theta6 + tdot3.*theta1.*theta2.*theta4.*theta6 + tdot4.*theta1.*theta2.*theta3.*theta6 + tdot6.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta5.*theta6 + tdot2.*theta1.*theta3.*theta5.*theta6 + tdot3.*theta1.*theta2.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta3.*theta6 + tdot6.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta4.*theta5.*theta6 + tdot2.*theta1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta2.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta4.*theta6 + tdot6.*theta1.*theta2.*theta4.*theta5, tdot1.*theta3.*theta4.*theta5.*theta6 + tdot3.*theta1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta3.*theta5.*theta6 + tdot5.*theta1.*theta3.*theta4.*theta6 + tdot6.*theta1.*theta3.*theta4.*theta5, tdot2.*theta3.*theta4.*theta5.*theta6 + tdot3.*theta2.*theta4.*theta5.*theta6 + tdot4.*theta2.*theta3.*theta5.*theta6 + tdot5.*theta2.*theta3.*theta4.*theta6 + tdot6.*theta2.*theta3.*theta4.*theta5, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -2.*theta1.*theta5.^2, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.^3, -2.*theta1.*theta6.^2, -3.*theta1.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6.^3, -3.*theta1.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta5, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, -3.*theta1.^2.*theta5, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6, zeroCol, -4.*theta1.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta2.*theta5.^2, -theta3.*theta4.^2, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta2.*theta5, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta2.*theta5.^3, -theta2.*theta6.^2, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^2.*theta6, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -2.*theta1.*theta3.*theta5, -3.*theta1.^2.*theta2.*theta5, -3.*theta1.^2.*theta3.*theta4, zeroCol, -theta2.*theta6.^3, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -2.*theta1.*theta4.*theta5, -3.*theta1.^2.*theta2.*theta6, -3.*theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.^2.*theta3.*theta6, -3.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6, -3.*theta1.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta2.^2.*theta5.^2, -theta3.^2.*theta4.^2, -2.*theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta2.^2.*theta5, -2.*theta1.*theta3.^2.*theta4, -theta2.^2.*theta6.^2, -theta3.^2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta6.^2, -2.*theta1.*theta3.*theta5.^2, -2.*theta1.*theta2.^2.*theta6, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, -2.*theta1.*theta3.*theta6.^2, -2.*theta1.*theta4.*theta5.^2, -2.*theta1.*theta3.^2.*theta6, -2.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6.^2, -2.*theta1.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta2.*theta5, -theta3.*theta4, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta5, -theta2.*theta3.*theta6, -theta2.*theta4.*theta5, -theta2.*theta4.*theta6, -theta3.*theta4.*theta5, -theta2.*theta5.*theta6, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta2.*theta3.*theta6.^2, -theta2.*theta4.*theta5.^2, -theta2.*theta3.^2.*theta6, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta3.*theta6, -theta2.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta6, -theta3.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta4.*theta6, -2.*theta1.*theta3.*theta4.*theta5, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta2.^2.*theta5.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.*theta6, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.^3, -2.*theta2.*theta5.^2, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.^3, -2.*theta2.*theta6.^2, -3.*theta2.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6.^3, -3.*theta2.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, -3.*theta2.^2.*theta5, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6, zeroCol, -4.*theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta5, -3.*theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -3.*theta1.*theta2.^2.*theta5, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -2.*theta2.*theta3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -2.*theta2.*theta3.*theta5, -3.*theta2.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, -2.*theta2.*theta4.*theta5, -3.*theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.^2.*theta3.*theta6, -3.*theta2.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta2.^2.*theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, -2.*theta1.*theta2.*theta5.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -2.*theta1.*theta2.*theta6.^2, zeroCol, -theta3.^2.*theta4.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, -theta3.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.^2.*theta5, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6.^2, -2.*theta2.*theta4.*theta5.^2, -2.*theta2.*theta3.^2.*theta6, -2.*theta2.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.^2.*theta6, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6.^2, -2.*theta2.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3, -theta1.*theta4, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta3.*theta4, zeroCol, zeroCol, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta3.*theta5, -theta1.*theta3.*theta6, -theta1.*theta4.*theta5, -theta1.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5, zeroCol, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, -theta4.*theta5.*theta6, zeroCol, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta1.^2.*theta3.*theta5, -theta1.*theta3.*theta6.^2, -theta1.*theta4.*theta5.^2, -theta1.*theta3.^2.*theta6, -theta1.*theta4.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta1.^2.*theta3.*theta6, -theta1.^2.*theta4.*theta5, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, zeroCol, -theta1.^2.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, -theta1.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta5.*theta6, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta2.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta5.*theta6, -theta1.*theta4.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.*theta6, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^3, -2.*theta3.*theta5.^2, -3.*theta3.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta5.^3, -2.*theta3.*theta6.^2, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.*theta6.^3, -3.*theta3.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, -theta2, zeroCol, zeroCol, zeroCol, zeroCol, -theta4, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta3.^3, zeroCol, zeroCol, -theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, -3.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -3.*theta3.^2.*theta5, zeroCol, -4.*theta3.^3.*theta4, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta6, zeroCol, -4.*theta3.^3.*theta5, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, -4.*theta3.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta2.^2.*theta4, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -3.*theta1.*theta3.^2.*theta5, zeroCol, -theta2.*theta4.^3, -theta2.*theta5.^2, -2.*theta2.*theta3.*theta5, -3.*theta2.*theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, -3.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta6, -3.*theta2.*theta3.^2.*theta5, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2.*theta6, zeroCol, zeroCol, -theta4.*theta5.^2, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta6, zeroCol, -2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6, -3.*theta3.^2.*theta4.*theta5, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, -2.*theta3.*theta5.*theta6, -3.*theta3.^2.*theta4.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta3.*theta5, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta5.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta5.^2, -2.*theta2.^2.*theta3.*theta5, zeroCol, -2.*theta2.*theta3.*theta6.^2, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta6.^2, zeroCol, -2.*theta2.^2.*theta3.*theta6, zeroCol, zeroCol, zeroCol, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta5.^2, -2.*theta3.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.^2.*theta6, -theta5.^2.*theta6.^2, -2.*theta3.*theta5.*theta6.^2, -2.*theta3.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta4, zeroCol, -theta1.*theta5, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta4.*theta5, zeroCol, -theta4.*theta6, -theta5.*theta6, zeroCol, -theta1.*theta2.*theta4, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta4.*theta5, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta4.*theta5, -theta1.*theta5.*theta6, -theta2.*theta4.*theta6, zeroCol, -theta2.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.^2.*theta5, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -theta1.^2.*theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, -2.*theta1.*theta3.*theta4.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta4.*theta5, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta3.*theta5.*theta6, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -2.*theta2.*theta3.*theta4.*theta6, -theta1.^2.*theta5.*theta6, -theta2.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta3.*theta5.*theta6, zeroCol, -theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta1.*theta2.*theta4.*theta5, -theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta5.*theta6, zeroCol, -theta1.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta4.^2, zeroCol, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta4.^2, zeroCol, -2.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5.^2, zeroCol, zeroCol, -2.*theta4.*theta5.^3, -2.*theta4.*theta6.^2, -3.*theta4.^2.*theta5.^2, -2.*theta4.*theta6.^3, -3.*theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, zeroCol, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, zeroCol, zeroCol, -3.*theta2.*theta4.^2, zeroCol, -2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta4.^3, zeroCol, zeroCol, -3.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, zeroCol, zeroCol, zeroCol, -4.*theta3.*theta4.^3, zeroCol, zeroCol, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5, -theta3.^4, zeroCol, zeroCol, zeroCol, -theta5.^3, -theta6.^2, zeroCol, zeroCol, -2.*theta4.*theta6, zeroCol, -3.*theta4.^2.*theta5, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, -3.*theta4.^2.*theta6, zeroCol, -4.*theta4.^3.*theta5, -theta6.^4, zeroCol, -4.*theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, zeroCol, -4.*theta4.^3, zeroCol, zeroCol, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, -3.*theta1.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5, -3.*theta2.*theta3.*theta4.^2, zeroCol, zeroCol, -theta2.*theta3.^3, zeroCol, -theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta3, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta4.*theta5, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -theta2.^2.*theta5, zeroCol, -theta1.*theta6.^3, zeroCol, -3.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.*theta4.^2.*theta5, -theta3.*theta5.^2, -2.*theta3.*theta4.*theta5, zeroCol, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, -theta3.^2.*theta5, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, -3.*theta2.*theta4.^2.*theta6, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -2.*theta3.*theta4.*theta6, -3.*theta3.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, zeroCol, -3.*theta3.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.^3.*theta6, zeroCol, zeroCol, -theta5.*theta6.^2, -theta5.^2.*theta6, zeroCol, -2.*theta4.*theta5.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, -3.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, zeroCol, -2.*theta1.*theta3.^2.*theta4, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta5.^2, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta4.*theta6, zeroCol, -theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta4.*theta6, -theta3.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta5, zeroCol, -2.*theta3.*theta4.*theta6.^2, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, -2.*theta4.*theta5.*theta6.^2, -2.*theta4.*theta5.^2.*theta6, zeroCol, -theta1.*theta2, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta2.*theta3, zeroCol, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, zeroCol, -theta5.*theta6, -theta1.*theta2.*theta3, zeroCol, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, -theta1.*theta3.*theta5, zeroCol, -theta1.*theta3.*theta6, -theta2.*theta3.*theta5, zeroCol, -theta2.*theta3.*theta6, -theta1.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6, -theta3.*theta5.*theta6, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.^2.*theta5, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta2.^2.*theta6, -theta1.*theta3.^2.*theta5, -theta1.^2.*theta2.*theta6, -theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta1.*theta3.^2.*theta6, -theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.^2.*theta5, zeroCol, -theta1.^2.*theta3.*theta6, -theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.^2.*theta6, zeroCol, -theta2.^2.*theta3.*theta6, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta4.*theta5.*theta6, -theta2.^2.*theta5.*theta6, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta3.^2.*theta5.*theta6, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta5.*theta6, -theta1.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.*theta6, zeroCol,];
        R5= [ zeroCol, zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^3.*theta5, zeroCol, -2.*theta2.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^3.*theta5, zeroCol, -2.*theta3.^2.*theta5, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.^3.*theta5, -2.*theta4.^2.*theta5, zeroCol, zeroCol, -3.*theta4.^2.*theta5.^2, zeroCol, -2.*theta4.^3.*theta5, zeroCol, zeroCol, -2.*theta5.*theta6.^2, -2.*theta5.*theta6.^3, -3.*theta5.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta5.^3, zeroCol, zeroCol, -3.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta5.^3, zeroCol, zeroCol, -3.*theta3.*theta5.^2, zeroCol, -2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta5.^3, zeroCol, -3.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, zeroCol, -4.*theta4.*theta5.^3, zeroCol, -theta6.^2, zeroCol, zeroCol, -2.*theta5.*theta6, -theta4.^4, zeroCol, -theta6.^3, zeroCol, -3.*theta5.^2.*theta6, -theta6.^4, -4.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta5, zeroCol, zeroCol, -3.*theta5.^2, zeroCol, zeroCol, -4.*theta5.^3, zeroCol, -5.*theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, -3.*theta1.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta5.^2, zeroCol, -2.*theta1.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, -2.*theta2.*theta3.*theta5, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -3.*theta2.*theta3.*theta5.^2, zeroCol, -2.*theta2.*theta4.*theta5, zeroCol, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta5.*theta6, zeroCol, -3.*theta2.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta2.*theta4.^3, -2.*theta3.*theta4.*theta5, -theta3.*theta4.^2, -theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta4, -theta3.^2.*theta4, -theta1.*theta6.^3, -3.*theta1.*theta5.^2.*theta6, zeroCol, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta3.*theta4.^3, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, zeroCol, -theta3.^3.*theta4, -theta2.*theta6.^3, -3.*theta2.*theta5.^2.*theta6, zeroCol, -theta3.*theta6.^2, zeroCol, -2.*theta3.*theta5.*theta6, -theta2.^3.*theta6, -theta3.^2.*theta6, zeroCol, -theta3.*theta6.^3, -3.*theta3.*theta5.^2.*theta6, -theta4.*theta6.^2, -2.*theta4.*theta5.*theta6, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.*theta6.^3, -3.*theta4.*theta5.^2.*theta6, -theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta5, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta5, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.^2.*theta5, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta5, -theta2.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -theta2.^2.*theta4.^2, -2.*theta1.*theta5.*theta6.^2, zeroCol, -2.*theta3.*theta4.^2.*theta5, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.^2.*theta4.*theta5, -theta3.^2.*theta4.^2, -2.*theta2.*theta5.*theta6.^2, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.*theta5.*theta6.^2, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta5.*theta6, -2.*theta4.*theta5.*theta6.^2, -theta4.^2.*theta6.^2, -2.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, zeroCol, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta3.*theta4, -theta2.*theta6, zeroCol, -theta3.*theta6, -theta4.*theta6, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta2.*theta6, zeroCol, -theta2.*theta3.*theta4, -theta1.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta3.*theta6, -theta2.*theta4.*theta6, -theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta4.^2, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.^2, zeroCol, -theta1.*theta3.^2.*theta4, zeroCol, -theta1.^2.*theta3.*theta4, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta2.*theta6, zeroCol, -theta2.^2.*theta3.*theta4, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.^2.*theta6, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.^2.*theta6, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta3.*theta6, -theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.^2.*theta6, -theta2.^2.*theta4.*theta6, -theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, -theta1.*theta2.*theta3.*theta4, zeroCol, -theta1.*theta2.*theta3.*theta6, -theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.*theta6, zeroCol,];
        R6= [ zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6.^2, -2.*theta1.^3.*theta6, zeroCol, -2.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6.^2, -2.*theta2.^3.*theta6, zeroCol, -2.*theta3.^2.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta6.^2, -2.*theta3.^3.*theta6, zeroCol, -2.*theta4.^2.*theta6, zeroCol, -3.*theta4.^2.*theta6.^2, -2.*theta4.^3.*theta6, -2.*theta5.^2.*theta6, -3.*theta5.^2.*theta6.^2, -2.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, -theta3, zeroCol, -theta4, -theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta6.^3, zeroCol, -3.*theta2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta6.^3, zeroCol, -3.*theta3.*theta6.^2, zeroCol, -2.*theta4.*theta6, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta6.^3, zeroCol, -3.*theta4.*theta6.^2, -2.*theta5.*theta6, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, -4.*theta4.*theta6.^3, -3.*theta5.*theta6.^2, -theta4.^4, -theta5.^3, -4.*theta5.*theta6.^3, -theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta6, zeroCol, zeroCol, -3.*theta6.^2, zeroCol, -4.*theta6.^3, -5.*theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta3.*theta6, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, zeroCol, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, -theta1.^3.*theta3, zeroCol, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta5.*theta6, -theta1.*theta4.^3, -theta1.*theta5.^2, -3.*theta2.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, zeroCol, -3.*theta1.*theta5.*theta6.^2, -theta1.*theta5.^3, -3.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta5.*theta6, -theta2.*theta4.^3, -theta2.*theta5.^2, zeroCol, -2.*theta3.*theta4.*theta6, -theta3.*theta4.^2, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, zeroCol, -3.*theta2.*theta5.*theta6.^2, -theta2.*theta5.^3, -3.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta5.*theta6, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, -3.*theta3.*theta5.*theta6.^2, -theta3.*theta5.^3, -2.*theta4.*theta5.*theta6, -theta4.*theta5.^2, -theta3.^3.*theta5, -theta4.^2.*theta5, -3.*theta4.*theta5.*theta6.^2, -theta4.*theta5.^3, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta6, -2.*theta2.*theta3.^2.*theta6, zeroCol, -2.*theta1.^2.*theta4.*theta6, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta5.^2.*theta6, -2.*theta2.*theta4.^2.*theta6, zeroCol, -2.*theta1.^2.*theta5.*theta6, -theta1.^2.*theta5.^2, -2.*theta2.^2.*theta4.*theta6, -theta2.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta5.^2.*theta6, -2.*theta3.*theta4.^2.*theta6, -2.*theta2.^2.*theta5.*theta6, -theta2.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta6, -theta3.^2.*theta4.^2, -2.*theta3.*theta5.^2.*theta6, -2.*theta3.^2.*theta5.*theta6, -theta3.^2.*theta5.^2, -2.*theta4.*theta5.^2.*theta6, -2.*theta4.^2.*theta5.*theta6, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, -theta1.*theta5, -theta2.*theta4, zeroCol, -theta2.*theta5, -theta3.*theta4, -theta3.*theta5, -theta4.*theta5, zeroCol, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta3.*theta4, zeroCol, -theta1.*theta3.*theta5, -theta2.*theta3.*theta4, -theta1.*theta4.*theta5, -theta2.*theta3.*theta5, -theta2.*theta4.*theta5, -theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta3.^2, zeroCol, -theta1.*theta2.^2.*theta3, zeroCol, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta4.^2, zeroCol, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta4.^2, -theta1.*theta2.^2.*theta5, -theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta3.*theta5, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta1.^2.*theta4.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta5, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta4.*theta5, -theta1.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta5, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;R5;R6;];
    case 33
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
            theta5=DOF(:, 5);
            tdot5=DOFVel(:, 5);
            theta6=DOF(:, 6);
            tdot6=DOFVel(:, 6);
        LMT = [ theta1, theta2, theta3, theta4, theta5, theta6, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^2.*theta5.^2, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta1.^2.*theta5.^3, theta1.^2.*theta6.^2, theta1.^3.*theta5.^2, theta2.^2.*theta4.^3, theta2.^2.*theta5.^2, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta1.^2.*theta6.^3, theta1.^3.*theta6.^2, theta2.^2.*theta5.^3, theta2.^2.*theta6.^2, theta2.^3.*theta5.^2, theta3.^2.*theta4.^3, theta3.^2.*theta5.^2, theta3.^3.*theta4.^2, theta2.^2.*theta6.^3, theta2.^3.*theta6.^2, theta3.^2.*theta5.^3, theta3.^2.*theta6.^2, theta3.^3.*theta5.^2, theta4.^2.*theta5.^2, theta3.^2.*theta6.^3, theta3.^3.*theta6.^2, theta4.^2.*theta5.^3, theta4.^2.*theta6.^2, theta4.^3.*theta5.^2, theta4.^2.*theta6.^3, theta4.^3.*theta6.^2, theta5.^2.*theta6.^2, theta5.^2.*theta6.^3, theta5.^3.*theta6.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta1.*theta5, theta2.*theta4, theta1.*theta6, theta2.*theta5, theta3.*theta4, theta2.*theta6, theta3.*theta5, theta3.*theta6, theta4.*theta5, theta4.*theta6, theta5.*theta6, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta1.*theta5.^2, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^2.*theta5, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta1.*theta5.^3, theta1.*theta6.^2, theta2.*theta3.^4, theta2.*theta4.^3, theta2.*theta5.^2, theta3.*theta4.^2, theta1.^2.*theta6, theta1.^3.*theta5, theta2.^2.*theta5, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta1.*theta5.^4, theta1.*theta6.^3, theta2.*theta4.^4, theta2.*theta5.^3, theta2.*theta6.^2, theta3.*theta4.^3, theta3.*theta5.^2, theta1.^3.*theta6, theta2.^2.*theta6, theta1.^4.*theta5, theta2.^3.*theta5, theta3.^2.*theta5, theta2.^4.*theta4, theta3.^3.*theta4, theta1.*theta6.^4, theta2.*theta5.^4, theta2.*theta6.^3, theta3.*theta4.^4, theta3.*theta5.^3, theta3.*theta6.^2, theta4.*theta5.^2, theta1.^4.*theta6, theta2.^3.*theta6, theta3.^2.*theta6, theta2.^4.*theta5, theta3.^3.*theta5, theta4.^2.*theta5, theta3.^4.*theta4, theta2.*theta6.^4, theta3.*theta5.^4, theta3.*theta6.^3, theta4.*theta5.^3, theta4.*theta6.^2, theta2.^4.*theta6, theta3.^3.*theta6, theta4.^2.*theta6, theta3.^4.*theta5, theta4.^3.*theta5, theta3.*theta6.^4, theta4.*theta5.^4, theta4.*theta6.^3, theta5.*theta6.^2, theta3.^4.*theta6, theta4.^3.*theta6, theta5.^2.*theta6, theta4.^4.*theta5, theta4.*theta6.^4, theta5.*theta6.^3, theta4.^4.*theta6, theta5.^3.*theta6, theta5.*theta6.^4, theta5.^4.*theta6, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta5.^2, theta3.^5, theta4.^4, theta5.^3, theta6.^2, theta4.^5, theta5.^4, theta6.^3, theta5.^5, theta6.^4, theta6.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta2.*theta5.^2, theta1.*theta3.*theta4.^2, theta1.*theta2.^2.*theta5, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta2.*theta5, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta2.*theta5.^3, theta1.*theta2.*theta6.^2, theta1.*theta3.*theta4.^3, theta1.*theta3.*theta5.^2, theta1.*theta2.^2.*theta6, theta1.*theta2.^3.*theta5, theta1.*theta3.^2.*theta5, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^2.*theta2.*theta6, theta1.^2.*theta3.*theta5, theta1.^3.*theta2.*theta5, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta1.*theta2.*theta6.^3, theta1.*theta3.*theta5.^3, theta1.*theta3.*theta6.^2, theta1.*theta4.*theta5.^2, theta1.*theta2.^3.*theta6, theta1.*theta3.^2.*theta6, theta1.*theta3.^3.*theta5, theta1.*theta4.^2.*theta5, theta2.*theta3.*theta4.^3, theta2.*theta3.*theta5.^2, theta2.*theta3.^2.*theta5, theta2.*theta3.^3.*theta4, theta1.^2.*theta3.*theta6, theta1.^2.*theta4.*theta5, theta1.^3.*theta2.*theta6, theta1.^3.*theta3.*theta5, theta2.^2.*theta3.*theta5, theta2.^3.*theta3.*theta4, theta1.*theta3.*theta6.^3, theta1.*theta4.*theta5.^3, theta1.*theta4.*theta6.^2, theta1.*theta3.^3.*theta6, theta1.*theta4.^2.*theta6, theta1.*theta4.^3.*theta5, theta2.*theta3.*theta5.^3, theta2.*theta3.*theta6.^2, theta2.*theta4.*theta5.^2, theta2.*theta3.^2.*theta6, theta2.*theta3.^3.*theta5, theta2.*theta4.^2.*theta5, theta1.^2.*theta4.*theta6, theta1.^3.*theta3.*theta6, theta1.^3.*theta4.*theta5, theta2.^2.*theta3.*theta6, theta2.^2.*theta4.*theta5, theta2.^3.*theta3.*theta5, theta1.*theta4.*theta6.^3, theta1.*theta5.*theta6.^2, theta1.*theta4.^3.*theta6, theta1.*theta5.^2.*theta6, theta2.*theta3.*theta6.^3, theta2.*theta4.*theta5.^3, theta2.*theta4.*theta6.^2, theta2.*theta3.^3.*theta6, theta2.*theta4.^2.*theta6, theta2.*theta4.^3.*theta5, theta3.*theta4.*theta5.^2, theta3.*theta4.^2.*theta5, theta1.^2.*theta5.*theta6, theta1.^3.*theta4.*theta6, theta2.^2.*theta4.*theta6, theta2.^3.*theta3.*theta6, theta2.^3.*theta4.*theta5, theta3.^2.*theta4.*theta5, theta1.*theta5.*theta6.^3, theta1.*theta5.^3.*theta6, theta2.*theta4.*theta6.^3, theta2.*theta5.*theta6.^2, theta2.*theta4.^3.*theta6, theta2.*theta5.^2.*theta6, theta3.*theta4.*theta5.^3, theta3.*theta4.*theta6.^2, theta3.*theta4.^2.*theta6, theta3.*theta4.^3.*theta5, theta1.^3.*theta5.*theta6, theta2.^2.*theta5.*theta6, theta2.^3.*theta4.*theta6, theta3.^2.*theta4.*theta6, theta3.^3.*theta4.*theta5, theta2.*theta5.*theta6.^3, theta2.*theta5.^3.*theta6, theta3.*theta4.*theta6.^3, theta3.*theta5.*theta6.^2, theta3.*theta4.^3.*theta6, theta3.*theta5.^2.*theta6, theta2.^3.*theta5.*theta6, theta3.^2.*theta5.*theta6, theta3.^3.*theta4.*theta6, theta3.*theta5.*theta6.^3, theta3.*theta5.^3.*theta6, theta4.*theta5.*theta6.^2, theta4.*theta5.^2.*theta6, theta3.^3.*theta5.*theta6, theta4.^2.*theta5.*theta6, theta4.*theta5.*theta6.^3, theta4.*theta5.^3.*theta6, theta4.^3.*theta5.*theta6, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta2.^2.*theta5.^2, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta5.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta2.^2.*theta5, theta1.^2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta6.^2, theta1.*theta3.^2.*theta5.^2, theta2.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta6.^2, theta1.^2.*theta3.*theta5.^2, theta1.^2.*theta2.^2.*theta6, theta1.^2.*theta3.^2.*theta5, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta3.^2.*theta6.^2, theta1.*theta4.^2.*theta5.^2, theta2.*theta3.^2.*theta5.^2, theta1.^2.*theta3.*theta6.^2, theta1.^2.*theta4.*theta5.^2, theta1.^2.*theta3.^2.*theta6, theta1.^2.*theta4.^2.*theta5, theta2.^2.*theta3.*theta5.^2, theta2.^2.*theta3.^2.*theta5, theta1.*theta4.^2.*theta6.^2, theta2.*theta3.^2.*theta6.^2, theta2.*theta4.^2.*theta5.^2, theta1.^2.*theta4.*theta6.^2, theta1.^2.*theta4.^2.*theta6, theta2.^2.*theta3.*theta6.^2, theta2.^2.*theta4.*theta5.^2, theta2.^2.*theta3.^2.*theta6, theta2.^2.*theta4.^2.*theta5, theta1.*theta5.^2.*theta6.^2, theta2.*theta4.^2.*theta6.^2, theta3.*theta4.^2.*theta5.^2, theta1.^2.*theta5.*theta6.^2, theta1.^2.*theta5.^2.*theta6, theta2.^2.*theta4.*theta6.^2, theta2.^2.*theta4.^2.*theta6, theta3.^2.*theta4.*theta5.^2, theta3.^2.*theta4.^2.*theta5, theta2.*theta5.^2.*theta6.^2, theta3.*theta4.^2.*theta6.^2, theta2.^2.*theta5.*theta6.^2, theta2.^2.*theta5.^2.*theta6, theta3.^2.*theta4.*theta6.^2, theta3.^2.*theta4.^2.*theta6, theta3.*theta5.^2.*theta6.^2, theta3.^2.*theta5.*theta6.^2, theta3.^2.*theta5.^2.*theta6, theta4.*theta5.^2.*theta6.^2, theta4.^2.*theta5.*theta6.^2, theta4.^2.*theta5.^2.*theta6, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta2.*theta5, theta1.*theta3.*theta4, theta1.*theta2.*theta6, theta1.*theta3.*theta5, theta2.*theta3.*theta4, theta1.*theta3.*theta6, theta1.*theta4.*theta5, theta2.*theta3.*theta5, theta1.*theta4.*theta6, theta2.*theta3.*theta6, theta2.*theta4.*theta5, theta1.*theta5.*theta6, theta2.*theta4.*theta6, theta3.*theta4.*theta5, theta2.*theta5.*theta6, theta3.*theta4.*theta6, theta3.*theta5.*theta6, theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6, theta1.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6, theta1.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6, theta1.*theta3.*theta4.*theta6, theta2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6, theta2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6, theta2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5.^2, theta1.*theta2.*theta3.^2.*theta5, theta1.*theta2.^2.*theta3.*theta5, theta1.^2.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6.^2, theta1.*theta2.*theta4.*theta5.^2, theta1.*theta2.*theta3.^2.*theta6, theta1.*theta2.*theta4.^2.*theta5, theta1.*theta2.^2.*theta3.*theta6, theta1.*theta2.^2.*theta4.*theta5, theta1.^2.*theta2.*theta3.*theta6, theta1.^2.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6.^2, theta1.*theta2.*theta4.^2.*theta6, theta1.*theta3.*theta4.*theta5.^2, theta1.*theta3.*theta4.^2.*theta5, theta1.*theta2.^2.*theta4.*theta6, theta1.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta4.*theta6, theta1.^2.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6.^2, theta1.*theta2.*theta5.^2.*theta6, theta1.*theta3.*theta4.*theta6.^2, theta1.*theta3.*theta4.^2.*theta6, theta1.*theta2.^2.*theta5.*theta6, theta1.*theta3.^2.*theta4.*theta6, theta2.*theta3.*theta4.*theta5.^2, theta2.*theta3.*theta4.^2.*theta5, theta2.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta5.*theta6, theta1.^2.*theta3.*theta4.*theta6, theta2.^2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6.^2, theta1.*theta3.*theta5.^2.*theta6, theta1.*theta3.^2.*theta5.*theta6, theta2.*theta3.*theta4.*theta6.^2, theta2.*theta3.*theta4.^2.*theta6, theta2.*theta3.^2.*theta4.*theta6, theta1.^2.*theta3.*theta5.*theta6, theta2.^2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6.^2, theta1.*theta4.*theta5.^2.*theta6, theta1.*theta4.^2.*theta5.*theta6, theta2.*theta3.*theta5.*theta6.^2, theta2.*theta3.*theta5.^2.*theta6, theta2.*theta3.^2.*theta5.*theta6, theta1.^2.*theta4.*theta5.*theta6, theta2.^2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6.^2, theta2.*theta4.*theta5.^2.*theta6, theta2.*theta4.^2.*theta5.*theta6, theta2.^2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6.^2, theta3.*theta4.*theta5.^2.*theta6, theta3.*theta4.^2.*theta5.*theta6, theta3.^2.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.*theta5, theta1.*theta2.*theta3.*theta4.*theta6, theta1.*theta2.*theta3.*theta5.*theta6, theta1.*theta2.*theta4.*theta5.*theta6, theta1.*theta3.*theta4.*theta5.*theta6, theta2.*theta3.*theta4.*theta5.*theta6, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, tdot5, tdot6, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot1.*theta1.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta5, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot1.*theta1.*theta5.^3 + 3.*tdot5.*theta1.^2.*theta5.^2, 2.*tdot1.*theta1.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta6, 2.*tdot5.*theta1.^3.*theta5 + 3.*tdot1.*theta1.^2.*theta5.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot2.*theta2.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta5, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot1.*theta1.*theta6.^3 + 3.*tdot6.*theta1.^2.*theta6.^2, 2.*tdot6.*theta1.^3.*theta6 + 3.*tdot1.*theta1.^2.*theta6.^2, 2.*tdot2.*theta2.*theta5.^3 + 3.*tdot5.*theta2.^2.*theta5.^2, 2.*tdot2.*theta2.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta6, 2.*tdot5.*theta2.^3.*theta5 + 3.*tdot2.*theta2.^2.*theta5.^2, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot3.*theta3.*theta5.^2 + 2.*tdot5.*theta3.^2.*theta5, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, 2.*tdot2.*theta2.*theta6.^3 + 3.*tdot6.*theta2.^2.*theta6.^2, 2.*tdot6.*theta2.^3.*theta6 + 3.*tdot2.*theta2.^2.*theta6.^2, 2.*tdot3.*theta3.*theta5.^3 + 3.*tdot5.*theta3.^2.*theta5.^2, 2.*tdot3.*theta3.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta6, 2.*tdot5.*theta3.^3.*theta5 + 3.*tdot3.*theta3.^2.*theta5.^2, 2.*tdot4.*theta4.*theta5.^2 + 2.*tdot5.*theta4.^2.*theta5, 2.*tdot3.*theta3.*theta6.^3 + 3.*tdot6.*theta3.^2.*theta6.^2, 2.*tdot6.*theta3.^3.*theta6 + 3.*tdot3.*theta3.^2.*theta6.^2, 2.*tdot4.*theta4.*theta5.^3 + 3.*tdot5.*theta4.^2.*theta5.^2, 2.*tdot4.*theta4.*theta6.^2 + 2.*tdot6.*theta4.^2.*theta6, 2.*tdot5.*theta4.^3.*theta5 + 3.*tdot4.*theta4.^2.*theta5.^2, 2.*tdot4.*theta4.*theta6.^3 + 3.*tdot6.*theta4.^2.*theta6.^2, 2.*tdot6.*theta4.^3.*theta6 + 3.*tdot4.*theta4.^2.*theta6.^2, 2.*tdot5.*theta5.*theta6.^2 + 2.*tdot6.*theta5.^2.*theta6, 2.*tdot5.*theta5.*theta6.^3 + 3.*tdot6.*theta5.^2.*theta6.^2, 2.*tdot6.*theta5.^3.*theta6 + 3.*tdot5.*theta5.^2.*theta6.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta5 + tdot5.*theta1, tdot2.*theta4 + tdot4.*theta2, tdot1.*theta6 + tdot6.*theta1, tdot2.*theta5 + tdot5.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot2.*theta6 + tdot6.*theta2, tdot3.*theta5 + tdot5.*theta3, tdot3.*theta6 + tdot6.*theta3, tdot4.*theta5 + tdot5.*theta4, tdot4.*theta6 + tdot6.*theta4, tdot5.*theta6 + tdot6.*theta5, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot1.*theta5.^2 + 2.*tdot5.*theta1.*theta5, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot5.*theta1.^2 + 2.*tdot1.*theta1.*theta5, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot1.*theta5.^3 + 3.*tdot5.*theta1.*theta5.^2, tdot1.*theta6.^2 + 2.*tdot6.*theta1.*theta6, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot2.*theta5.^2 + 2.*tdot5.*theta2.*theta5, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot6.*theta1.^2 + 2.*tdot1.*theta1.*theta6, tdot5.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta5, tdot5.*theta2.^2 + 2.*tdot2.*theta2.*theta5, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot1.*theta5.^4 + 4.*tdot5.*theta1.*theta5.^3, tdot1.*theta6.^3 + 3.*tdot6.*theta1.*theta6.^2, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot2.*theta5.^3 + 3.*tdot5.*theta2.*theta5.^2, tdot2.*theta6.^2 + 2.*tdot6.*theta2.*theta6, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot3.*theta5.^2 + 2.*tdot5.*theta3.*theta5, tdot6.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta6, tdot6.*theta2.^2 + 2.*tdot2.*theta2.*theta6, tdot5.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta5, tdot5.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta5, tdot5.*theta3.^2 + 2.*tdot3.*theta3.*theta5, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot1.*theta6.^4 + 4.*tdot6.*theta1.*theta6.^3, tdot2.*theta5.^4 + 4.*tdot5.*theta2.*theta5.^3, tdot2.*theta6.^3 + 3.*tdot6.*theta2.*theta6.^2, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot3.*theta5.^3 + 3.*tdot5.*theta3.*theta5.^2, tdot3.*theta6.^2 + 2.*tdot6.*theta3.*theta6, tdot4.*theta5.^2 + 2.*tdot5.*theta4.*theta5, tdot6.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta6, tdot6.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta6, tdot6.*theta3.^2 + 2.*tdot3.*theta3.*theta6, tdot5.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta5, tdot5.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta5, tdot5.*theta4.^2 + 2.*tdot4.*theta4.*theta5, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, tdot2.*theta6.^4 + 4.*tdot6.*theta2.*theta6.^3, tdot3.*theta5.^4 + 4.*tdot5.*theta3.*theta5.^3, tdot3.*theta6.^3 + 3.*tdot6.*theta3.*theta6.^2, tdot4.*theta5.^3 + 3.*tdot5.*theta4.*theta5.^2, tdot4.*theta6.^2 + 2.*tdot6.*theta4.*theta6, tdot6.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta6, tdot6.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta6, tdot6.*theta4.^2 + 2.*tdot4.*theta4.*theta6, tdot5.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta5, tdot5.*theta4.^3 + 3.*tdot4.*theta4.^2.*theta5, tdot3.*theta6.^4 + 4.*tdot6.*theta3.*theta6.^3, tdot4.*theta5.^4 + 4.*tdot5.*theta4.*theta5.^3, tdot4.*theta6.^3 + 3.*tdot6.*theta4.*theta6.^2, tdot5.*theta6.^2 + 2.*tdot6.*theta5.*theta6, tdot6.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta6, tdot6.*theta4.^3 + 3.*tdot4.*theta4.^2.*theta6, tdot6.*theta5.^2 + 2.*tdot5.*theta5.*theta6, tdot5.*theta4.^4 + 4.*tdot4.*theta4.^3.*theta5, tdot4.*theta6.^4 + 4.*tdot6.*theta4.*theta6.^3, tdot5.*theta6.^3 + 3.*tdot6.*theta5.*theta6.^2, tdot6.*theta4.^4 + 4.*tdot4.*theta4.^3.*theta6, tdot6.*theta5.^3 + 3.*tdot5.*theta5.^2.*theta6, tdot5.*theta6.^4 + 4.*tdot6.*theta5.*theta6.^3, tdot6.*theta5.^4 + 4.*tdot5.*theta5.^3.*theta6, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 2.*tdot5.*theta5, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 3.*tdot5.*theta5.^2, 2.*tdot6.*theta6, 5.*tdot4.*theta4.^4, 4.*tdot5.*theta5.^3, 3.*tdot6.*theta6.^2, 5.*tdot5.*theta5.^4, 4.*tdot6.*theta6.^3, 5.*tdot6.*theta6.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta2.*theta5.^2 + tdot2.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta5, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta5, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot2.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta5, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta2.*theta5.^3 + tdot2.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta2.*theta5.^2, tdot1.*theta2.*theta6.^2 + tdot2.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta6, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.*theta5.^2 + tdot3.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta5, tdot1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta6, tdot1.*theta2.^3.*theta5 + tdot5.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta5, tdot1.*theta3.^2.*theta5 + tdot5.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta5, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta6, tdot3.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta5, tdot2.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta5, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot1.*theta2.*theta6.^3 + tdot2.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta2.*theta6.^2, tdot1.*theta3.*theta5.^3 + tdot3.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta3.*theta5.^2, tdot1.*theta3.*theta6.^2 + tdot3.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta6, tdot1.*theta4.*theta5.^2 + tdot4.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta4.*theta5, tdot1.*theta2.^3.*theta6 + tdot6.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta6, tdot1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta6, tdot1.*theta3.^3.*theta5 + tdot5.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta5, tdot1.*theta4.^2.*theta5 + tdot5.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta4.*theta5, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.*theta5.^2 + tdot3.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta5, tdot2.*theta3.^2.*theta5 + tdot5.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta5, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta6, tdot4.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta4 + 2.*tdot1.*theta1.*theta4.*theta5, tdot2.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta6, tdot3.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta5, tdot3.*theta2.^2.*theta5 + tdot5.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta5, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta3.*theta6.^3 + tdot3.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta3.*theta6.^2, tdot1.*theta4.*theta5.^3 + tdot4.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta4.*theta5.^2, tdot1.*theta4.*theta6.^2 + tdot4.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta4.*theta6, tdot1.*theta3.^3.*theta6 + tdot6.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta6, tdot1.*theta4.^2.*theta6 + tdot6.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta4.*theta6, tdot1.*theta4.^3.*theta5 + tdot5.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2.*theta5, tdot2.*theta3.*theta5.^3 + tdot3.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta3.*theta5.^2, tdot2.*theta3.*theta6.^2 + tdot3.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta6, tdot2.*theta4.*theta5.^2 + tdot4.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta4.*theta5, tdot2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta6, tdot2.*theta3.^3.*theta5 + tdot5.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta5, tdot2.*theta4.^2.*theta5 + tdot5.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta4.*theta5, tdot4.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta4 + 2.*tdot1.*theta1.*theta4.*theta6, tdot3.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta6, tdot4.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.*theta5, tdot3.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta6, tdot4.*theta2.^2.*theta5 + tdot5.*theta2.^2.*theta4 + 2.*tdot2.*theta2.*theta4.*theta5, tdot3.*theta2.^3.*theta5 + tdot5.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta5, tdot1.*theta4.*theta6.^3 + tdot4.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta4.*theta6.^2, tdot1.*theta5.*theta6.^2 + tdot5.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta5.*theta6, tdot1.*theta4.^3.*theta6 + tdot6.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2.*theta6, tdot1.*theta5.^2.*theta6 + tdot6.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta5.*theta6, tdot2.*theta3.*theta6.^3 + tdot3.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta3.*theta6.^2, tdot2.*theta4.*theta5.^3 + tdot4.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta4.*theta5.^2, tdot2.*theta4.*theta6.^2 + tdot4.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta4.*theta6, tdot2.*theta3.^3.*theta6 + tdot6.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta6, tdot2.*theta4.^2.*theta6 + tdot6.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta4.*theta6, tdot2.*theta4.^3.*theta5 + tdot5.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2.*theta5, tdot3.*theta4.*theta5.^2 + tdot4.*theta3.*theta5.^2 + 2.*tdot5.*theta3.*theta4.*theta5, tdot3.*theta4.^2.*theta5 + tdot5.*theta3.*theta4.^2 + 2.*tdot4.*theta3.*theta4.*theta5, tdot5.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta5 + 2.*tdot1.*theta1.*theta5.*theta6, tdot4.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.*theta6, tdot4.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta4 + 2.*tdot2.*theta2.*theta4.*theta6, tdot3.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta6, tdot4.*theta2.^3.*theta5 + tdot5.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.*theta5, tdot4.*theta3.^2.*theta5 + tdot5.*theta3.^2.*theta4 + 2.*tdot3.*theta3.*theta4.*theta5, tdot1.*theta5.*theta6.^3 + tdot5.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta5.*theta6.^2, tdot1.*theta5.^3.*theta6 + tdot6.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta5.^2.*theta6, tdot2.*theta4.*theta6.^3 + tdot4.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta4.*theta6.^2, tdot2.*theta5.*theta6.^2 + tdot5.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta5.*theta6, tdot2.*theta4.^3.*theta6 + tdot6.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2.*theta6, tdot2.*theta5.^2.*theta6 + tdot6.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta5.*theta6, tdot3.*theta4.*theta5.^3 + tdot4.*theta3.*theta5.^3 + 3.*tdot5.*theta3.*theta4.*theta5.^2, tdot3.*theta4.*theta6.^2 + tdot4.*theta3.*theta6.^2 + 2.*tdot6.*theta3.*theta4.*theta6, tdot3.*theta4.^2.*theta6 + tdot6.*theta3.*theta4.^2 + 2.*tdot4.*theta3.*theta4.*theta6, tdot3.*theta4.^3.*theta5 + tdot5.*theta3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2.*theta5, tdot5.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta5 + 3.*tdot1.*theta1.^2.*theta5.*theta6, tdot5.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta5 + 2.*tdot2.*theta2.*theta5.*theta6, tdot4.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.*theta6, tdot4.*theta3.^2.*theta6 + tdot6.*theta3.^2.*theta4 + 2.*tdot3.*theta3.*theta4.*theta6, tdot4.*theta3.^3.*theta5 + tdot5.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.*theta5, tdot2.*theta5.*theta6.^3 + tdot5.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta5.*theta6.^2, tdot2.*theta5.^3.*theta6 + tdot6.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta5.^2.*theta6, tdot3.*theta4.*theta6.^3 + tdot4.*theta3.*theta6.^3 + 3.*tdot6.*theta3.*theta4.*theta6.^2, tdot3.*theta5.*theta6.^2 + tdot5.*theta3.*theta6.^2 + 2.*tdot6.*theta3.*theta5.*theta6, tdot3.*theta4.^3.*theta6 + tdot6.*theta3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2.*theta6, tdot3.*theta5.^2.*theta6 + tdot6.*theta3.*theta5.^2 + 2.*tdot5.*theta3.*theta5.*theta6, tdot5.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta5 + 3.*tdot2.*theta2.^2.*theta5.*theta6, tdot5.*theta3.^2.*theta6 + tdot6.*theta3.^2.*theta5 + 2.*tdot3.*theta3.*theta5.*theta6, tdot4.*theta3.^3.*theta6 + tdot6.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.*theta6, tdot3.*theta5.*theta6.^3 + tdot5.*theta3.*theta6.^3 + 3.*tdot6.*theta3.*theta5.*theta6.^2, tdot3.*theta5.^3.*theta6 + tdot6.*theta3.*theta5.^3 + 3.*tdot5.*theta3.*theta5.^2.*theta6, tdot4.*theta5.*theta6.^2 + tdot5.*theta4.*theta6.^2 + 2.*tdot6.*theta4.*theta5.*theta6, tdot4.*theta5.^2.*theta6 + tdot6.*theta4.*theta5.^2 + 2.*tdot5.*theta4.*theta5.*theta6, tdot5.*theta3.^3.*theta6 + tdot6.*theta3.^3.*theta5 + 3.*tdot3.*theta3.^2.*theta5.*theta6, tdot5.*theta4.^2.*theta6 + tdot6.*theta4.^2.*theta5 + 2.*tdot4.*theta4.*theta5.*theta6, tdot4.*theta5.*theta6.^3 + tdot5.*theta4.*theta6.^3 + 3.*tdot6.*theta4.*theta5.*theta6.^2, tdot4.*theta5.^3.*theta6 + tdot6.*theta4.*theta5.^3 + 3.*tdot5.*theta4.*theta5.^2.*theta6, tdot5.*theta4.^3.*theta6 + tdot6.*theta4.^3.*theta5 + 3.*tdot4.*theta4.^2.*theta5.*theta6, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.^2.*theta5, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot2.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta2.*theta5, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot5.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta5 + 2.*tdot2.*theta1.^2.*theta2.*theta5, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.^2.*theta6, tdot1.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.^2.*theta5, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot2.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta2.*theta6, tdot3.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta3.*theta5, tdot6.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta6 + 2.*tdot2.*theta1.^2.*theta2.*theta6, tdot5.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta5 + 2.*tdot3.*theta1.^2.*theta3.*theta5, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.^2.*theta6, tdot1.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.*theta4.^2.*theta5, tdot2.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.^2.*theta5, tdot3.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta3.*theta6, tdot4.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta4.*theta5, tdot6.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta6 + 2.*tdot3.*theta1.^2.*theta3.*theta6, tdot5.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta4.^2.*theta5 + 2.*tdot4.*theta1.^2.*theta4.*theta5, tdot3.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta3.*theta5, tdot5.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta5 + 2.*tdot3.*theta2.^2.*theta3.*theta5, tdot1.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.*theta4.^2.*theta6, tdot2.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.^2.*theta6, tdot2.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.*theta4.^2.*theta5, tdot4.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta4.*theta6, tdot6.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta4.^2.*theta6 + 2.*tdot4.*theta1.^2.*theta4.*theta6, tdot3.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta3.*theta6, tdot4.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta4.*theta5, tdot6.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta6 + 2.*tdot3.*theta2.^2.*theta3.*theta6, tdot5.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta4.^2.*theta5 + 2.*tdot4.*theta2.^2.*theta4.*theta5, tdot1.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta1.*theta5.*theta6.^2 + 2.*tdot6.*theta1.*theta5.^2.*theta6, tdot2.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.*theta4.^2.*theta6, tdot3.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.*theta4.^2.*theta5, tdot5.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta5.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta5.*theta6, tdot6.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta5.^2.*theta6 + 2.*tdot5.*theta1.^2.*theta5.*theta6, tdot4.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta4.*theta6, tdot6.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta4.^2.*theta6 + 2.*tdot4.*theta2.^2.*theta4.*theta6, tdot4.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.^2.*theta4.*theta5, tdot5.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta3.*theta4.^2.*theta5 + 2.*tdot4.*theta3.^2.*theta4.*theta5, tdot2.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta2.*theta5.*theta6.^2 + 2.*tdot6.*theta2.*theta5.^2.*theta6, tdot3.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.*theta4.^2.*theta6, tdot5.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta5.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta5.*theta6, tdot6.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta5.^2.*theta6 + 2.*tdot5.*theta2.^2.*theta5.*theta6, tdot4.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta4.*theta6, tdot6.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta3.*theta4.^2.*theta6 + 2.*tdot4.*theta3.^2.*theta4.*theta6, tdot3.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta3.*theta5.*theta6.^2 + 2.*tdot6.*theta3.*theta5.^2.*theta6, tdot5.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta3.*theta5.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta5.*theta6, tdot6.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta3.*theta5.^2.*theta6 + 2.*tdot5.*theta3.^2.*theta5.*theta6, tdot4.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta4.*theta5.*theta6.^2 + 2.*tdot6.*theta4.*theta5.^2.*theta6, tdot5.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta4.*theta5.*theta6.^2 + 2.*tdot6.*theta4.^2.*theta5.*theta6, tdot6.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta4.*theta5.^2.*theta6 + 2.*tdot5.*theta4.^2.*theta5.*theta6, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta2.*theta5 + tdot2.*theta1.*theta5 + tdot5.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot1.*theta2.*theta6 + tdot2.*theta1.*theta6 + tdot6.*theta1.*theta2, tdot1.*theta3.*theta5 + tdot3.*theta1.*theta5 + tdot5.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta3.*theta6 + tdot3.*theta1.*theta6 + tdot6.*theta1.*theta3, tdot1.*theta4.*theta5 + tdot4.*theta1.*theta5 + tdot5.*theta1.*theta4, tdot2.*theta3.*theta5 + tdot3.*theta2.*theta5 + tdot5.*theta2.*theta3, tdot1.*theta4.*theta6 + tdot4.*theta1.*theta6 + tdot6.*theta1.*theta4, tdot2.*theta3.*theta6 + tdot3.*theta2.*theta6 + tdot6.*theta2.*theta3, tdot2.*theta4.*theta5 + tdot4.*theta2.*theta5 + tdot5.*theta2.*theta4, tdot1.*theta5.*theta6 + tdot5.*theta1.*theta6 + tdot6.*theta1.*theta5, tdot2.*theta4.*theta6 + tdot4.*theta2.*theta6 + tdot6.*theta2.*theta4, tdot3.*theta4.*theta5 + tdot4.*theta3.*theta5 + tdot5.*theta3.*theta4, tdot2.*theta5.*theta6 + tdot5.*theta2.*theta6 + tdot6.*theta2.*theta5, tdot3.*theta4.*theta6 + tdot4.*theta3.*theta6 + tdot6.*theta3.*theta4, tdot3.*theta5.*theta6 + tdot5.*theta3.*theta6 + tdot6.*theta3.*theta5, tdot4.*theta5.*theta6 + tdot5.*theta4.*theta6 + tdot6.*theta4.*theta5, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta5 + tdot2.*theta1.*theta3.*theta5 + tdot3.*theta1.*theta2.*theta5 + tdot5.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta6 + tdot2.*theta1.*theta3.*theta6 + tdot3.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta3, tdot1.*theta2.*theta4.*theta5 + tdot2.*theta1.*theta4.*theta5 + tdot4.*theta1.*theta2.*theta5 + tdot5.*theta1.*theta2.*theta4, tdot1.*theta2.*theta4.*theta6 + tdot2.*theta1.*theta4.*theta6 + tdot4.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta4, tdot1.*theta3.*theta4.*theta5 + tdot3.*theta1.*theta4.*theta5 + tdot4.*theta1.*theta3.*theta5 + tdot5.*theta1.*theta3.*theta4, tdot1.*theta2.*theta5.*theta6 + tdot2.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta5, tdot1.*theta3.*theta4.*theta6 + tdot3.*theta1.*theta4.*theta6 + tdot4.*theta1.*theta3.*theta6 + tdot6.*theta1.*theta3.*theta4, tdot2.*theta3.*theta4.*theta5 + tdot3.*theta2.*theta4.*theta5 + tdot4.*theta2.*theta3.*theta5 + tdot5.*theta2.*theta3.*theta4, tdot1.*theta3.*theta5.*theta6 + tdot3.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta3.*theta6 + tdot6.*theta1.*theta3.*theta5, tdot2.*theta3.*theta4.*theta6 + tdot3.*theta2.*theta4.*theta6 + tdot4.*theta2.*theta3.*theta6 + tdot6.*theta2.*theta3.*theta4, tdot1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta4.*theta6 + tdot6.*theta1.*theta4.*theta5, tdot2.*theta3.*theta5.*theta6 + tdot3.*theta2.*theta5.*theta6 + tdot5.*theta2.*theta3.*theta6 + tdot6.*theta2.*theta3.*theta5, tdot2.*theta4.*theta5.*theta6 + tdot4.*theta2.*theta5.*theta6 + tdot5.*theta2.*theta4.*theta6 + tdot6.*theta2.*theta4.*theta5, tdot3.*theta4.*theta5.*theta6 + tdot4.*theta3.*theta5.*theta6 + tdot5.*theta3.*theta4.*theta6 + tdot6.*theta3.*theta4.*theta5, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta5.^2 + tdot2.*theta1.*theta3.*theta5.^2 + tdot3.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta3.^2.*theta5 + tdot2.*theta1.*theta3.^2.*theta5 + tdot5.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.^2.*theta3.*theta5 + tdot3.*theta1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta5, tdot2.*theta1.^2.*theta3.*theta5 + tdot3.*theta1.^2.*theta2.*theta5 + tdot5.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta3.*theta6.^2 + tdot2.*theta1.*theta3.*theta6.^2 + tdot3.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.*theta4.*theta5.^2 + tdot2.*theta1.*theta4.*theta5.^2 + tdot4.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.*theta3.^2.*theta6 + tdot2.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.*theta4.^2.*theta5 + tdot2.*theta1.*theta4.^2.*theta5 + tdot5.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.^2.*theta3.*theta6 + tdot3.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.^2.*theta4.*theta5 + tdot4.*theta1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.*theta2.*theta4.*theta5, tdot2.*theta1.^2.*theta3.*theta6 + tdot3.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta6, tdot2.*theta1.^2.*theta4.*theta5 + tdot4.*theta1.^2.*theta2.*theta5 + tdot5.*theta1.^2.*theta2.*theta4 + 2.*tdot1.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.*theta4.*theta6.^2 + tdot2.*theta1.*theta4.*theta6.^2 + tdot4.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta4.*theta6, tdot1.*theta2.*theta4.^2.*theta6 + tdot2.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4.*theta6, tdot1.*theta3.*theta4.*theta5.^2 + tdot3.*theta1.*theta4.*theta5.^2 + tdot4.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta4.*theta5, tdot1.*theta3.*theta4.^2.*theta5 + tdot3.*theta1.*theta4.^2.*theta5 + tdot5.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4.*theta5, tdot1.*theta2.^2.*theta4.*theta6 + tdot4.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.*theta2.*theta4.*theta6, tdot1.*theta3.^2.*theta4.*theta5 + tdot4.*theta1.*theta3.^2.*theta5 + tdot5.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.*theta3.*theta4.*theta5, tdot2.*theta1.^2.*theta4.*theta6 + tdot4.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta4 + 2.*tdot1.*theta1.*theta2.*theta4.*theta6, tdot3.*theta1.^2.*theta4.*theta5 + tdot4.*theta1.^2.*theta3.*theta5 + tdot5.*theta1.^2.*theta3.*theta4 + 2.*tdot1.*theta1.*theta3.*theta4.*theta5, tdot1.*theta2.*theta5.*theta6.^2 + tdot2.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta5.*theta6, tdot1.*theta2.*theta5.^2.*theta6 + tdot2.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta5.*theta6, tdot1.*theta3.*theta4.*theta6.^2 + tdot3.*theta1.*theta4.*theta6.^2 + tdot4.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta4.*theta6, tdot1.*theta3.*theta4.^2.*theta6 + tdot3.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4.*theta6, tdot1.*theta2.^2.*theta5.*theta6 + tdot5.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta5 + 2.*tdot2.*theta1.*theta2.*theta5.*theta6, tdot1.*theta3.^2.*theta4.*theta6 + tdot4.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.*theta3.*theta4.*theta6, tdot2.*theta3.*theta4.*theta5.^2 + tdot3.*theta2.*theta4.*theta5.^2 + tdot4.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta4.*theta5, tdot2.*theta3.*theta4.^2.*theta5 + tdot3.*theta2.*theta4.^2.*theta5 + tdot5.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4.*theta5, tdot2.*theta3.^2.*theta4.*theta5 + tdot4.*theta2.*theta3.^2.*theta5 + tdot5.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.*theta3.*theta4.*theta5, tdot2.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta5 + 2.*tdot1.*theta1.*theta2.*theta5.*theta6, tdot3.*theta1.^2.*theta4.*theta6 + tdot4.*theta1.^2.*theta3.*theta6 + tdot6.*theta1.^2.*theta3.*theta4 + 2.*tdot1.*theta1.*theta3.*theta4.*theta6, tdot3.*theta2.^2.*theta4.*theta5 + tdot4.*theta2.^2.*theta3.*theta5 + tdot5.*theta2.^2.*theta3.*theta4 + 2.*tdot2.*theta2.*theta3.*theta4.*theta5, tdot1.*theta3.*theta5.*theta6.^2 + tdot3.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta5.*theta6, tdot1.*theta3.*theta5.^2.*theta6 + tdot3.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta5.*theta6, tdot1.*theta3.^2.*theta5.*theta6 + tdot5.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2.*theta5 + 2.*tdot3.*theta1.*theta3.*theta5.*theta6, tdot2.*theta3.*theta4.*theta6.^2 + tdot3.*theta2.*theta4.*theta6.^2 + tdot4.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta4.*theta6, tdot2.*theta3.*theta4.^2.*theta6 + tdot3.*theta2.*theta4.^2.*theta6 + tdot6.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4.*theta6, tdot2.*theta3.^2.*theta4.*theta6 + tdot4.*theta2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.*theta3.*theta4.*theta6, tdot3.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta3.*theta6 + tdot6.*theta1.^2.*theta3.*theta5 + 2.*tdot1.*theta1.*theta3.*theta5.*theta6, tdot3.*theta2.^2.*theta4.*theta6 + tdot4.*theta2.^2.*theta3.*theta6 + tdot6.*theta2.^2.*theta3.*theta4 + 2.*tdot2.*theta2.*theta3.*theta4.*theta6, tdot1.*theta4.*theta5.*theta6.^2 + tdot4.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.*theta4.*theta5.*theta6, tdot1.*theta4.*theta5.^2.*theta6 + tdot4.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.*theta4.*theta5.*theta6, tdot1.*theta4.^2.*theta5.*theta6 + tdot5.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta4.^2.*theta5 + 2.*tdot4.*theta1.*theta4.*theta5.*theta6, tdot2.*theta3.*theta5.*theta6.^2 + tdot3.*theta2.*theta5.*theta6.^2 + tdot5.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta5.*theta6, tdot2.*theta3.*theta5.^2.*theta6 + tdot3.*theta2.*theta5.^2.*theta6 + tdot6.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta5.*theta6, tdot2.*theta3.^2.*theta5.*theta6 + tdot5.*theta2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2.*theta5 + 2.*tdot3.*theta2.*theta3.*theta5.*theta6, tdot4.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta4.*theta6 + tdot6.*theta1.^2.*theta4.*theta5 + 2.*tdot1.*theta1.*theta4.*theta5.*theta6, tdot3.*theta2.^2.*theta5.*theta6 + tdot5.*theta2.^2.*theta3.*theta6 + tdot6.*theta2.^2.*theta3.*theta5 + 2.*tdot2.*theta2.*theta3.*theta5.*theta6, tdot2.*theta4.*theta5.*theta6.^2 + tdot4.*theta2.*theta5.*theta6.^2 + tdot5.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.*theta4.*theta5.*theta6, tdot2.*theta4.*theta5.^2.*theta6 + tdot4.*theta2.*theta5.^2.*theta6 + tdot6.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.*theta4.*theta5.*theta6, tdot2.*theta4.^2.*theta5.*theta6 + tdot5.*theta2.*theta4.^2.*theta6 + tdot6.*theta2.*theta4.^2.*theta5 + 2.*tdot4.*theta2.*theta4.*theta5.*theta6, tdot4.*theta2.^2.*theta5.*theta6 + tdot5.*theta2.^2.*theta4.*theta6 + tdot6.*theta2.^2.*theta4.*theta5 + 2.*tdot2.*theta2.*theta4.*theta5.*theta6, tdot3.*theta4.*theta5.*theta6.^2 + tdot4.*theta3.*theta5.*theta6.^2 + tdot5.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.*theta4.*theta5.*theta6, tdot3.*theta4.*theta5.^2.*theta6 + tdot4.*theta3.*theta5.^2.*theta6 + tdot6.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.*theta4.*theta5.*theta6, tdot3.*theta4.^2.*theta5.*theta6 + tdot5.*theta3.*theta4.^2.*theta6 + tdot6.*theta3.*theta4.^2.*theta5 + 2.*tdot4.*theta3.*theta4.*theta5.*theta6, tdot4.*theta3.^2.*theta5.*theta6 + tdot5.*theta3.^2.*theta4.*theta6 + tdot6.*theta3.^2.*theta4.*theta5 + 2.*tdot3.*theta3.*theta4.*theta5.*theta6, tdot1.*theta2.*theta3.*theta4.*theta5 + tdot2.*theta1.*theta3.*theta4.*theta5 + tdot3.*theta1.*theta2.*theta4.*theta5 + tdot4.*theta1.*theta2.*theta3.*theta5 + tdot5.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta4.*theta6 + tdot2.*theta1.*theta3.*theta4.*theta6 + tdot3.*theta1.*theta2.*theta4.*theta6 + tdot4.*theta1.*theta2.*theta3.*theta6 + tdot6.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta5.*theta6 + tdot2.*theta1.*theta3.*theta5.*theta6 + tdot3.*theta1.*theta2.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta3.*theta6 + tdot6.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta4.*theta5.*theta6 + tdot2.*theta1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta2.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta4.*theta6 + tdot6.*theta1.*theta2.*theta4.*theta5, tdot1.*theta3.*theta4.*theta5.*theta6 + tdot3.*theta1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta3.*theta5.*theta6 + tdot5.*theta1.*theta3.*theta4.*theta6 + tdot6.*theta1.*theta3.*theta4.*theta5, tdot2.*theta3.*theta4.*theta5.*theta6 + tdot3.*theta2.*theta4.*theta5.*theta6 + tdot4.*theta2.*theta3.*theta5.*theta6 + tdot5.*theta2.*theta3.*theta4.*theta6 + tdot6.*theta2.*theta3.*theta4.*theta5, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -2.*theta1.*theta5.^2, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.^3, -2.*theta1.*theta6.^2, -3.*theta1.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6.^3, -3.*theta1.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta5, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, -3.*theta1.^2.*theta5, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6, zeroCol, -4.*theta1.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta2.*theta5.^2, -theta3.*theta4.^2, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta2.*theta5, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta2.*theta5.^3, -theta2.*theta6.^2, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^2.*theta6, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -2.*theta1.*theta3.*theta5, -3.*theta1.^2.*theta2.*theta5, -3.*theta1.^2.*theta3.*theta4, zeroCol, -theta2.*theta6.^3, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -2.*theta1.*theta4.*theta5, -3.*theta1.^2.*theta2.*theta6, -3.*theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.^2.*theta3.*theta6, -3.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6, -3.*theta1.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta2.^2.*theta5.^2, -theta3.^2.*theta4.^2, -2.*theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta2.^2.*theta5, -2.*theta1.*theta3.^2.*theta4, -theta2.^2.*theta6.^2, -theta3.^2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta6.^2, -2.*theta1.*theta3.*theta5.^2, -2.*theta1.*theta2.^2.*theta6, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, -2.*theta1.*theta3.*theta6.^2, -2.*theta1.*theta4.*theta5.^2, -2.*theta1.*theta3.^2.*theta6, -2.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6.^2, -2.*theta1.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta2.*theta5, -theta3.*theta4, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta5, -theta2.*theta3.*theta6, -theta2.*theta4.*theta5, -theta2.*theta4.*theta6, -theta3.*theta4.*theta5, -theta2.*theta5.*theta6, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta2.*theta3.*theta6.^2, -theta2.*theta4.*theta5.^2, -theta2.*theta3.^2.*theta6, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta3.*theta6, -theta2.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta6, -theta3.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta4.*theta6, -2.*theta1.*theta3.*theta4.*theta5, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta2.^2.*theta5.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.*theta6, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.^3, -2.*theta2.*theta5.^2, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.^3, -2.*theta2.*theta6.^2, -3.*theta2.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6.^3, -3.*theta2.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, -3.*theta2.^2.*theta5, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6, zeroCol, -4.*theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta5, -3.*theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -3.*theta1.*theta2.^2.*theta5, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -2.*theta2.*theta3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -2.*theta2.*theta3.*theta5, -3.*theta2.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, -2.*theta2.*theta4.*theta5, -3.*theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.^2.*theta3.*theta6, -3.*theta2.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta2.^2.*theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, -2.*theta1.*theta2.*theta5.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -2.*theta1.*theta2.*theta6.^2, zeroCol, -theta3.^2.*theta4.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, -theta3.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.^2.*theta5, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6.^2, -2.*theta2.*theta4.*theta5.^2, -2.*theta2.*theta3.^2.*theta6, -2.*theta2.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.^2.*theta6, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6.^2, -2.*theta2.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3, -theta1.*theta4, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta3.*theta4, zeroCol, zeroCol, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta3.*theta5, -theta1.*theta3.*theta6, -theta1.*theta4.*theta5, -theta1.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5, zeroCol, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, -theta4.*theta5.*theta6, zeroCol, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta1.^2.*theta3.*theta5, -theta1.*theta3.*theta6.^2, -theta1.*theta4.*theta5.^2, -theta1.*theta3.^2.*theta6, -theta1.*theta4.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta1.^2.*theta3.*theta6, -theta1.^2.*theta4.*theta5, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, zeroCol, -theta1.^2.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, -theta1.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta5.*theta6, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta2.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta5.*theta6, -theta1.*theta4.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.*theta6, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^3, -2.*theta3.*theta5.^2, -3.*theta3.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta5.^3, -2.*theta3.*theta6.^2, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.*theta6.^3, -3.*theta3.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, -theta2, zeroCol, zeroCol, zeroCol, zeroCol, -theta4, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta3.^3, zeroCol, zeroCol, -theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, -3.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -3.*theta3.^2.*theta5, zeroCol, -4.*theta3.^3.*theta4, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta6, zeroCol, -4.*theta3.^3.*theta5, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, -4.*theta3.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta2.^2.*theta4, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -3.*theta1.*theta3.^2.*theta5, zeroCol, -theta2.*theta4.^3, -theta2.*theta5.^2, -2.*theta2.*theta3.*theta5, -3.*theta2.*theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, -3.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta6, -3.*theta2.*theta3.^2.*theta5, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2.*theta6, zeroCol, zeroCol, -theta4.*theta5.^2, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta6, zeroCol, -2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6, -3.*theta3.^2.*theta4.*theta5, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, -2.*theta3.*theta5.*theta6, -3.*theta3.^2.*theta4.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta3.*theta5, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta5.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta5.^2, -2.*theta2.^2.*theta3.*theta5, zeroCol, -2.*theta2.*theta3.*theta6.^2, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta6.^2, zeroCol, -2.*theta2.^2.*theta3.*theta6, zeroCol, zeroCol, zeroCol, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta5.^2, -2.*theta3.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.^2.*theta6, -theta5.^2.*theta6.^2, -2.*theta3.*theta5.*theta6.^2, -2.*theta3.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta4, zeroCol, -theta1.*theta5, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta4.*theta5, zeroCol, -theta4.*theta6, -theta5.*theta6, zeroCol, -theta1.*theta2.*theta4, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta4.*theta5, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta4.*theta5, -theta1.*theta5.*theta6, -theta2.*theta4.*theta6, zeroCol, -theta2.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.^2.*theta5, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -theta1.^2.*theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, -2.*theta1.*theta3.*theta4.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta4.*theta5, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta3.*theta5.*theta6, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -2.*theta2.*theta3.*theta4.*theta6, -theta1.^2.*theta5.*theta6, -theta2.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta3.*theta5.*theta6, zeroCol, -theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta1.*theta2.*theta4.*theta5, -theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta5.*theta6, zeroCol, -theta1.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta4.^2, zeroCol, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta4.^2, zeroCol, -2.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5.^2, zeroCol, zeroCol, -2.*theta4.*theta5.^3, -2.*theta4.*theta6.^2, -3.*theta4.^2.*theta5.^2, -2.*theta4.*theta6.^3, -3.*theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, zeroCol, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, zeroCol, zeroCol, -3.*theta2.*theta4.^2, zeroCol, -2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta4.^3, zeroCol, zeroCol, -3.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, zeroCol, zeroCol, zeroCol, -4.*theta3.*theta4.^3, zeroCol, zeroCol, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5, -theta3.^4, zeroCol, zeroCol, zeroCol, -theta5.^3, -theta6.^2, zeroCol, zeroCol, -2.*theta4.*theta6, zeroCol, -3.*theta4.^2.*theta5, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, -3.*theta4.^2.*theta6, zeroCol, -4.*theta4.^3.*theta5, -theta6.^4, zeroCol, -4.*theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, zeroCol, -4.*theta4.^3, zeroCol, zeroCol, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, -3.*theta1.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5, -3.*theta2.*theta3.*theta4.^2, zeroCol, zeroCol, -theta2.*theta3.^3, zeroCol, -theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta3, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta4.*theta5, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -theta2.^2.*theta5, zeroCol, -theta1.*theta6.^3, zeroCol, -3.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.*theta4.^2.*theta5, -theta3.*theta5.^2, -2.*theta3.*theta4.*theta5, zeroCol, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, -theta3.^2.*theta5, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, -3.*theta2.*theta4.^2.*theta6, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -2.*theta3.*theta4.*theta6, -3.*theta3.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, zeroCol, -3.*theta3.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.^3.*theta6, zeroCol, zeroCol, -theta5.*theta6.^2, -theta5.^2.*theta6, zeroCol, -2.*theta4.*theta5.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, -3.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, zeroCol, -2.*theta1.*theta3.^2.*theta4, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta5.^2, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta4.*theta6, zeroCol, -theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta4.*theta6, -theta3.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta5, zeroCol, -2.*theta3.*theta4.*theta6.^2, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, -2.*theta4.*theta5.*theta6.^2, -2.*theta4.*theta5.^2.*theta6, zeroCol, -theta1.*theta2, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta2.*theta3, zeroCol, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, zeroCol, -theta5.*theta6, -theta1.*theta2.*theta3, zeroCol, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, -theta1.*theta3.*theta5, zeroCol, -theta1.*theta3.*theta6, -theta2.*theta3.*theta5, zeroCol, -theta2.*theta3.*theta6, -theta1.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6, -theta3.*theta5.*theta6, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.^2.*theta5, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta2.^2.*theta6, -theta1.*theta3.^2.*theta5, -theta1.^2.*theta2.*theta6, -theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta1.*theta3.^2.*theta6, -theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.^2.*theta5, zeroCol, -theta1.^2.*theta3.*theta6, -theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.^2.*theta6, zeroCol, -theta2.^2.*theta3.*theta6, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta4.*theta5.*theta6, -theta2.^2.*theta5.*theta6, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta3.^2.*theta5.*theta6, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta5.*theta6, -theta1.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.*theta6, zeroCol,];
        R5= [ zeroCol, zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^3.*theta5, zeroCol, -2.*theta2.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^3.*theta5, zeroCol, -2.*theta3.^2.*theta5, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.^3.*theta5, -2.*theta4.^2.*theta5, zeroCol, zeroCol, -3.*theta4.^2.*theta5.^2, zeroCol, -2.*theta4.^3.*theta5, zeroCol, zeroCol, -2.*theta5.*theta6.^2, -2.*theta5.*theta6.^3, -3.*theta5.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta5.^3, zeroCol, zeroCol, -3.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta5.^3, zeroCol, zeroCol, -3.*theta3.*theta5.^2, zeroCol, -2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta5.^3, zeroCol, -3.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, zeroCol, -4.*theta4.*theta5.^3, zeroCol, -theta6.^2, zeroCol, zeroCol, -2.*theta5.*theta6, -theta4.^4, zeroCol, -theta6.^3, zeroCol, -3.*theta5.^2.*theta6, -theta6.^4, -4.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta5, zeroCol, zeroCol, -3.*theta5.^2, zeroCol, zeroCol, -4.*theta5.^3, zeroCol, -5.*theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, -3.*theta1.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta5.^2, zeroCol, -2.*theta1.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, -2.*theta2.*theta3.*theta5, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -3.*theta2.*theta3.*theta5.^2, zeroCol, -2.*theta2.*theta4.*theta5, zeroCol, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta5.*theta6, zeroCol, -3.*theta2.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta2.*theta4.^3, -2.*theta3.*theta4.*theta5, -theta3.*theta4.^2, -theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta4, -theta3.^2.*theta4, -theta1.*theta6.^3, -3.*theta1.*theta5.^2.*theta6, zeroCol, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta3.*theta4.^3, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, zeroCol, -theta3.^3.*theta4, -theta2.*theta6.^3, -3.*theta2.*theta5.^2.*theta6, zeroCol, -theta3.*theta6.^2, zeroCol, -2.*theta3.*theta5.*theta6, -theta2.^3.*theta6, -theta3.^2.*theta6, zeroCol, -theta3.*theta6.^3, -3.*theta3.*theta5.^2.*theta6, -theta4.*theta6.^2, -2.*theta4.*theta5.*theta6, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.*theta6.^3, -3.*theta4.*theta5.^2.*theta6, -theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta5, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta5, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.^2.*theta5, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta5, -theta2.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -theta2.^2.*theta4.^2, -2.*theta1.*theta5.*theta6.^2, zeroCol, -2.*theta3.*theta4.^2.*theta5, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.^2.*theta4.*theta5, -theta3.^2.*theta4.^2, -2.*theta2.*theta5.*theta6.^2, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.*theta5.*theta6.^2, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta5.*theta6, -2.*theta4.*theta5.*theta6.^2, -theta4.^2.*theta6.^2, -2.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, zeroCol, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta3.*theta4, -theta2.*theta6, zeroCol, -theta3.*theta6, -theta4.*theta6, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta2.*theta6, zeroCol, -theta2.*theta3.*theta4, -theta1.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta3.*theta6, -theta2.*theta4.*theta6, -theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta4.^2, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.^2, zeroCol, -theta1.*theta3.^2.*theta4, zeroCol, -theta1.^2.*theta3.*theta4, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta2.*theta6, zeroCol, -theta2.^2.*theta3.*theta4, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.^2.*theta6, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.^2.*theta6, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta3.*theta6, -theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.^2.*theta6, -theta2.^2.*theta4.*theta6, -theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, -theta1.*theta2.*theta3.*theta4, zeroCol, -theta1.*theta2.*theta3.*theta6, -theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.*theta6, zeroCol,];
        R6= [ zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6.^2, -2.*theta1.^3.*theta6, zeroCol, -2.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6.^2, -2.*theta2.^3.*theta6, zeroCol, -2.*theta3.^2.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta6.^2, -2.*theta3.^3.*theta6, zeroCol, -2.*theta4.^2.*theta6, zeroCol, -3.*theta4.^2.*theta6.^2, -2.*theta4.^3.*theta6, -2.*theta5.^2.*theta6, -3.*theta5.^2.*theta6.^2, -2.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, -theta3, zeroCol, -theta4, -theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta6.^3, zeroCol, -3.*theta2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta6.^3, zeroCol, -3.*theta3.*theta6.^2, zeroCol, -2.*theta4.*theta6, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta6.^3, zeroCol, -3.*theta4.*theta6.^2, -2.*theta5.*theta6, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, -4.*theta4.*theta6.^3, -3.*theta5.*theta6.^2, -theta4.^4, -theta5.^3, -4.*theta5.*theta6.^3, -theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta6, zeroCol, zeroCol, -3.*theta6.^2, zeroCol, -4.*theta6.^3, -5.*theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta3.*theta6, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, zeroCol, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, -theta1.^3.*theta3, zeroCol, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta5.*theta6, -theta1.*theta4.^3, -theta1.*theta5.^2, -3.*theta2.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, zeroCol, -3.*theta1.*theta5.*theta6.^2, -theta1.*theta5.^3, -3.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta5.*theta6, -theta2.*theta4.^3, -theta2.*theta5.^2, zeroCol, -2.*theta3.*theta4.*theta6, -theta3.*theta4.^2, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, zeroCol, -3.*theta2.*theta5.*theta6.^2, -theta2.*theta5.^3, -3.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta5.*theta6, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, -3.*theta3.*theta5.*theta6.^2, -theta3.*theta5.^3, -2.*theta4.*theta5.*theta6, -theta4.*theta5.^2, -theta3.^3.*theta5, -theta4.^2.*theta5, -3.*theta4.*theta5.*theta6.^2, -theta4.*theta5.^3, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta6, -2.*theta2.*theta3.^2.*theta6, zeroCol, -2.*theta1.^2.*theta4.*theta6, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta5.^2.*theta6, -2.*theta2.*theta4.^2.*theta6, zeroCol, -2.*theta1.^2.*theta5.*theta6, -theta1.^2.*theta5.^2, -2.*theta2.^2.*theta4.*theta6, -theta2.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta5.^2.*theta6, -2.*theta3.*theta4.^2.*theta6, -2.*theta2.^2.*theta5.*theta6, -theta2.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta6, -theta3.^2.*theta4.^2, -2.*theta3.*theta5.^2.*theta6, -2.*theta3.^2.*theta5.*theta6, -theta3.^2.*theta5.^2, -2.*theta4.*theta5.^2.*theta6, -2.*theta4.^2.*theta5.*theta6, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, -theta1.*theta5, -theta2.*theta4, zeroCol, -theta2.*theta5, -theta3.*theta4, -theta3.*theta5, -theta4.*theta5, zeroCol, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta3.*theta4, zeroCol, -theta1.*theta3.*theta5, -theta2.*theta3.*theta4, -theta1.*theta4.*theta5, -theta2.*theta3.*theta5, -theta2.*theta4.*theta5, -theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta3.^2, zeroCol, -theta1.*theta2.^2.*theta3, zeroCol, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta4.^2, zeroCol, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta4.^2, -theta1.*theta2.^2.*theta5, -theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta3.*theta5, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta1.^2.*theta4.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta5, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta4.*theta5, -theta1.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta5, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;R5;R6;];
    case 34
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 35
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
        LMT = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot2.*theta4 + tdot4.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 5.*tdot4.*theta4.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;];
    case 36
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
        LMT = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot2.*theta4 + tdot4.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 5.*tdot4.*theta4.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;];
    case 37
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
        LMT = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot2.*theta4 + tdot4.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 5.*tdot4.*theta4.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;];
    case 38
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
        LMT = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot2.*theta4 + tdot4.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 5.*tdot4.*theta4.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;];
    case 39
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 40
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
        LMT = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot2.*theta4 + tdot4.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 5.*tdot4.*theta4.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;];
    case 41
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 42
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 43
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
        LMT = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        VMT = [ tdot1, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 4.*tdot1.*theta1.^3, 5.*tdot1.*theta1.^4, zeroCol,];
        R1= [ -onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        Mat = [LMT;VMT;R1;];
    case 44
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
        LMT = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        VMT = [ tdot1, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 4.*tdot1.*theta1.^3, 5.*tdot1.*theta1.^4, zeroCol,];
        R1= [ -onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        Mat = [LMT;VMT;R1;];
    case 45
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
        LMT = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        VMT = [ tdot1, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 4.*tdot1.*theta1.^3, 5.*tdot1.*theta1.^4, zeroCol,];
        R1= [ -onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        Mat = [LMT;VMT;R1;];
    case 46
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 47
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 48
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 49
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 50
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 51
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 52
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 53
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 54
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 55
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 56
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 57
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 58
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 59
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 60
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 61
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 62
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 63
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 64
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 65
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 66
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 67
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 68
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 69
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 70
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 71
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 72
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 73
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 74
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];

    case 75
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 76
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 77
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 78
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 79
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 80
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 81
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
        LMT = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot2.*theta4 + tdot4.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 5.*tdot4.*theta4.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;];
    case 82
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
        LMT = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        VMT = [ tdot1, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 4.*tdot1.*theta1.^3, 5.*tdot1.*theta1.^4, zeroCol,];
        R1= [ -onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        Mat = [LMT;VMT;R1;];
    case 83
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 84
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 85
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 86
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 87
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 88
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 89
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 90
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 91
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 92
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 93
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 94
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 95
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 96
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 97
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 98
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 99
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
        LMT = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot2.*theta4 + tdot4.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 5.*tdot4.*theta4.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;];
    case 100
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 101
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 102
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 103
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 104
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 105
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
            theta5=DOF(:, 5);
            tdot5=DOFVel(:, 5);
            theta6=DOF(:, 6);
            tdot6=DOFVel(:, 6);
        LMT = [ theta1, theta2, theta3, theta4, theta5, theta6, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^2.*theta5.^2, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta1.^2.*theta5.^3, theta1.^2.*theta6.^2, theta1.^3.*theta5.^2, theta2.^2.*theta4.^3, theta2.^2.*theta5.^2, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta1.^2.*theta6.^3, theta1.^3.*theta6.^2, theta2.^2.*theta5.^3, theta2.^2.*theta6.^2, theta2.^3.*theta5.^2, theta3.^2.*theta4.^3, theta3.^2.*theta5.^2, theta3.^3.*theta4.^2, theta2.^2.*theta6.^3, theta2.^3.*theta6.^2, theta3.^2.*theta5.^3, theta3.^2.*theta6.^2, theta3.^3.*theta5.^2, theta4.^2.*theta5.^2, theta3.^2.*theta6.^3, theta3.^3.*theta6.^2, theta4.^2.*theta5.^3, theta4.^2.*theta6.^2, theta4.^3.*theta5.^2, theta4.^2.*theta6.^3, theta4.^3.*theta6.^2, theta5.^2.*theta6.^2, theta5.^2.*theta6.^3, theta5.^3.*theta6.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta1.*theta5, theta2.*theta4, theta1.*theta6, theta2.*theta5, theta3.*theta4, theta2.*theta6, theta3.*theta5, theta3.*theta6, theta4.*theta5, theta4.*theta6, theta5.*theta6, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta1.*theta5.^2, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^2.*theta5, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta1.*theta5.^3, theta1.*theta6.^2, theta2.*theta3.^4, theta2.*theta4.^3, theta2.*theta5.^2, theta3.*theta4.^2, theta1.^2.*theta6, theta1.^3.*theta5, theta2.^2.*theta5, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta1.*theta5.^4, theta1.*theta6.^3, theta2.*theta4.^4, theta2.*theta5.^3, theta2.*theta6.^2, theta3.*theta4.^3, theta3.*theta5.^2, theta1.^3.*theta6, theta2.^2.*theta6, theta1.^4.*theta5, theta2.^3.*theta5, theta3.^2.*theta5, theta2.^4.*theta4, theta3.^3.*theta4, theta1.*theta6.^4, theta2.*theta5.^4, theta2.*theta6.^3, theta3.*theta4.^4, theta3.*theta5.^3, theta3.*theta6.^2, theta4.*theta5.^2, theta1.^4.*theta6, theta2.^3.*theta6, theta3.^2.*theta6, theta2.^4.*theta5, theta3.^3.*theta5, theta4.^2.*theta5, theta3.^4.*theta4, theta2.*theta6.^4, theta3.*theta5.^4, theta3.*theta6.^3, theta4.*theta5.^3, theta4.*theta6.^2, theta2.^4.*theta6, theta3.^3.*theta6, theta4.^2.*theta6, theta3.^4.*theta5, theta4.^3.*theta5, theta3.*theta6.^4, theta4.*theta5.^4, theta4.*theta6.^3, theta5.*theta6.^2, theta3.^4.*theta6, theta4.^3.*theta6, theta5.^2.*theta6, theta4.^4.*theta5, theta4.*theta6.^4, theta5.*theta6.^3, theta4.^4.*theta6, theta5.^3.*theta6, theta5.*theta6.^4, theta5.^4.*theta6, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta5.^2, theta3.^5, theta4.^4, theta5.^3, theta6.^2, theta4.^5, theta5.^4, theta6.^3, theta5.^5, theta6.^4, theta6.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta2.*theta5.^2, theta1.*theta3.*theta4.^2, theta1.*theta2.^2.*theta5, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta2.*theta5, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta2.*theta5.^3, theta1.*theta2.*theta6.^2, theta1.*theta3.*theta4.^3, theta1.*theta3.*theta5.^2, theta1.*theta2.^2.*theta6, theta1.*theta2.^3.*theta5, theta1.*theta3.^2.*theta5, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^2.*theta2.*theta6, theta1.^2.*theta3.*theta5, theta1.^3.*theta2.*theta5, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta1.*theta2.*theta6.^3, theta1.*theta3.*theta5.^3, theta1.*theta3.*theta6.^2, theta1.*theta4.*theta5.^2, theta1.*theta2.^3.*theta6, theta1.*theta3.^2.*theta6, theta1.*theta3.^3.*theta5, theta1.*theta4.^2.*theta5, theta2.*theta3.*theta4.^3, theta2.*theta3.*theta5.^2, theta2.*theta3.^2.*theta5, theta2.*theta3.^3.*theta4, theta1.^2.*theta3.*theta6, theta1.^2.*theta4.*theta5, theta1.^3.*theta2.*theta6, theta1.^3.*theta3.*theta5, theta2.^2.*theta3.*theta5, theta2.^3.*theta3.*theta4, theta1.*theta3.*theta6.^3, theta1.*theta4.*theta5.^3, theta1.*theta4.*theta6.^2, theta1.*theta3.^3.*theta6, theta1.*theta4.^2.*theta6, theta1.*theta4.^3.*theta5, theta2.*theta3.*theta5.^3, theta2.*theta3.*theta6.^2, theta2.*theta4.*theta5.^2, theta2.*theta3.^2.*theta6, theta2.*theta3.^3.*theta5, theta2.*theta4.^2.*theta5, theta1.^2.*theta4.*theta6, theta1.^3.*theta3.*theta6, theta1.^3.*theta4.*theta5, theta2.^2.*theta3.*theta6, theta2.^2.*theta4.*theta5, theta2.^3.*theta3.*theta5, theta1.*theta4.*theta6.^3, theta1.*theta5.*theta6.^2, theta1.*theta4.^3.*theta6, theta1.*theta5.^2.*theta6, theta2.*theta3.*theta6.^3, theta2.*theta4.*theta5.^3, theta2.*theta4.*theta6.^2, theta2.*theta3.^3.*theta6, theta2.*theta4.^2.*theta6, theta2.*theta4.^3.*theta5, theta3.*theta4.*theta5.^2, theta3.*theta4.^2.*theta5, theta1.^2.*theta5.*theta6, theta1.^3.*theta4.*theta6, theta2.^2.*theta4.*theta6, theta2.^3.*theta3.*theta6, theta2.^3.*theta4.*theta5, theta3.^2.*theta4.*theta5, theta1.*theta5.*theta6.^3, theta1.*theta5.^3.*theta6, theta2.*theta4.*theta6.^3, theta2.*theta5.*theta6.^2, theta2.*theta4.^3.*theta6, theta2.*theta5.^2.*theta6, theta3.*theta4.*theta5.^3, theta3.*theta4.*theta6.^2, theta3.*theta4.^2.*theta6, theta3.*theta4.^3.*theta5, theta1.^3.*theta5.*theta6, theta2.^2.*theta5.*theta6, theta2.^3.*theta4.*theta6, theta3.^2.*theta4.*theta6, theta3.^3.*theta4.*theta5, theta2.*theta5.*theta6.^3, theta2.*theta5.^3.*theta6, theta3.*theta4.*theta6.^3, theta3.*theta5.*theta6.^2, theta3.*theta4.^3.*theta6, theta3.*theta5.^2.*theta6, theta2.^3.*theta5.*theta6, theta3.^2.*theta5.*theta6, theta3.^3.*theta4.*theta6, theta3.*theta5.*theta6.^3, theta3.*theta5.^3.*theta6, theta4.*theta5.*theta6.^2, theta4.*theta5.^2.*theta6, theta3.^3.*theta5.*theta6, theta4.^2.*theta5.*theta6, theta4.*theta5.*theta6.^3, theta4.*theta5.^3.*theta6, theta4.^3.*theta5.*theta6, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta2.^2.*theta5.^2, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta5.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta2.^2.*theta5, theta1.^2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta6.^2, theta1.*theta3.^2.*theta5.^2, theta2.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta6.^2, theta1.^2.*theta3.*theta5.^2, theta1.^2.*theta2.^2.*theta6, theta1.^2.*theta3.^2.*theta5, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta3.^2.*theta6.^2, theta1.*theta4.^2.*theta5.^2, theta2.*theta3.^2.*theta5.^2, theta1.^2.*theta3.*theta6.^2, theta1.^2.*theta4.*theta5.^2, theta1.^2.*theta3.^2.*theta6, theta1.^2.*theta4.^2.*theta5, theta2.^2.*theta3.*theta5.^2, theta2.^2.*theta3.^2.*theta5, theta1.*theta4.^2.*theta6.^2, theta2.*theta3.^2.*theta6.^2, theta2.*theta4.^2.*theta5.^2, theta1.^2.*theta4.*theta6.^2, theta1.^2.*theta4.^2.*theta6, theta2.^2.*theta3.*theta6.^2, theta2.^2.*theta4.*theta5.^2, theta2.^2.*theta3.^2.*theta6, theta2.^2.*theta4.^2.*theta5, theta1.*theta5.^2.*theta6.^2, theta2.*theta4.^2.*theta6.^2, theta3.*theta4.^2.*theta5.^2, theta1.^2.*theta5.*theta6.^2, theta1.^2.*theta5.^2.*theta6, theta2.^2.*theta4.*theta6.^2, theta2.^2.*theta4.^2.*theta6, theta3.^2.*theta4.*theta5.^2, theta3.^2.*theta4.^2.*theta5, theta2.*theta5.^2.*theta6.^2, theta3.*theta4.^2.*theta6.^2, theta2.^2.*theta5.*theta6.^2, theta2.^2.*theta5.^2.*theta6, theta3.^2.*theta4.*theta6.^2, theta3.^2.*theta4.^2.*theta6, theta3.*theta5.^2.*theta6.^2, theta3.^2.*theta5.*theta6.^2, theta3.^2.*theta5.^2.*theta6, theta4.*theta5.^2.*theta6.^2, theta4.^2.*theta5.*theta6.^2, theta4.^2.*theta5.^2.*theta6, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta2.*theta5, theta1.*theta3.*theta4, theta1.*theta2.*theta6, theta1.*theta3.*theta5, theta2.*theta3.*theta4, theta1.*theta3.*theta6, theta1.*theta4.*theta5, theta2.*theta3.*theta5, theta1.*theta4.*theta6, theta2.*theta3.*theta6, theta2.*theta4.*theta5, theta1.*theta5.*theta6, theta2.*theta4.*theta6, theta3.*theta4.*theta5, theta2.*theta5.*theta6, theta3.*theta4.*theta6, theta3.*theta5.*theta6, theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6, theta1.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6, theta1.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6, theta1.*theta3.*theta4.*theta6, theta2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6, theta2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6, theta2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5.^2, theta1.*theta2.*theta3.^2.*theta5, theta1.*theta2.^2.*theta3.*theta5, theta1.^2.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6.^2, theta1.*theta2.*theta4.*theta5.^2, theta1.*theta2.*theta3.^2.*theta6, theta1.*theta2.*theta4.^2.*theta5, theta1.*theta2.^2.*theta3.*theta6, theta1.*theta2.^2.*theta4.*theta5, theta1.^2.*theta2.*theta3.*theta6, theta1.^2.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6.^2, theta1.*theta2.*theta4.^2.*theta6, theta1.*theta3.*theta4.*theta5.^2, theta1.*theta3.*theta4.^2.*theta5, theta1.*theta2.^2.*theta4.*theta6, theta1.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta4.*theta6, theta1.^2.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6.^2, theta1.*theta2.*theta5.^2.*theta6, theta1.*theta3.*theta4.*theta6.^2, theta1.*theta3.*theta4.^2.*theta6, theta1.*theta2.^2.*theta5.*theta6, theta1.*theta3.^2.*theta4.*theta6, theta2.*theta3.*theta4.*theta5.^2, theta2.*theta3.*theta4.^2.*theta5, theta2.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta5.*theta6, theta1.^2.*theta3.*theta4.*theta6, theta2.^2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6.^2, theta1.*theta3.*theta5.^2.*theta6, theta1.*theta3.^2.*theta5.*theta6, theta2.*theta3.*theta4.*theta6.^2, theta2.*theta3.*theta4.^2.*theta6, theta2.*theta3.^2.*theta4.*theta6, theta1.^2.*theta3.*theta5.*theta6, theta2.^2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6.^2, theta1.*theta4.*theta5.^2.*theta6, theta1.*theta4.^2.*theta5.*theta6, theta2.*theta3.*theta5.*theta6.^2, theta2.*theta3.*theta5.^2.*theta6, theta2.*theta3.^2.*theta5.*theta6, theta1.^2.*theta4.*theta5.*theta6, theta2.^2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6.^2, theta2.*theta4.*theta5.^2.*theta6, theta2.*theta4.^2.*theta5.*theta6, theta2.^2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6.^2, theta3.*theta4.*theta5.^2.*theta6, theta3.*theta4.^2.*theta5.*theta6, theta3.^2.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.*theta5, theta1.*theta2.*theta3.*theta4.*theta6, theta1.*theta2.*theta3.*theta5.*theta6, theta1.*theta2.*theta4.*theta5.*theta6, theta1.*theta3.*theta4.*theta5.*theta6, theta2.*theta3.*theta4.*theta5.*theta6, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, tdot5, tdot6, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot1.*theta1.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta5, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot1.*theta1.*theta5.^3 + 3.*tdot5.*theta1.^2.*theta5.^2, 2.*tdot1.*theta1.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta6, 2.*tdot5.*theta1.^3.*theta5 + 3.*tdot1.*theta1.^2.*theta5.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot2.*theta2.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta5, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot1.*theta1.*theta6.^3 + 3.*tdot6.*theta1.^2.*theta6.^2, 2.*tdot6.*theta1.^3.*theta6 + 3.*tdot1.*theta1.^2.*theta6.^2, 2.*tdot2.*theta2.*theta5.^3 + 3.*tdot5.*theta2.^2.*theta5.^2, 2.*tdot2.*theta2.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta6, 2.*tdot5.*theta2.^3.*theta5 + 3.*tdot2.*theta2.^2.*theta5.^2, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot3.*theta3.*theta5.^2 + 2.*tdot5.*theta3.^2.*theta5, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, 2.*tdot2.*theta2.*theta6.^3 + 3.*tdot6.*theta2.^2.*theta6.^2, 2.*tdot6.*theta2.^3.*theta6 + 3.*tdot2.*theta2.^2.*theta6.^2, 2.*tdot3.*theta3.*theta5.^3 + 3.*tdot5.*theta3.^2.*theta5.^2, 2.*tdot3.*theta3.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta6, 2.*tdot5.*theta3.^3.*theta5 + 3.*tdot3.*theta3.^2.*theta5.^2, 2.*tdot4.*theta4.*theta5.^2 + 2.*tdot5.*theta4.^2.*theta5, 2.*tdot3.*theta3.*theta6.^3 + 3.*tdot6.*theta3.^2.*theta6.^2, 2.*tdot6.*theta3.^3.*theta6 + 3.*tdot3.*theta3.^2.*theta6.^2, 2.*tdot4.*theta4.*theta5.^3 + 3.*tdot5.*theta4.^2.*theta5.^2, 2.*tdot4.*theta4.*theta6.^2 + 2.*tdot6.*theta4.^2.*theta6, 2.*tdot5.*theta4.^3.*theta5 + 3.*tdot4.*theta4.^2.*theta5.^2, 2.*tdot4.*theta4.*theta6.^3 + 3.*tdot6.*theta4.^2.*theta6.^2, 2.*tdot6.*theta4.^3.*theta6 + 3.*tdot4.*theta4.^2.*theta6.^2, 2.*tdot5.*theta5.*theta6.^2 + 2.*tdot6.*theta5.^2.*theta6, 2.*tdot5.*theta5.*theta6.^3 + 3.*tdot6.*theta5.^2.*theta6.^2, 2.*tdot6.*theta5.^3.*theta6 + 3.*tdot5.*theta5.^2.*theta6.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta5 + tdot5.*theta1, tdot2.*theta4 + tdot4.*theta2, tdot1.*theta6 + tdot6.*theta1, tdot2.*theta5 + tdot5.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot2.*theta6 + tdot6.*theta2, tdot3.*theta5 + tdot5.*theta3, tdot3.*theta6 + tdot6.*theta3, tdot4.*theta5 + tdot5.*theta4, tdot4.*theta6 + tdot6.*theta4, tdot5.*theta6 + tdot6.*theta5, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot1.*theta5.^2 + 2.*tdot5.*theta1.*theta5, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot5.*theta1.^2 + 2.*tdot1.*theta1.*theta5, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot1.*theta5.^3 + 3.*tdot5.*theta1.*theta5.^2, tdot1.*theta6.^2 + 2.*tdot6.*theta1.*theta6, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot2.*theta5.^2 + 2.*tdot5.*theta2.*theta5, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot6.*theta1.^2 + 2.*tdot1.*theta1.*theta6, tdot5.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta5, tdot5.*theta2.^2 + 2.*tdot2.*theta2.*theta5, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot1.*theta5.^4 + 4.*tdot5.*theta1.*theta5.^3, tdot1.*theta6.^3 + 3.*tdot6.*theta1.*theta6.^2, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot2.*theta5.^3 + 3.*tdot5.*theta2.*theta5.^2, tdot2.*theta6.^2 + 2.*tdot6.*theta2.*theta6, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot3.*theta5.^2 + 2.*tdot5.*theta3.*theta5, tdot6.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta6, tdot6.*theta2.^2 + 2.*tdot2.*theta2.*theta6, tdot5.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta5, tdot5.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta5, tdot5.*theta3.^2 + 2.*tdot3.*theta3.*theta5, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot1.*theta6.^4 + 4.*tdot6.*theta1.*theta6.^3, tdot2.*theta5.^4 + 4.*tdot5.*theta2.*theta5.^3, tdot2.*theta6.^3 + 3.*tdot6.*theta2.*theta6.^2, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot3.*theta5.^3 + 3.*tdot5.*theta3.*theta5.^2, tdot3.*theta6.^2 + 2.*tdot6.*theta3.*theta6, tdot4.*theta5.^2 + 2.*tdot5.*theta4.*theta5, tdot6.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta6, tdot6.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta6, tdot6.*theta3.^2 + 2.*tdot3.*theta3.*theta6, tdot5.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta5, tdot5.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta5, tdot5.*theta4.^2 + 2.*tdot4.*theta4.*theta5, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, tdot2.*theta6.^4 + 4.*tdot6.*theta2.*theta6.^3, tdot3.*theta5.^4 + 4.*tdot5.*theta3.*theta5.^3, tdot3.*theta6.^3 + 3.*tdot6.*theta3.*theta6.^2, tdot4.*theta5.^3 + 3.*tdot5.*theta4.*theta5.^2, tdot4.*theta6.^2 + 2.*tdot6.*theta4.*theta6, tdot6.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta6, tdot6.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta6, tdot6.*theta4.^2 + 2.*tdot4.*theta4.*theta6, tdot5.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta5, tdot5.*theta4.^3 + 3.*tdot4.*theta4.^2.*theta5, tdot3.*theta6.^4 + 4.*tdot6.*theta3.*theta6.^3, tdot4.*theta5.^4 + 4.*tdot5.*theta4.*theta5.^3, tdot4.*theta6.^3 + 3.*tdot6.*theta4.*theta6.^2, tdot5.*theta6.^2 + 2.*tdot6.*theta5.*theta6, tdot6.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta6, tdot6.*theta4.^3 + 3.*tdot4.*theta4.^2.*theta6, tdot6.*theta5.^2 + 2.*tdot5.*theta5.*theta6, tdot5.*theta4.^4 + 4.*tdot4.*theta4.^3.*theta5, tdot4.*theta6.^4 + 4.*tdot6.*theta4.*theta6.^3, tdot5.*theta6.^3 + 3.*tdot6.*theta5.*theta6.^2, tdot6.*theta4.^4 + 4.*tdot4.*theta4.^3.*theta6, tdot6.*theta5.^3 + 3.*tdot5.*theta5.^2.*theta6, tdot5.*theta6.^4 + 4.*tdot6.*theta5.*theta6.^3, tdot6.*theta5.^4 + 4.*tdot5.*theta5.^3.*theta6, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 2.*tdot5.*theta5, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 3.*tdot5.*theta5.^2, 2.*tdot6.*theta6, 5.*tdot4.*theta4.^4, 4.*tdot5.*theta5.^3, 3.*tdot6.*theta6.^2, 5.*tdot5.*theta5.^4, 4.*tdot6.*theta6.^3, 5.*tdot6.*theta6.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta2.*theta5.^2 + tdot2.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta5, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta5, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot2.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta5, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta2.*theta5.^3 + tdot2.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta2.*theta5.^2, tdot1.*theta2.*theta6.^2 + tdot2.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta6, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.*theta5.^2 + tdot3.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta5, tdot1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta6, tdot1.*theta2.^3.*theta5 + tdot5.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta5, tdot1.*theta3.^2.*theta5 + tdot5.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta5, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta6, tdot3.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta5, tdot2.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta5, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot1.*theta2.*theta6.^3 + tdot2.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta2.*theta6.^2, tdot1.*theta3.*theta5.^3 + tdot3.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta3.*theta5.^2, tdot1.*theta3.*theta6.^2 + tdot3.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta6, tdot1.*theta4.*theta5.^2 + tdot4.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta4.*theta5, tdot1.*theta2.^3.*theta6 + tdot6.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta6, tdot1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta6, tdot1.*theta3.^3.*theta5 + tdot5.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta5, tdot1.*theta4.^2.*theta5 + tdot5.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta4.*theta5, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.*theta5.^2 + tdot3.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta5, tdot2.*theta3.^2.*theta5 + tdot5.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta5, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta6, tdot4.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta4 + 2.*tdot1.*theta1.*theta4.*theta5, tdot2.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta6, tdot3.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta5, tdot3.*theta2.^2.*theta5 + tdot5.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta5, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta3.*theta6.^3 + tdot3.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta3.*theta6.^2, tdot1.*theta4.*theta5.^3 + tdot4.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta4.*theta5.^2, tdot1.*theta4.*theta6.^2 + tdot4.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta4.*theta6, tdot1.*theta3.^3.*theta6 + tdot6.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta6, tdot1.*theta4.^2.*theta6 + tdot6.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta4.*theta6, tdot1.*theta4.^3.*theta5 + tdot5.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2.*theta5, tdot2.*theta3.*theta5.^3 + tdot3.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta3.*theta5.^2, tdot2.*theta3.*theta6.^2 + tdot3.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta6, tdot2.*theta4.*theta5.^2 + tdot4.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta4.*theta5, tdot2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta6, tdot2.*theta3.^3.*theta5 + tdot5.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta5, tdot2.*theta4.^2.*theta5 + tdot5.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta4.*theta5, tdot4.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta4 + 2.*tdot1.*theta1.*theta4.*theta6, tdot3.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta6, tdot4.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.*theta5, tdot3.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta6, tdot4.*theta2.^2.*theta5 + tdot5.*theta2.^2.*theta4 + 2.*tdot2.*theta2.*theta4.*theta5, tdot3.*theta2.^3.*theta5 + tdot5.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta5, tdot1.*theta4.*theta6.^3 + tdot4.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta4.*theta6.^2, tdot1.*theta5.*theta6.^2 + tdot5.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta5.*theta6, tdot1.*theta4.^3.*theta6 + tdot6.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2.*theta6, tdot1.*theta5.^2.*theta6 + tdot6.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta5.*theta6, tdot2.*theta3.*theta6.^3 + tdot3.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta3.*theta6.^2, tdot2.*theta4.*theta5.^3 + tdot4.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta4.*theta5.^2, tdot2.*theta4.*theta6.^2 + tdot4.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta4.*theta6, tdot2.*theta3.^3.*theta6 + tdot6.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta6, tdot2.*theta4.^2.*theta6 + tdot6.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta4.*theta6, tdot2.*theta4.^3.*theta5 + tdot5.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2.*theta5, tdot3.*theta4.*theta5.^2 + tdot4.*theta3.*theta5.^2 + 2.*tdot5.*theta3.*theta4.*theta5, tdot3.*theta4.^2.*theta5 + tdot5.*theta3.*theta4.^2 + 2.*tdot4.*theta3.*theta4.*theta5, tdot5.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta5 + 2.*tdot1.*theta1.*theta5.*theta6, tdot4.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.*theta6, tdot4.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta4 + 2.*tdot2.*theta2.*theta4.*theta6, tdot3.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta6, tdot4.*theta2.^3.*theta5 + tdot5.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.*theta5, tdot4.*theta3.^2.*theta5 + tdot5.*theta3.^2.*theta4 + 2.*tdot3.*theta3.*theta4.*theta5, tdot1.*theta5.*theta6.^3 + tdot5.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta5.*theta6.^2, tdot1.*theta5.^3.*theta6 + tdot6.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta5.^2.*theta6, tdot2.*theta4.*theta6.^3 + tdot4.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta4.*theta6.^2, tdot2.*theta5.*theta6.^2 + tdot5.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta5.*theta6, tdot2.*theta4.^3.*theta6 + tdot6.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2.*theta6, tdot2.*theta5.^2.*theta6 + tdot6.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta5.*theta6, tdot3.*theta4.*theta5.^3 + tdot4.*theta3.*theta5.^3 + 3.*tdot5.*theta3.*theta4.*theta5.^2, tdot3.*theta4.*theta6.^2 + tdot4.*theta3.*theta6.^2 + 2.*tdot6.*theta3.*theta4.*theta6, tdot3.*theta4.^2.*theta6 + tdot6.*theta3.*theta4.^2 + 2.*tdot4.*theta3.*theta4.*theta6, tdot3.*theta4.^3.*theta5 + tdot5.*theta3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2.*theta5, tdot5.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta5 + 3.*tdot1.*theta1.^2.*theta5.*theta6, tdot5.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta5 + 2.*tdot2.*theta2.*theta5.*theta6, tdot4.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.*theta6, tdot4.*theta3.^2.*theta6 + tdot6.*theta3.^2.*theta4 + 2.*tdot3.*theta3.*theta4.*theta6, tdot4.*theta3.^3.*theta5 + tdot5.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.*theta5, tdot2.*theta5.*theta6.^3 + tdot5.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta5.*theta6.^2, tdot2.*theta5.^3.*theta6 + tdot6.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta5.^2.*theta6, tdot3.*theta4.*theta6.^3 + tdot4.*theta3.*theta6.^3 + 3.*tdot6.*theta3.*theta4.*theta6.^2, tdot3.*theta5.*theta6.^2 + tdot5.*theta3.*theta6.^2 + 2.*tdot6.*theta3.*theta5.*theta6, tdot3.*theta4.^3.*theta6 + tdot6.*theta3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2.*theta6, tdot3.*theta5.^2.*theta6 + tdot6.*theta3.*theta5.^2 + 2.*tdot5.*theta3.*theta5.*theta6, tdot5.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta5 + 3.*tdot2.*theta2.^2.*theta5.*theta6, tdot5.*theta3.^2.*theta6 + tdot6.*theta3.^2.*theta5 + 2.*tdot3.*theta3.*theta5.*theta6, tdot4.*theta3.^3.*theta6 + tdot6.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.*theta6, tdot3.*theta5.*theta6.^3 + tdot5.*theta3.*theta6.^3 + 3.*tdot6.*theta3.*theta5.*theta6.^2, tdot3.*theta5.^3.*theta6 + tdot6.*theta3.*theta5.^3 + 3.*tdot5.*theta3.*theta5.^2.*theta6, tdot4.*theta5.*theta6.^2 + tdot5.*theta4.*theta6.^2 + 2.*tdot6.*theta4.*theta5.*theta6, tdot4.*theta5.^2.*theta6 + tdot6.*theta4.*theta5.^2 + 2.*tdot5.*theta4.*theta5.*theta6, tdot5.*theta3.^3.*theta6 + tdot6.*theta3.^3.*theta5 + 3.*tdot3.*theta3.^2.*theta5.*theta6, tdot5.*theta4.^2.*theta6 + tdot6.*theta4.^2.*theta5 + 2.*tdot4.*theta4.*theta5.*theta6, tdot4.*theta5.*theta6.^3 + tdot5.*theta4.*theta6.^3 + 3.*tdot6.*theta4.*theta5.*theta6.^2, tdot4.*theta5.^3.*theta6 + tdot6.*theta4.*theta5.^3 + 3.*tdot5.*theta4.*theta5.^2.*theta6, tdot5.*theta4.^3.*theta6 + tdot6.*theta4.^3.*theta5 + 3.*tdot4.*theta4.^2.*theta5.*theta6, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.^2.*theta5, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot2.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta2.*theta5, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot5.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta5 + 2.*tdot2.*theta1.^2.*theta2.*theta5, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.^2.*theta6, tdot1.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.^2.*theta5, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot2.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta2.*theta6, tdot3.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta3.*theta5, tdot6.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta6 + 2.*tdot2.*theta1.^2.*theta2.*theta6, tdot5.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta5 + 2.*tdot3.*theta1.^2.*theta3.*theta5, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.^2.*theta6, tdot1.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.*theta4.^2.*theta5, tdot2.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.^2.*theta5, tdot3.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta3.*theta6, tdot4.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta4.*theta5, tdot6.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta6 + 2.*tdot3.*theta1.^2.*theta3.*theta6, tdot5.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta4.^2.*theta5 + 2.*tdot4.*theta1.^2.*theta4.*theta5, tdot3.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta3.*theta5, tdot5.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta5 + 2.*tdot3.*theta2.^2.*theta3.*theta5, tdot1.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.*theta4.^2.*theta6, tdot2.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.^2.*theta6, tdot2.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.*theta4.^2.*theta5, tdot4.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta4.*theta6, tdot6.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta4.^2.*theta6 + 2.*tdot4.*theta1.^2.*theta4.*theta6, tdot3.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta3.*theta6, tdot4.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta4.*theta5, tdot6.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta6 + 2.*tdot3.*theta2.^2.*theta3.*theta6, tdot5.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta4.^2.*theta5 + 2.*tdot4.*theta2.^2.*theta4.*theta5, tdot1.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta1.*theta5.*theta6.^2 + 2.*tdot6.*theta1.*theta5.^2.*theta6, tdot2.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.*theta4.^2.*theta6, tdot3.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.*theta4.^2.*theta5, tdot5.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta5.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta5.*theta6, tdot6.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta5.^2.*theta6 + 2.*tdot5.*theta1.^2.*theta5.*theta6, tdot4.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta4.*theta6, tdot6.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta4.^2.*theta6 + 2.*tdot4.*theta2.^2.*theta4.*theta6, tdot4.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.^2.*theta4.*theta5, tdot5.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta3.*theta4.^2.*theta5 + 2.*tdot4.*theta3.^2.*theta4.*theta5, tdot2.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta2.*theta5.*theta6.^2 + 2.*tdot6.*theta2.*theta5.^2.*theta6, tdot3.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.*theta4.^2.*theta6, tdot5.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta5.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta5.*theta6, tdot6.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta5.^2.*theta6 + 2.*tdot5.*theta2.^2.*theta5.*theta6, tdot4.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta4.*theta6, tdot6.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta3.*theta4.^2.*theta6 + 2.*tdot4.*theta3.^2.*theta4.*theta6, tdot3.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta3.*theta5.*theta6.^2 + 2.*tdot6.*theta3.*theta5.^2.*theta6, tdot5.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta3.*theta5.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta5.*theta6, tdot6.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta3.*theta5.^2.*theta6 + 2.*tdot5.*theta3.^2.*theta5.*theta6, tdot4.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta4.*theta5.*theta6.^2 + 2.*tdot6.*theta4.*theta5.^2.*theta6, tdot5.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta4.*theta5.*theta6.^2 + 2.*tdot6.*theta4.^2.*theta5.*theta6, tdot6.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta4.*theta5.^2.*theta6 + 2.*tdot5.*theta4.^2.*theta5.*theta6, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta2.*theta5 + tdot2.*theta1.*theta5 + tdot5.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot1.*theta2.*theta6 + tdot2.*theta1.*theta6 + tdot6.*theta1.*theta2, tdot1.*theta3.*theta5 + tdot3.*theta1.*theta5 + tdot5.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta3.*theta6 + tdot3.*theta1.*theta6 + tdot6.*theta1.*theta3, tdot1.*theta4.*theta5 + tdot4.*theta1.*theta5 + tdot5.*theta1.*theta4, tdot2.*theta3.*theta5 + tdot3.*theta2.*theta5 + tdot5.*theta2.*theta3, tdot1.*theta4.*theta6 + tdot4.*theta1.*theta6 + tdot6.*theta1.*theta4, tdot2.*theta3.*theta6 + tdot3.*theta2.*theta6 + tdot6.*theta2.*theta3, tdot2.*theta4.*theta5 + tdot4.*theta2.*theta5 + tdot5.*theta2.*theta4, tdot1.*theta5.*theta6 + tdot5.*theta1.*theta6 + tdot6.*theta1.*theta5, tdot2.*theta4.*theta6 + tdot4.*theta2.*theta6 + tdot6.*theta2.*theta4, tdot3.*theta4.*theta5 + tdot4.*theta3.*theta5 + tdot5.*theta3.*theta4, tdot2.*theta5.*theta6 + tdot5.*theta2.*theta6 + tdot6.*theta2.*theta5, tdot3.*theta4.*theta6 + tdot4.*theta3.*theta6 + tdot6.*theta3.*theta4, tdot3.*theta5.*theta6 + tdot5.*theta3.*theta6 + tdot6.*theta3.*theta5, tdot4.*theta5.*theta6 + tdot5.*theta4.*theta6 + tdot6.*theta4.*theta5, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta5 + tdot2.*theta1.*theta3.*theta5 + tdot3.*theta1.*theta2.*theta5 + tdot5.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta6 + tdot2.*theta1.*theta3.*theta6 + tdot3.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta3, tdot1.*theta2.*theta4.*theta5 + tdot2.*theta1.*theta4.*theta5 + tdot4.*theta1.*theta2.*theta5 + tdot5.*theta1.*theta2.*theta4, tdot1.*theta2.*theta4.*theta6 + tdot2.*theta1.*theta4.*theta6 + tdot4.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta4, tdot1.*theta3.*theta4.*theta5 + tdot3.*theta1.*theta4.*theta5 + tdot4.*theta1.*theta3.*theta5 + tdot5.*theta1.*theta3.*theta4, tdot1.*theta2.*theta5.*theta6 + tdot2.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta5, tdot1.*theta3.*theta4.*theta6 + tdot3.*theta1.*theta4.*theta6 + tdot4.*theta1.*theta3.*theta6 + tdot6.*theta1.*theta3.*theta4, tdot2.*theta3.*theta4.*theta5 + tdot3.*theta2.*theta4.*theta5 + tdot4.*theta2.*theta3.*theta5 + tdot5.*theta2.*theta3.*theta4, tdot1.*theta3.*theta5.*theta6 + tdot3.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta3.*theta6 + tdot6.*theta1.*theta3.*theta5, tdot2.*theta3.*theta4.*theta6 + tdot3.*theta2.*theta4.*theta6 + tdot4.*theta2.*theta3.*theta6 + tdot6.*theta2.*theta3.*theta4, tdot1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta4.*theta6 + tdot6.*theta1.*theta4.*theta5, tdot2.*theta3.*theta5.*theta6 + tdot3.*theta2.*theta5.*theta6 + tdot5.*theta2.*theta3.*theta6 + tdot6.*theta2.*theta3.*theta5, tdot2.*theta4.*theta5.*theta6 + tdot4.*theta2.*theta5.*theta6 + tdot5.*theta2.*theta4.*theta6 + tdot6.*theta2.*theta4.*theta5, tdot3.*theta4.*theta5.*theta6 + tdot4.*theta3.*theta5.*theta6 + tdot5.*theta3.*theta4.*theta6 + tdot6.*theta3.*theta4.*theta5, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta5.^2 + tdot2.*theta1.*theta3.*theta5.^2 + tdot3.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta3.^2.*theta5 + tdot2.*theta1.*theta3.^2.*theta5 + tdot5.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.^2.*theta3.*theta5 + tdot3.*theta1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta5, tdot2.*theta1.^2.*theta3.*theta5 + tdot3.*theta1.^2.*theta2.*theta5 + tdot5.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta3.*theta6.^2 + tdot2.*theta1.*theta3.*theta6.^2 + tdot3.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.*theta4.*theta5.^2 + tdot2.*theta1.*theta4.*theta5.^2 + tdot4.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.*theta3.^2.*theta6 + tdot2.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.*theta4.^2.*theta5 + tdot2.*theta1.*theta4.^2.*theta5 + tdot5.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.^2.*theta3.*theta6 + tdot3.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.^2.*theta4.*theta5 + tdot4.*theta1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.*theta2.*theta4.*theta5, tdot2.*theta1.^2.*theta3.*theta6 + tdot3.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta6, tdot2.*theta1.^2.*theta4.*theta5 + tdot4.*theta1.^2.*theta2.*theta5 + tdot5.*theta1.^2.*theta2.*theta4 + 2.*tdot1.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.*theta4.*theta6.^2 + tdot2.*theta1.*theta4.*theta6.^2 + tdot4.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta4.*theta6, tdot1.*theta2.*theta4.^2.*theta6 + tdot2.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4.*theta6, tdot1.*theta3.*theta4.*theta5.^2 + tdot3.*theta1.*theta4.*theta5.^2 + tdot4.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta4.*theta5, tdot1.*theta3.*theta4.^2.*theta5 + tdot3.*theta1.*theta4.^2.*theta5 + tdot5.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4.*theta5, tdot1.*theta2.^2.*theta4.*theta6 + tdot4.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.*theta2.*theta4.*theta6, tdot1.*theta3.^2.*theta4.*theta5 + tdot4.*theta1.*theta3.^2.*theta5 + tdot5.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.*theta3.*theta4.*theta5, tdot2.*theta1.^2.*theta4.*theta6 + tdot4.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta4 + 2.*tdot1.*theta1.*theta2.*theta4.*theta6, tdot3.*theta1.^2.*theta4.*theta5 + tdot4.*theta1.^2.*theta3.*theta5 + tdot5.*theta1.^2.*theta3.*theta4 + 2.*tdot1.*theta1.*theta3.*theta4.*theta5, tdot1.*theta2.*theta5.*theta6.^2 + tdot2.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta5.*theta6, tdot1.*theta2.*theta5.^2.*theta6 + tdot2.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta5.*theta6, tdot1.*theta3.*theta4.*theta6.^2 + tdot3.*theta1.*theta4.*theta6.^2 + tdot4.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta4.*theta6, tdot1.*theta3.*theta4.^2.*theta6 + tdot3.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4.*theta6, tdot1.*theta2.^2.*theta5.*theta6 + tdot5.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta5 + 2.*tdot2.*theta1.*theta2.*theta5.*theta6, tdot1.*theta3.^2.*theta4.*theta6 + tdot4.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.*theta3.*theta4.*theta6, tdot2.*theta3.*theta4.*theta5.^2 + tdot3.*theta2.*theta4.*theta5.^2 + tdot4.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta4.*theta5, tdot2.*theta3.*theta4.^2.*theta5 + tdot3.*theta2.*theta4.^2.*theta5 + tdot5.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4.*theta5, tdot2.*theta3.^2.*theta4.*theta5 + tdot4.*theta2.*theta3.^2.*theta5 + tdot5.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.*theta3.*theta4.*theta5, tdot2.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta5 + 2.*tdot1.*theta1.*theta2.*theta5.*theta6, tdot3.*theta1.^2.*theta4.*theta6 + tdot4.*theta1.^2.*theta3.*theta6 + tdot6.*theta1.^2.*theta3.*theta4 + 2.*tdot1.*theta1.*theta3.*theta4.*theta6, tdot3.*theta2.^2.*theta4.*theta5 + tdot4.*theta2.^2.*theta3.*theta5 + tdot5.*theta2.^2.*theta3.*theta4 + 2.*tdot2.*theta2.*theta3.*theta4.*theta5, tdot1.*theta3.*theta5.*theta6.^2 + tdot3.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta5.*theta6, tdot1.*theta3.*theta5.^2.*theta6 + tdot3.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta5.*theta6, tdot1.*theta3.^2.*theta5.*theta6 + tdot5.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2.*theta5 + 2.*tdot3.*theta1.*theta3.*theta5.*theta6, tdot2.*theta3.*theta4.*theta6.^2 + tdot3.*theta2.*theta4.*theta6.^2 + tdot4.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta4.*theta6, tdot2.*theta3.*theta4.^2.*theta6 + tdot3.*theta2.*theta4.^2.*theta6 + tdot6.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4.*theta6, tdot2.*theta3.^2.*theta4.*theta6 + tdot4.*theta2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.*theta3.*theta4.*theta6, tdot3.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta3.*theta6 + tdot6.*theta1.^2.*theta3.*theta5 + 2.*tdot1.*theta1.*theta3.*theta5.*theta6, tdot3.*theta2.^2.*theta4.*theta6 + tdot4.*theta2.^2.*theta3.*theta6 + tdot6.*theta2.^2.*theta3.*theta4 + 2.*tdot2.*theta2.*theta3.*theta4.*theta6, tdot1.*theta4.*theta5.*theta6.^2 + tdot4.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.*theta4.*theta5.*theta6, tdot1.*theta4.*theta5.^2.*theta6 + tdot4.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.*theta4.*theta5.*theta6, tdot1.*theta4.^2.*theta5.*theta6 + tdot5.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta4.^2.*theta5 + 2.*tdot4.*theta1.*theta4.*theta5.*theta6, tdot2.*theta3.*theta5.*theta6.^2 + tdot3.*theta2.*theta5.*theta6.^2 + tdot5.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta5.*theta6, tdot2.*theta3.*theta5.^2.*theta6 + tdot3.*theta2.*theta5.^2.*theta6 + tdot6.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta5.*theta6, tdot2.*theta3.^2.*theta5.*theta6 + tdot5.*theta2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2.*theta5 + 2.*tdot3.*theta2.*theta3.*theta5.*theta6, tdot4.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta4.*theta6 + tdot6.*theta1.^2.*theta4.*theta5 + 2.*tdot1.*theta1.*theta4.*theta5.*theta6, tdot3.*theta2.^2.*theta5.*theta6 + tdot5.*theta2.^2.*theta3.*theta6 + tdot6.*theta2.^2.*theta3.*theta5 + 2.*tdot2.*theta2.*theta3.*theta5.*theta6, tdot2.*theta4.*theta5.*theta6.^2 + tdot4.*theta2.*theta5.*theta6.^2 + tdot5.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.*theta4.*theta5.*theta6, tdot2.*theta4.*theta5.^2.*theta6 + tdot4.*theta2.*theta5.^2.*theta6 + tdot6.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.*theta4.*theta5.*theta6, tdot2.*theta4.^2.*theta5.*theta6 + tdot5.*theta2.*theta4.^2.*theta6 + tdot6.*theta2.*theta4.^2.*theta5 + 2.*tdot4.*theta2.*theta4.*theta5.*theta6, tdot4.*theta2.^2.*theta5.*theta6 + tdot5.*theta2.^2.*theta4.*theta6 + tdot6.*theta2.^2.*theta4.*theta5 + 2.*tdot2.*theta2.*theta4.*theta5.*theta6, tdot3.*theta4.*theta5.*theta6.^2 + tdot4.*theta3.*theta5.*theta6.^2 + tdot5.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.*theta4.*theta5.*theta6, tdot3.*theta4.*theta5.^2.*theta6 + tdot4.*theta3.*theta5.^2.*theta6 + tdot6.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.*theta4.*theta5.*theta6, tdot3.*theta4.^2.*theta5.*theta6 + tdot5.*theta3.*theta4.^2.*theta6 + tdot6.*theta3.*theta4.^2.*theta5 + 2.*tdot4.*theta3.*theta4.*theta5.*theta6, tdot4.*theta3.^2.*theta5.*theta6 + tdot5.*theta3.^2.*theta4.*theta6 + tdot6.*theta3.^2.*theta4.*theta5 + 2.*tdot3.*theta3.*theta4.*theta5.*theta6, tdot1.*theta2.*theta3.*theta4.*theta5 + tdot2.*theta1.*theta3.*theta4.*theta5 + tdot3.*theta1.*theta2.*theta4.*theta5 + tdot4.*theta1.*theta2.*theta3.*theta5 + tdot5.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta4.*theta6 + tdot2.*theta1.*theta3.*theta4.*theta6 + tdot3.*theta1.*theta2.*theta4.*theta6 + tdot4.*theta1.*theta2.*theta3.*theta6 + tdot6.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta5.*theta6 + tdot2.*theta1.*theta3.*theta5.*theta6 + tdot3.*theta1.*theta2.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta3.*theta6 + tdot6.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta4.*theta5.*theta6 + tdot2.*theta1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta2.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta4.*theta6 + tdot6.*theta1.*theta2.*theta4.*theta5, tdot1.*theta3.*theta4.*theta5.*theta6 + tdot3.*theta1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta3.*theta5.*theta6 + tdot5.*theta1.*theta3.*theta4.*theta6 + tdot6.*theta1.*theta3.*theta4.*theta5, tdot2.*theta3.*theta4.*theta5.*theta6 + tdot3.*theta2.*theta4.*theta5.*theta6 + tdot4.*theta2.*theta3.*theta5.*theta6 + tdot5.*theta2.*theta3.*theta4.*theta6 + tdot6.*theta2.*theta3.*theta4.*theta5, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -2.*theta1.*theta5.^2, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.^3, -2.*theta1.*theta6.^2, -3.*theta1.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6.^3, -3.*theta1.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta5, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, -3.*theta1.^2.*theta5, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6, zeroCol, -4.*theta1.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta2.*theta5.^2, -theta3.*theta4.^2, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta2.*theta5, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta2.*theta5.^3, -theta2.*theta6.^2, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^2.*theta6, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -2.*theta1.*theta3.*theta5, -3.*theta1.^2.*theta2.*theta5, -3.*theta1.^2.*theta3.*theta4, zeroCol, -theta2.*theta6.^3, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -2.*theta1.*theta4.*theta5, -3.*theta1.^2.*theta2.*theta6, -3.*theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.^2.*theta3.*theta6, -3.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6, -3.*theta1.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta2.^2.*theta5.^2, -theta3.^2.*theta4.^2, -2.*theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta2.^2.*theta5, -2.*theta1.*theta3.^2.*theta4, -theta2.^2.*theta6.^2, -theta3.^2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta6.^2, -2.*theta1.*theta3.*theta5.^2, -2.*theta1.*theta2.^2.*theta6, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, -2.*theta1.*theta3.*theta6.^2, -2.*theta1.*theta4.*theta5.^2, -2.*theta1.*theta3.^2.*theta6, -2.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6.^2, -2.*theta1.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta2.*theta5, -theta3.*theta4, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta5, -theta2.*theta3.*theta6, -theta2.*theta4.*theta5, -theta2.*theta4.*theta6, -theta3.*theta4.*theta5, -theta2.*theta5.*theta6, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta2.*theta3.*theta6.^2, -theta2.*theta4.*theta5.^2, -theta2.*theta3.^2.*theta6, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta3.*theta6, -theta2.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta6, -theta3.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta4.*theta6, -2.*theta1.*theta3.*theta4.*theta5, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta2.^2.*theta5.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.*theta6, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.^3, -2.*theta2.*theta5.^2, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.^3, -2.*theta2.*theta6.^2, -3.*theta2.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6.^3, -3.*theta2.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, -3.*theta2.^2.*theta5, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6, zeroCol, -4.*theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta5, -3.*theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -3.*theta1.*theta2.^2.*theta5, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -2.*theta2.*theta3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -2.*theta2.*theta3.*theta5, -3.*theta2.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, -2.*theta2.*theta4.*theta5, -3.*theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.^2.*theta3.*theta6, -3.*theta2.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta2.^2.*theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, -2.*theta1.*theta2.*theta5.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -2.*theta1.*theta2.*theta6.^2, zeroCol, -theta3.^2.*theta4.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, -theta3.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.^2.*theta5, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6.^2, -2.*theta2.*theta4.*theta5.^2, -2.*theta2.*theta3.^2.*theta6, -2.*theta2.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.^2.*theta6, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6.^2, -2.*theta2.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3, -theta1.*theta4, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta3.*theta4, zeroCol, zeroCol, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta3.*theta5, -theta1.*theta3.*theta6, -theta1.*theta4.*theta5, -theta1.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5, zeroCol, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, -theta4.*theta5.*theta6, zeroCol, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta1.^2.*theta3.*theta5, -theta1.*theta3.*theta6.^2, -theta1.*theta4.*theta5.^2, -theta1.*theta3.^2.*theta6, -theta1.*theta4.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta1.^2.*theta3.*theta6, -theta1.^2.*theta4.*theta5, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, zeroCol, -theta1.^2.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, -theta1.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta5.*theta6, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta2.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta5.*theta6, -theta1.*theta4.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.*theta6, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^3, -2.*theta3.*theta5.^2, -3.*theta3.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta5.^3, -2.*theta3.*theta6.^2, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.*theta6.^3, -3.*theta3.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, -theta2, zeroCol, zeroCol, zeroCol, zeroCol, -theta4, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta3.^3, zeroCol, zeroCol, -theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, -3.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -3.*theta3.^2.*theta5, zeroCol, -4.*theta3.^3.*theta4, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta6, zeroCol, -4.*theta3.^3.*theta5, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, -4.*theta3.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta2.^2.*theta4, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -3.*theta1.*theta3.^2.*theta5, zeroCol, -theta2.*theta4.^3, -theta2.*theta5.^2, -2.*theta2.*theta3.*theta5, -3.*theta2.*theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, -3.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta6, -3.*theta2.*theta3.^2.*theta5, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2.*theta6, zeroCol, zeroCol, -theta4.*theta5.^2, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta6, zeroCol, -2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6, -3.*theta3.^2.*theta4.*theta5, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, -2.*theta3.*theta5.*theta6, -3.*theta3.^2.*theta4.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta3.*theta5, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta5.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta5.^2, -2.*theta2.^2.*theta3.*theta5, zeroCol, -2.*theta2.*theta3.*theta6.^2, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta6.^2, zeroCol, -2.*theta2.^2.*theta3.*theta6, zeroCol, zeroCol, zeroCol, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta5.^2, -2.*theta3.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.^2.*theta6, -theta5.^2.*theta6.^2, -2.*theta3.*theta5.*theta6.^2, -2.*theta3.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta4, zeroCol, -theta1.*theta5, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta4.*theta5, zeroCol, -theta4.*theta6, -theta5.*theta6, zeroCol, -theta1.*theta2.*theta4, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta4.*theta5, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta4.*theta5, -theta1.*theta5.*theta6, -theta2.*theta4.*theta6, zeroCol, -theta2.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.^2.*theta5, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -theta1.^2.*theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, -2.*theta1.*theta3.*theta4.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta4.*theta5, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta3.*theta5.*theta6, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -2.*theta2.*theta3.*theta4.*theta6, -theta1.^2.*theta5.*theta6, -theta2.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta3.*theta5.*theta6, zeroCol, -theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta1.*theta2.*theta4.*theta5, -theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta5.*theta6, zeroCol, -theta1.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta4.^2, zeroCol, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta4.^2, zeroCol, -2.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5.^2, zeroCol, zeroCol, -2.*theta4.*theta5.^3, -2.*theta4.*theta6.^2, -3.*theta4.^2.*theta5.^2, -2.*theta4.*theta6.^3, -3.*theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, zeroCol, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, zeroCol, zeroCol, -3.*theta2.*theta4.^2, zeroCol, -2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta4.^3, zeroCol, zeroCol, -3.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, zeroCol, zeroCol, zeroCol, -4.*theta3.*theta4.^3, zeroCol, zeroCol, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5, -theta3.^4, zeroCol, zeroCol, zeroCol, -theta5.^3, -theta6.^2, zeroCol, zeroCol, -2.*theta4.*theta6, zeroCol, -3.*theta4.^2.*theta5, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, -3.*theta4.^2.*theta6, zeroCol, -4.*theta4.^3.*theta5, -theta6.^4, zeroCol, -4.*theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, zeroCol, -4.*theta4.^3, zeroCol, zeroCol, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, -3.*theta1.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5, -3.*theta2.*theta3.*theta4.^2, zeroCol, zeroCol, -theta2.*theta3.^3, zeroCol, -theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta3, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta4.*theta5, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -theta2.^2.*theta5, zeroCol, -theta1.*theta6.^3, zeroCol, -3.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.*theta4.^2.*theta5, -theta3.*theta5.^2, -2.*theta3.*theta4.*theta5, zeroCol, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, -theta3.^2.*theta5, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, -3.*theta2.*theta4.^2.*theta6, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -2.*theta3.*theta4.*theta6, -3.*theta3.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, zeroCol, -3.*theta3.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.^3.*theta6, zeroCol, zeroCol, -theta5.*theta6.^2, -theta5.^2.*theta6, zeroCol, -2.*theta4.*theta5.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, -3.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, zeroCol, -2.*theta1.*theta3.^2.*theta4, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta5.^2, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta4.*theta6, zeroCol, -theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta4.*theta6, -theta3.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta5, zeroCol, -2.*theta3.*theta4.*theta6.^2, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, -2.*theta4.*theta5.*theta6.^2, -2.*theta4.*theta5.^2.*theta6, zeroCol, -theta1.*theta2, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta2.*theta3, zeroCol, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, zeroCol, -theta5.*theta6, -theta1.*theta2.*theta3, zeroCol, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, -theta1.*theta3.*theta5, zeroCol, -theta1.*theta3.*theta6, -theta2.*theta3.*theta5, zeroCol, -theta2.*theta3.*theta6, -theta1.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6, -theta3.*theta5.*theta6, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.^2.*theta5, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta2.^2.*theta6, -theta1.*theta3.^2.*theta5, -theta1.^2.*theta2.*theta6, -theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta1.*theta3.^2.*theta6, -theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.^2.*theta5, zeroCol, -theta1.^2.*theta3.*theta6, -theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.^2.*theta6, zeroCol, -theta2.^2.*theta3.*theta6, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta4.*theta5.*theta6, -theta2.^2.*theta5.*theta6, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta3.^2.*theta5.*theta6, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta5.*theta6, -theta1.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.*theta6, zeroCol,];
        R5= [ zeroCol, zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^3.*theta5, zeroCol, -2.*theta2.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^3.*theta5, zeroCol, -2.*theta3.^2.*theta5, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.^3.*theta5, -2.*theta4.^2.*theta5, zeroCol, zeroCol, -3.*theta4.^2.*theta5.^2, zeroCol, -2.*theta4.^3.*theta5, zeroCol, zeroCol, -2.*theta5.*theta6.^2, -2.*theta5.*theta6.^3, -3.*theta5.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta5.^3, zeroCol, zeroCol, -3.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta5.^3, zeroCol, zeroCol, -3.*theta3.*theta5.^2, zeroCol, -2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta5.^3, zeroCol, -3.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, zeroCol, -4.*theta4.*theta5.^3, zeroCol, -theta6.^2, zeroCol, zeroCol, -2.*theta5.*theta6, -theta4.^4, zeroCol, -theta6.^3, zeroCol, -3.*theta5.^2.*theta6, -theta6.^4, -4.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta5, zeroCol, zeroCol, -3.*theta5.^2, zeroCol, zeroCol, -4.*theta5.^3, zeroCol, -5.*theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, -3.*theta1.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta5.^2, zeroCol, -2.*theta1.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, -2.*theta2.*theta3.*theta5, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -3.*theta2.*theta3.*theta5.^2, zeroCol, -2.*theta2.*theta4.*theta5, zeroCol, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta5.*theta6, zeroCol, -3.*theta2.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta2.*theta4.^3, -2.*theta3.*theta4.*theta5, -theta3.*theta4.^2, -theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta4, -theta3.^2.*theta4, -theta1.*theta6.^3, -3.*theta1.*theta5.^2.*theta6, zeroCol, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta3.*theta4.^3, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, zeroCol, -theta3.^3.*theta4, -theta2.*theta6.^3, -3.*theta2.*theta5.^2.*theta6, zeroCol, -theta3.*theta6.^2, zeroCol, -2.*theta3.*theta5.*theta6, -theta2.^3.*theta6, -theta3.^2.*theta6, zeroCol, -theta3.*theta6.^3, -3.*theta3.*theta5.^2.*theta6, -theta4.*theta6.^2, -2.*theta4.*theta5.*theta6, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.*theta6.^3, -3.*theta4.*theta5.^2.*theta6, -theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta5, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta5, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.^2.*theta5, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta5, -theta2.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -theta2.^2.*theta4.^2, -2.*theta1.*theta5.*theta6.^2, zeroCol, -2.*theta3.*theta4.^2.*theta5, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.^2.*theta4.*theta5, -theta3.^2.*theta4.^2, -2.*theta2.*theta5.*theta6.^2, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.*theta5.*theta6.^2, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta5.*theta6, -2.*theta4.*theta5.*theta6.^2, -theta4.^2.*theta6.^2, -2.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, zeroCol, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta3.*theta4, -theta2.*theta6, zeroCol, -theta3.*theta6, -theta4.*theta6, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta2.*theta6, zeroCol, -theta2.*theta3.*theta4, -theta1.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta3.*theta6, -theta2.*theta4.*theta6, -theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta4.^2, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.^2, zeroCol, -theta1.*theta3.^2.*theta4, zeroCol, -theta1.^2.*theta3.*theta4, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta2.*theta6, zeroCol, -theta2.^2.*theta3.*theta4, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.^2.*theta6, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.^2.*theta6, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta3.*theta6, -theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.^2.*theta6, -theta2.^2.*theta4.*theta6, -theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, -theta1.*theta2.*theta3.*theta4, zeroCol, -theta1.*theta2.*theta3.*theta6, -theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.*theta6, zeroCol,];
        R6= [ zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6.^2, -2.*theta1.^3.*theta6, zeroCol, -2.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6.^2, -2.*theta2.^3.*theta6, zeroCol, -2.*theta3.^2.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta6.^2, -2.*theta3.^3.*theta6, zeroCol, -2.*theta4.^2.*theta6, zeroCol, -3.*theta4.^2.*theta6.^2, -2.*theta4.^3.*theta6, -2.*theta5.^2.*theta6, -3.*theta5.^2.*theta6.^2, -2.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, -theta3, zeroCol, -theta4, -theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta6.^3, zeroCol, -3.*theta2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta6.^3, zeroCol, -3.*theta3.*theta6.^2, zeroCol, -2.*theta4.*theta6, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta6.^3, zeroCol, -3.*theta4.*theta6.^2, -2.*theta5.*theta6, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, -4.*theta4.*theta6.^3, -3.*theta5.*theta6.^2, -theta4.^4, -theta5.^3, -4.*theta5.*theta6.^3, -theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta6, zeroCol, zeroCol, -3.*theta6.^2, zeroCol, -4.*theta6.^3, -5.*theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta3.*theta6, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, zeroCol, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, -theta1.^3.*theta3, zeroCol, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta5.*theta6, -theta1.*theta4.^3, -theta1.*theta5.^2, -3.*theta2.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, zeroCol, -3.*theta1.*theta5.*theta6.^2, -theta1.*theta5.^3, -3.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta5.*theta6, -theta2.*theta4.^3, -theta2.*theta5.^2, zeroCol, -2.*theta3.*theta4.*theta6, -theta3.*theta4.^2, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, zeroCol, -3.*theta2.*theta5.*theta6.^2, -theta2.*theta5.^3, -3.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta5.*theta6, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, -3.*theta3.*theta5.*theta6.^2, -theta3.*theta5.^3, -2.*theta4.*theta5.*theta6, -theta4.*theta5.^2, -theta3.^3.*theta5, -theta4.^2.*theta5, -3.*theta4.*theta5.*theta6.^2, -theta4.*theta5.^3, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta6, -2.*theta2.*theta3.^2.*theta6, zeroCol, -2.*theta1.^2.*theta4.*theta6, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta5.^2.*theta6, -2.*theta2.*theta4.^2.*theta6, zeroCol, -2.*theta1.^2.*theta5.*theta6, -theta1.^2.*theta5.^2, -2.*theta2.^2.*theta4.*theta6, -theta2.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta5.^2.*theta6, -2.*theta3.*theta4.^2.*theta6, -2.*theta2.^2.*theta5.*theta6, -theta2.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta6, -theta3.^2.*theta4.^2, -2.*theta3.*theta5.^2.*theta6, -2.*theta3.^2.*theta5.*theta6, -theta3.^2.*theta5.^2, -2.*theta4.*theta5.^2.*theta6, -2.*theta4.^2.*theta5.*theta6, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, -theta1.*theta5, -theta2.*theta4, zeroCol, -theta2.*theta5, -theta3.*theta4, -theta3.*theta5, -theta4.*theta5, zeroCol, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta3.*theta4, zeroCol, -theta1.*theta3.*theta5, -theta2.*theta3.*theta4, -theta1.*theta4.*theta5, -theta2.*theta3.*theta5, -theta2.*theta4.*theta5, -theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta3.^2, zeroCol, -theta1.*theta2.^2.*theta3, zeroCol, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta4.^2, zeroCol, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta4.^2, -theta1.*theta2.^2.*theta5, -theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta3.*theta5, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta1.^2.*theta4.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta5, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta4.*theta5, -theta1.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta5, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;R5;R6;];
    case 106
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
            theta5=DOF(:, 5);
            tdot5=DOFVel(:, 5);
            theta6=DOF(:, 6);
            tdot6=DOFVel(:, 6);
        LMT = [ theta1, theta2, theta3, theta4, theta5, theta6, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^2.*theta5.^2, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta1.^2.*theta5.^3, theta1.^2.*theta6.^2, theta1.^3.*theta5.^2, theta2.^2.*theta4.^3, theta2.^2.*theta5.^2, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta1.^2.*theta6.^3, theta1.^3.*theta6.^2, theta2.^2.*theta5.^3, theta2.^2.*theta6.^2, theta2.^3.*theta5.^2, theta3.^2.*theta4.^3, theta3.^2.*theta5.^2, theta3.^3.*theta4.^2, theta2.^2.*theta6.^3, theta2.^3.*theta6.^2, theta3.^2.*theta5.^3, theta3.^2.*theta6.^2, theta3.^3.*theta5.^2, theta4.^2.*theta5.^2, theta3.^2.*theta6.^3, theta3.^3.*theta6.^2, theta4.^2.*theta5.^3, theta4.^2.*theta6.^2, theta4.^3.*theta5.^2, theta4.^2.*theta6.^3, theta4.^3.*theta6.^2, theta5.^2.*theta6.^2, theta5.^2.*theta6.^3, theta5.^3.*theta6.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta1.*theta5, theta2.*theta4, theta1.*theta6, theta2.*theta5, theta3.*theta4, theta2.*theta6, theta3.*theta5, theta3.*theta6, theta4.*theta5, theta4.*theta6, theta5.*theta6, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta1.*theta5.^2, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^2.*theta5, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta1.*theta5.^3, theta1.*theta6.^2, theta2.*theta3.^4, theta2.*theta4.^3, theta2.*theta5.^2, theta3.*theta4.^2, theta1.^2.*theta6, theta1.^3.*theta5, theta2.^2.*theta5, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta1.*theta5.^4, theta1.*theta6.^3, theta2.*theta4.^4, theta2.*theta5.^3, theta2.*theta6.^2, theta3.*theta4.^3, theta3.*theta5.^2, theta1.^3.*theta6, theta2.^2.*theta6, theta1.^4.*theta5, theta2.^3.*theta5, theta3.^2.*theta5, theta2.^4.*theta4, theta3.^3.*theta4, theta1.*theta6.^4, theta2.*theta5.^4, theta2.*theta6.^3, theta3.*theta4.^4, theta3.*theta5.^3, theta3.*theta6.^2, theta4.*theta5.^2, theta1.^4.*theta6, theta2.^3.*theta6, theta3.^2.*theta6, theta2.^4.*theta5, theta3.^3.*theta5, theta4.^2.*theta5, theta3.^4.*theta4, theta2.*theta6.^4, theta3.*theta5.^4, theta3.*theta6.^3, theta4.*theta5.^3, theta4.*theta6.^2, theta2.^4.*theta6, theta3.^3.*theta6, theta4.^2.*theta6, theta3.^4.*theta5, theta4.^3.*theta5, theta3.*theta6.^4, theta4.*theta5.^4, theta4.*theta6.^3, theta5.*theta6.^2, theta3.^4.*theta6, theta4.^3.*theta6, theta5.^2.*theta6, theta4.^4.*theta5, theta4.*theta6.^4, theta5.*theta6.^3, theta4.^4.*theta6, theta5.^3.*theta6, theta5.*theta6.^4, theta5.^4.*theta6, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta5.^2, theta3.^5, theta4.^4, theta5.^3, theta6.^2, theta4.^5, theta5.^4, theta6.^3, theta5.^5, theta6.^4, theta6.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta2.*theta5.^2, theta1.*theta3.*theta4.^2, theta1.*theta2.^2.*theta5, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta2.*theta5, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta2.*theta5.^3, theta1.*theta2.*theta6.^2, theta1.*theta3.*theta4.^3, theta1.*theta3.*theta5.^2, theta1.*theta2.^2.*theta6, theta1.*theta2.^3.*theta5, theta1.*theta3.^2.*theta5, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^2.*theta2.*theta6, theta1.^2.*theta3.*theta5, theta1.^3.*theta2.*theta5, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta1.*theta2.*theta6.^3, theta1.*theta3.*theta5.^3, theta1.*theta3.*theta6.^2, theta1.*theta4.*theta5.^2, theta1.*theta2.^3.*theta6, theta1.*theta3.^2.*theta6, theta1.*theta3.^3.*theta5, theta1.*theta4.^2.*theta5, theta2.*theta3.*theta4.^3, theta2.*theta3.*theta5.^2, theta2.*theta3.^2.*theta5, theta2.*theta3.^3.*theta4, theta1.^2.*theta3.*theta6, theta1.^2.*theta4.*theta5, theta1.^3.*theta2.*theta6, theta1.^3.*theta3.*theta5, theta2.^2.*theta3.*theta5, theta2.^3.*theta3.*theta4, theta1.*theta3.*theta6.^3, theta1.*theta4.*theta5.^3, theta1.*theta4.*theta6.^2, theta1.*theta3.^3.*theta6, theta1.*theta4.^2.*theta6, theta1.*theta4.^3.*theta5, theta2.*theta3.*theta5.^3, theta2.*theta3.*theta6.^2, theta2.*theta4.*theta5.^2, theta2.*theta3.^2.*theta6, theta2.*theta3.^3.*theta5, theta2.*theta4.^2.*theta5, theta1.^2.*theta4.*theta6, theta1.^3.*theta3.*theta6, theta1.^3.*theta4.*theta5, theta2.^2.*theta3.*theta6, theta2.^2.*theta4.*theta5, theta2.^3.*theta3.*theta5, theta1.*theta4.*theta6.^3, theta1.*theta5.*theta6.^2, theta1.*theta4.^3.*theta6, theta1.*theta5.^2.*theta6, theta2.*theta3.*theta6.^3, theta2.*theta4.*theta5.^3, theta2.*theta4.*theta6.^2, theta2.*theta3.^3.*theta6, theta2.*theta4.^2.*theta6, theta2.*theta4.^3.*theta5, theta3.*theta4.*theta5.^2, theta3.*theta4.^2.*theta5, theta1.^2.*theta5.*theta6, theta1.^3.*theta4.*theta6, theta2.^2.*theta4.*theta6, theta2.^3.*theta3.*theta6, theta2.^3.*theta4.*theta5, theta3.^2.*theta4.*theta5, theta1.*theta5.*theta6.^3, theta1.*theta5.^3.*theta6, theta2.*theta4.*theta6.^3, theta2.*theta5.*theta6.^2, theta2.*theta4.^3.*theta6, theta2.*theta5.^2.*theta6, theta3.*theta4.*theta5.^3, theta3.*theta4.*theta6.^2, theta3.*theta4.^2.*theta6, theta3.*theta4.^3.*theta5, theta1.^3.*theta5.*theta6, theta2.^2.*theta5.*theta6, theta2.^3.*theta4.*theta6, theta3.^2.*theta4.*theta6, theta3.^3.*theta4.*theta5, theta2.*theta5.*theta6.^3, theta2.*theta5.^3.*theta6, theta3.*theta4.*theta6.^3, theta3.*theta5.*theta6.^2, theta3.*theta4.^3.*theta6, theta3.*theta5.^2.*theta6, theta2.^3.*theta5.*theta6, theta3.^2.*theta5.*theta6, theta3.^3.*theta4.*theta6, theta3.*theta5.*theta6.^3, theta3.*theta5.^3.*theta6, theta4.*theta5.*theta6.^2, theta4.*theta5.^2.*theta6, theta3.^3.*theta5.*theta6, theta4.^2.*theta5.*theta6, theta4.*theta5.*theta6.^3, theta4.*theta5.^3.*theta6, theta4.^3.*theta5.*theta6, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta2.^2.*theta5.^2, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta5.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta2.^2.*theta5, theta1.^2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta6.^2, theta1.*theta3.^2.*theta5.^2, theta2.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta6.^2, theta1.^2.*theta3.*theta5.^2, theta1.^2.*theta2.^2.*theta6, theta1.^2.*theta3.^2.*theta5, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta3.^2.*theta6.^2, theta1.*theta4.^2.*theta5.^2, theta2.*theta3.^2.*theta5.^2, theta1.^2.*theta3.*theta6.^2, theta1.^2.*theta4.*theta5.^2, theta1.^2.*theta3.^2.*theta6, theta1.^2.*theta4.^2.*theta5, theta2.^2.*theta3.*theta5.^2, theta2.^2.*theta3.^2.*theta5, theta1.*theta4.^2.*theta6.^2, theta2.*theta3.^2.*theta6.^2, theta2.*theta4.^2.*theta5.^2, theta1.^2.*theta4.*theta6.^2, theta1.^2.*theta4.^2.*theta6, theta2.^2.*theta3.*theta6.^2, theta2.^2.*theta4.*theta5.^2, theta2.^2.*theta3.^2.*theta6, theta2.^2.*theta4.^2.*theta5, theta1.*theta5.^2.*theta6.^2, theta2.*theta4.^2.*theta6.^2, theta3.*theta4.^2.*theta5.^2, theta1.^2.*theta5.*theta6.^2, theta1.^2.*theta5.^2.*theta6, theta2.^2.*theta4.*theta6.^2, theta2.^2.*theta4.^2.*theta6, theta3.^2.*theta4.*theta5.^2, theta3.^2.*theta4.^2.*theta5, theta2.*theta5.^2.*theta6.^2, theta3.*theta4.^2.*theta6.^2, theta2.^2.*theta5.*theta6.^2, theta2.^2.*theta5.^2.*theta6, theta3.^2.*theta4.*theta6.^2, theta3.^2.*theta4.^2.*theta6, theta3.*theta5.^2.*theta6.^2, theta3.^2.*theta5.*theta6.^2, theta3.^2.*theta5.^2.*theta6, theta4.*theta5.^2.*theta6.^2, theta4.^2.*theta5.*theta6.^2, theta4.^2.*theta5.^2.*theta6, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta2.*theta5, theta1.*theta3.*theta4, theta1.*theta2.*theta6, theta1.*theta3.*theta5, theta2.*theta3.*theta4, theta1.*theta3.*theta6, theta1.*theta4.*theta5, theta2.*theta3.*theta5, theta1.*theta4.*theta6, theta2.*theta3.*theta6, theta2.*theta4.*theta5, theta1.*theta5.*theta6, theta2.*theta4.*theta6, theta3.*theta4.*theta5, theta2.*theta5.*theta6, theta3.*theta4.*theta6, theta3.*theta5.*theta6, theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6, theta1.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6, theta1.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6, theta1.*theta3.*theta4.*theta6, theta2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6, theta2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6, theta2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5.^2, theta1.*theta2.*theta3.^2.*theta5, theta1.*theta2.^2.*theta3.*theta5, theta1.^2.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6.^2, theta1.*theta2.*theta4.*theta5.^2, theta1.*theta2.*theta3.^2.*theta6, theta1.*theta2.*theta4.^2.*theta5, theta1.*theta2.^2.*theta3.*theta6, theta1.*theta2.^2.*theta4.*theta5, theta1.^2.*theta2.*theta3.*theta6, theta1.^2.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6.^2, theta1.*theta2.*theta4.^2.*theta6, theta1.*theta3.*theta4.*theta5.^2, theta1.*theta3.*theta4.^2.*theta5, theta1.*theta2.^2.*theta4.*theta6, theta1.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta4.*theta6, theta1.^2.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6.^2, theta1.*theta2.*theta5.^2.*theta6, theta1.*theta3.*theta4.*theta6.^2, theta1.*theta3.*theta4.^2.*theta6, theta1.*theta2.^2.*theta5.*theta6, theta1.*theta3.^2.*theta4.*theta6, theta2.*theta3.*theta4.*theta5.^2, theta2.*theta3.*theta4.^2.*theta5, theta2.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta5.*theta6, theta1.^2.*theta3.*theta4.*theta6, theta2.^2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6.^2, theta1.*theta3.*theta5.^2.*theta6, theta1.*theta3.^2.*theta5.*theta6, theta2.*theta3.*theta4.*theta6.^2, theta2.*theta3.*theta4.^2.*theta6, theta2.*theta3.^2.*theta4.*theta6, theta1.^2.*theta3.*theta5.*theta6, theta2.^2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6.^2, theta1.*theta4.*theta5.^2.*theta6, theta1.*theta4.^2.*theta5.*theta6, theta2.*theta3.*theta5.*theta6.^2, theta2.*theta3.*theta5.^2.*theta6, theta2.*theta3.^2.*theta5.*theta6, theta1.^2.*theta4.*theta5.*theta6, theta2.^2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6.^2, theta2.*theta4.*theta5.^2.*theta6, theta2.*theta4.^2.*theta5.*theta6, theta2.^2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6.^2, theta3.*theta4.*theta5.^2.*theta6, theta3.*theta4.^2.*theta5.*theta6, theta3.^2.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.*theta5, theta1.*theta2.*theta3.*theta4.*theta6, theta1.*theta2.*theta3.*theta5.*theta6, theta1.*theta2.*theta4.*theta5.*theta6, theta1.*theta3.*theta4.*theta5.*theta6, theta2.*theta3.*theta4.*theta5.*theta6, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, tdot5, tdot6, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot1.*theta1.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta5, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot1.*theta1.*theta5.^3 + 3.*tdot5.*theta1.^2.*theta5.^2, 2.*tdot1.*theta1.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta6, 2.*tdot5.*theta1.^3.*theta5 + 3.*tdot1.*theta1.^2.*theta5.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot2.*theta2.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta5, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot1.*theta1.*theta6.^3 + 3.*tdot6.*theta1.^2.*theta6.^2, 2.*tdot6.*theta1.^3.*theta6 + 3.*tdot1.*theta1.^2.*theta6.^2, 2.*tdot2.*theta2.*theta5.^3 + 3.*tdot5.*theta2.^2.*theta5.^2, 2.*tdot2.*theta2.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta6, 2.*tdot5.*theta2.^3.*theta5 + 3.*tdot2.*theta2.^2.*theta5.^2, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot3.*theta3.*theta5.^2 + 2.*tdot5.*theta3.^2.*theta5, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, 2.*tdot2.*theta2.*theta6.^3 + 3.*tdot6.*theta2.^2.*theta6.^2, 2.*tdot6.*theta2.^3.*theta6 + 3.*tdot2.*theta2.^2.*theta6.^2, 2.*tdot3.*theta3.*theta5.^3 + 3.*tdot5.*theta3.^2.*theta5.^2, 2.*tdot3.*theta3.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta6, 2.*tdot5.*theta3.^3.*theta5 + 3.*tdot3.*theta3.^2.*theta5.^2, 2.*tdot4.*theta4.*theta5.^2 + 2.*tdot5.*theta4.^2.*theta5, 2.*tdot3.*theta3.*theta6.^3 + 3.*tdot6.*theta3.^2.*theta6.^2, 2.*tdot6.*theta3.^3.*theta6 + 3.*tdot3.*theta3.^2.*theta6.^2, 2.*tdot4.*theta4.*theta5.^3 + 3.*tdot5.*theta4.^2.*theta5.^2, 2.*tdot4.*theta4.*theta6.^2 + 2.*tdot6.*theta4.^2.*theta6, 2.*tdot5.*theta4.^3.*theta5 + 3.*tdot4.*theta4.^2.*theta5.^2, 2.*tdot4.*theta4.*theta6.^3 + 3.*tdot6.*theta4.^2.*theta6.^2, 2.*tdot6.*theta4.^3.*theta6 + 3.*tdot4.*theta4.^2.*theta6.^2, 2.*tdot5.*theta5.*theta6.^2 + 2.*tdot6.*theta5.^2.*theta6, 2.*tdot5.*theta5.*theta6.^3 + 3.*tdot6.*theta5.^2.*theta6.^2, 2.*tdot6.*theta5.^3.*theta6 + 3.*tdot5.*theta5.^2.*theta6.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta5 + tdot5.*theta1, tdot2.*theta4 + tdot4.*theta2, tdot1.*theta6 + tdot6.*theta1, tdot2.*theta5 + tdot5.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot2.*theta6 + tdot6.*theta2, tdot3.*theta5 + tdot5.*theta3, tdot3.*theta6 + tdot6.*theta3, tdot4.*theta5 + tdot5.*theta4, tdot4.*theta6 + tdot6.*theta4, tdot5.*theta6 + tdot6.*theta5, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot1.*theta5.^2 + 2.*tdot5.*theta1.*theta5, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot5.*theta1.^2 + 2.*tdot1.*theta1.*theta5, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot1.*theta5.^3 + 3.*tdot5.*theta1.*theta5.^2, tdot1.*theta6.^2 + 2.*tdot6.*theta1.*theta6, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot2.*theta5.^2 + 2.*tdot5.*theta2.*theta5, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot6.*theta1.^2 + 2.*tdot1.*theta1.*theta6, tdot5.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta5, tdot5.*theta2.^2 + 2.*tdot2.*theta2.*theta5, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot1.*theta5.^4 + 4.*tdot5.*theta1.*theta5.^3, tdot1.*theta6.^3 + 3.*tdot6.*theta1.*theta6.^2, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot2.*theta5.^3 + 3.*tdot5.*theta2.*theta5.^2, tdot2.*theta6.^2 + 2.*tdot6.*theta2.*theta6, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot3.*theta5.^2 + 2.*tdot5.*theta3.*theta5, tdot6.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta6, tdot6.*theta2.^2 + 2.*tdot2.*theta2.*theta6, tdot5.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta5, tdot5.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta5, tdot5.*theta3.^2 + 2.*tdot3.*theta3.*theta5, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot1.*theta6.^4 + 4.*tdot6.*theta1.*theta6.^3, tdot2.*theta5.^4 + 4.*tdot5.*theta2.*theta5.^3, tdot2.*theta6.^3 + 3.*tdot6.*theta2.*theta6.^2, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot3.*theta5.^3 + 3.*tdot5.*theta3.*theta5.^2, tdot3.*theta6.^2 + 2.*tdot6.*theta3.*theta6, tdot4.*theta5.^2 + 2.*tdot5.*theta4.*theta5, tdot6.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta6, tdot6.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta6, tdot6.*theta3.^2 + 2.*tdot3.*theta3.*theta6, tdot5.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta5, tdot5.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta5, tdot5.*theta4.^2 + 2.*tdot4.*theta4.*theta5, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, tdot2.*theta6.^4 + 4.*tdot6.*theta2.*theta6.^3, tdot3.*theta5.^4 + 4.*tdot5.*theta3.*theta5.^3, tdot3.*theta6.^3 + 3.*tdot6.*theta3.*theta6.^2, tdot4.*theta5.^3 + 3.*tdot5.*theta4.*theta5.^2, tdot4.*theta6.^2 + 2.*tdot6.*theta4.*theta6, tdot6.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta6, tdot6.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta6, tdot6.*theta4.^2 + 2.*tdot4.*theta4.*theta6, tdot5.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta5, tdot5.*theta4.^3 + 3.*tdot4.*theta4.^2.*theta5, tdot3.*theta6.^4 + 4.*tdot6.*theta3.*theta6.^3, tdot4.*theta5.^4 + 4.*tdot5.*theta4.*theta5.^3, tdot4.*theta6.^3 + 3.*tdot6.*theta4.*theta6.^2, tdot5.*theta6.^2 + 2.*tdot6.*theta5.*theta6, tdot6.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta6, tdot6.*theta4.^3 + 3.*tdot4.*theta4.^2.*theta6, tdot6.*theta5.^2 + 2.*tdot5.*theta5.*theta6, tdot5.*theta4.^4 + 4.*tdot4.*theta4.^3.*theta5, tdot4.*theta6.^4 + 4.*tdot6.*theta4.*theta6.^3, tdot5.*theta6.^3 + 3.*tdot6.*theta5.*theta6.^2, tdot6.*theta4.^4 + 4.*tdot4.*theta4.^3.*theta6, tdot6.*theta5.^3 + 3.*tdot5.*theta5.^2.*theta6, tdot5.*theta6.^4 + 4.*tdot6.*theta5.*theta6.^3, tdot6.*theta5.^4 + 4.*tdot5.*theta5.^3.*theta6, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 2.*tdot5.*theta5, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 3.*tdot5.*theta5.^2, 2.*tdot6.*theta6, 5.*tdot4.*theta4.^4, 4.*tdot5.*theta5.^3, 3.*tdot6.*theta6.^2, 5.*tdot5.*theta5.^4, 4.*tdot6.*theta6.^3, 5.*tdot6.*theta6.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta2.*theta5.^2 + tdot2.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta5, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta5, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot2.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta5, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta2.*theta5.^3 + tdot2.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta2.*theta5.^2, tdot1.*theta2.*theta6.^2 + tdot2.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta6, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.*theta5.^2 + tdot3.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta5, tdot1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta6, tdot1.*theta2.^3.*theta5 + tdot5.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta5, tdot1.*theta3.^2.*theta5 + tdot5.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta5, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta6, tdot3.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta5, tdot2.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta5, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot1.*theta2.*theta6.^3 + tdot2.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta2.*theta6.^2, tdot1.*theta3.*theta5.^3 + tdot3.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta3.*theta5.^2, tdot1.*theta3.*theta6.^2 + tdot3.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta6, tdot1.*theta4.*theta5.^2 + tdot4.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta4.*theta5, tdot1.*theta2.^3.*theta6 + tdot6.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta6, tdot1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta6, tdot1.*theta3.^3.*theta5 + tdot5.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta5, tdot1.*theta4.^2.*theta5 + tdot5.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta4.*theta5, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.*theta5.^2 + tdot3.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta5, tdot2.*theta3.^2.*theta5 + tdot5.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta5, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta6, tdot4.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta4 + 2.*tdot1.*theta1.*theta4.*theta5, tdot2.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta6, tdot3.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta5, tdot3.*theta2.^2.*theta5 + tdot5.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta5, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta3.*theta6.^3 + tdot3.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta3.*theta6.^2, tdot1.*theta4.*theta5.^3 + tdot4.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta4.*theta5.^2, tdot1.*theta4.*theta6.^2 + tdot4.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta4.*theta6, tdot1.*theta3.^3.*theta6 + tdot6.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta6, tdot1.*theta4.^2.*theta6 + tdot6.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta4.*theta6, tdot1.*theta4.^3.*theta5 + tdot5.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2.*theta5, tdot2.*theta3.*theta5.^3 + tdot3.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta3.*theta5.^2, tdot2.*theta3.*theta6.^2 + tdot3.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta6, tdot2.*theta4.*theta5.^2 + tdot4.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta4.*theta5, tdot2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta6, tdot2.*theta3.^3.*theta5 + tdot5.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta5, tdot2.*theta4.^2.*theta5 + tdot5.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta4.*theta5, tdot4.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta4 + 2.*tdot1.*theta1.*theta4.*theta6, tdot3.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta6, tdot4.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.*theta5, tdot3.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta6, tdot4.*theta2.^2.*theta5 + tdot5.*theta2.^2.*theta4 + 2.*tdot2.*theta2.*theta4.*theta5, tdot3.*theta2.^3.*theta5 + tdot5.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta5, tdot1.*theta4.*theta6.^3 + tdot4.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta4.*theta6.^2, tdot1.*theta5.*theta6.^2 + tdot5.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta5.*theta6, tdot1.*theta4.^3.*theta6 + tdot6.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2.*theta6, tdot1.*theta5.^2.*theta6 + tdot6.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta5.*theta6, tdot2.*theta3.*theta6.^3 + tdot3.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta3.*theta6.^2, tdot2.*theta4.*theta5.^3 + tdot4.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta4.*theta5.^2, tdot2.*theta4.*theta6.^2 + tdot4.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta4.*theta6, tdot2.*theta3.^3.*theta6 + tdot6.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta6, tdot2.*theta4.^2.*theta6 + tdot6.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta4.*theta6, tdot2.*theta4.^3.*theta5 + tdot5.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2.*theta5, tdot3.*theta4.*theta5.^2 + tdot4.*theta3.*theta5.^2 + 2.*tdot5.*theta3.*theta4.*theta5, tdot3.*theta4.^2.*theta5 + tdot5.*theta3.*theta4.^2 + 2.*tdot4.*theta3.*theta4.*theta5, tdot5.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta5 + 2.*tdot1.*theta1.*theta5.*theta6, tdot4.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.*theta6, tdot4.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta4 + 2.*tdot2.*theta2.*theta4.*theta6, tdot3.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta6, tdot4.*theta2.^3.*theta5 + tdot5.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.*theta5, tdot4.*theta3.^2.*theta5 + tdot5.*theta3.^2.*theta4 + 2.*tdot3.*theta3.*theta4.*theta5, tdot1.*theta5.*theta6.^3 + tdot5.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta5.*theta6.^2, tdot1.*theta5.^3.*theta6 + tdot6.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta5.^2.*theta6, tdot2.*theta4.*theta6.^3 + tdot4.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta4.*theta6.^2, tdot2.*theta5.*theta6.^2 + tdot5.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta5.*theta6, tdot2.*theta4.^3.*theta6 + tdot6.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2.*theta6, tdot2.*theta5.^2.*theta6 + tdot6.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta5.*theta6, tdot3.*theta4.*theta5.^3 + tdot4.*theta3.*theta5.^3 + 3.*tdot5.*theta3.*theta4.*theta5.^2, tdot3.*theta4.*theta6.^2 + tdot4.*theta3.*theta6.^2 + 2.*tdot6.*theta3.*theta4.*theta6, tdot3.*theta4.^2.*theta6 + tdot6.*theta3.*theta4.^2 + 2.*tdot4.*theta3.*theta4.*theta6, tdot3.*theta4.^3.*theta5 + tdot5.*theta3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2.*theta5, tdot5.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta5 + 3.*tdot1.*theta1.^2.*theta5.*theta6, tdot5.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta5 + 2.*tdot2.*theta2.*theta5.*theta6, tdot4.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.*theta6, tdot4.*theta3.^2.*theta6 + tdot6.*theta3.^2.*theta4 + 2.*tdot3.*theta3.*theta4.*theta6, tdot4.*theta3.^3.*theta5 + tdot5.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.*theta5, tdot2.*theta5.*theta6.^3 + tdot5.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta5.*theta6.^2, tdot2.*theta5.^3.*theta6 + tdot6.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta5.^2.*theta6, tdot3.*theta4.*theta6.^3 + tdot4.*theta3.*theta6.^3 + 3.*tdot6.*theta3.*theta4.*theta6.^2, tdot3.*theta5.*theta6.^2 + tdot5.*theta3.*theta6.^2 + 2.*tdot6.*theta3.*theta5.*theta6, tdot3.*theta4.^3.*theta6 + tdot6.*theta3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2.*theta6, tdot3.*theta5.^2.*theta6 + tdot6.*theta3.*theta5.^2 + 2.*tdot5.*theta3.*theta5.*theta6, tdot5.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta5 + 3.*tdot2.*theta2.^2.*theta5.*theta6, tdot5.*theta3.^2.*theta6 + tdot6.*theta3.^2.*theta5 + 2.*tdot3.*theta3.*theta5.*theta6, tdot4.*theta3.^3.*theta6 + tdot6.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.*theta6, tdot3.*theta5.*theta6.^3 + tdot5.*theta3.*theta6.^3 + 3.*tdot6.*theta3.*theta5.*theta6.^2, tdot3.*theta5.^3.*theta6 + tdot6.*theta3.*theta5.^3 + 3.*tdot5.*theta3.*theta5.^2.*theta6, tdot4.*theta5.*theta6.^2 + tdot5.*theta4.*theta6.^2 + 2.*tdot6.*theta4.*theta5.*theta6, tdot4.*theta5.^2.*theta6 + tdot6.*theta4.*theta5.^2 + 2.*tdot5.*theta4.*theta5.*theta6, tdot5.*theta3.^3.*theta6 + tdot6.*theta3.^3.*theta5 + 3.*tdot3.*theta3.^2.*theta5.*theta6, tdot5.*theta4.^2.*theta6 + tdot6.*theta4.^2.*theta5 + 2.*tdot4.*theta4.*theta5.*theta6, tdot4.*theta5.*theta6.^3 + tdot5.*theta4.*theta6.^3 + 3.*tdot6.*theta4.*theta5.*theta6.^2, tdot4.*theta5.^3.*theta6 + tdot6.*theta4.*theta5.^3 + 3.*tdot5.*theta4.*theta5.^2.*theta6, tdot5.*theta4.^3.*theta6 + tdot6.*theta4.^3.*theta5 + 3.*tdot4.*theta4.^2.*theta5.*theta6, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.^2.*theta5, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot2.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta2.*theta5, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot5.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta5 + 2.*tdot2.*theta1.^2.*theta2.*theta5, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.^2.*theta6, tdot1.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.^2.*theta5, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot2.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta2.*theta6, tdot3.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta3.*theta5, tdot6.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta6 + 2.*tdot2.*theta1.^2.*theta2.*theta6, tdot5.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta5 + 2.*tdot3.*theta1.^2.*theta3.*theta5, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.^2.*theta6, tdot1.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.*theta4.^2.*theta5, tdot2.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.^2.*theta5, tdot3.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta3.*theta6, tdot4.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta4.*theta5, tdot6.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta6 + 2.*tdot3.*theta1.^2.*theta3.*theta6, tdot5.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta4.^2.*theta5 + 2.*tdot4.*theta1.^2.*theta4.*theta5, tdot3.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta3.*theta5, tdot5.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta5 + 2.*tdot3.*theta2.^2.*theta3.*theta5, tdot1.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.*theta4.^2.*theta6, tdot2.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.^2.*theta6, tdot2.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.*theta4.^2.*theta5, tdot4.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta4.*theta6, tdot6.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta4.^2.*theta6 + 2.*tdot4.*theta1.^2.*theta4.*theta6, tdot3.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta3.*theta6, tdot4.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta4.*theta5, tdot6.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta6 + 2.*tdot3.*theta2.^2.*theta3.*theta6, tdot5.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta4.^2.*theta5 + 2.*tdot4.*theta2.^2.*theta4.*theta5, tdot1.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta1.*theta5.*theta6.^2 + 2.*tdot6.*theta1.*theta5.^2.*theta6, tdot2.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.*theta4.^2.*theta6, tdot3.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.*theta4.^2.*theta5, tdot5.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta5.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta5.*theta6, tdot6.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta5.^2.*theta6 + 2.*tdot5.*theta1.^2.*theta5.*theta6, tdot4.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta4.*theta6, tdot6.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta4.^2.*theta6 + 2.*tdot4.*theta2.^2.*theta4.*theta6, tdot4.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.^2.*theta4.*theta5, tdot5.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta3.*theta4.^2.*theta5 + 2.*tdot4.*theta3.^2.*theta4.*theta5, tdot2.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta2.*theta5.*theta6.^2 + 2.*tdot6.*theta2.*theta5.^2.*theta6, tdot3.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.*theta4.^2.*theta6, tdot5.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta5.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta5.*theta6, tdot6.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta5.^2.*theta6 + 2.*tdot5.*theta2.^2.*theta5.*theta6, tdot4.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta4.*theta6, tdot6.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta3.*theta4.^2.*theta6 + 2.*tdot4.*theta3.^2.*theta4.*theta6, tdot3.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta3.*theta5.*theta6.^2 + 2.*tdot6.*theta3.*theta5.^2.*theta6, tdot5.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta3.*theta5.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta5.*theta6, tdot6.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta3.*theta5.^2.*theta6 + 2.*tdot5.*theta3.^2.*theta5.*theta6, tdot4.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta4.*theta5.*theta6.^2 + 2.*tdot6.*theta4.*theta5.^2.*theta6, tdot5.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta4.*theta5.*theta6.^2 + 2.*tdot6.*theta4.^2.*theta5.*theta6, tdot6.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta4.*theta5.^2.*theta6 + 2.*tdot5.*theta4.^2.*theta5.*theta6, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta2.*theta5 + tdot2.*theta1.*theta5 + tdot5.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot1.*theta2.*theta6 + tdot2.*theta1.*theta6 + tdot6.*theta1.*theta2, tdot1.*theta3.*theta5 + tdot3.*theta1.*theta5 + tdot5.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta3.*theta6 + tdot3.*theta1.*theta6 + tdot6.*theta1.*theta3, tdot1.*theta4.*theta5 + tdot4.*theta1.*theta5 + tdot5.*theta1.*theta4, tdot2.*theta3.*theta5 + tdot3.*theta2.*theta5 + tdot5.*theta2.*theta3, tdot1.*theta4.*theta6 + tdot4.*theta1.*theta6 + tdot6.*theta1.*theta4, tdot2.*theta3.*theta6 + tdot3.*theta2.*theta6 + tdot6.*theta2.*theta3, tdot2.*theta4.*theta5 + tdot4.*theta2.*theta5 + tdot5.*theta2.*theta4, tdot1.*theta5.*theta6 + tdot5.*theta1.*theta6 + tdot6.*theta1.*theta5, tdot2.*theta4.*theta6 + tdot4.*theta2.*theta6 + tdot6.*theta2.*theta4, tdot3.*theta4.*theta5 + tdot4.*theta3.*theta5 + tdot5.*theta3.*theta4, tdot2.*theta5.*theta6 + tdot5.*theta2.*theta6 + tdot6.*theta2.*theta5, tdot3.*theta4.*theta6 + tdot4.*theta3.*theta6 + tdot6.*theta3.*theta4, tdot3.*theta5.*theta6 + tdot5.*theta3.*theta6 + tdot6.*theta3.*theta5, tdot4.*theta5.*theta6 + tdot5.*theta4.*theta6 + tdot6.*theta4.*theta5, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta5 + tdot2.*theta1.*theta3.*theta5 + tdot3.*theta1.*theta2.*theta5 + tdot5.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta6 + tdot2.*theta1.*theta3.*theta6 + tdot3.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta3, tdot1.*theta2.*theta4.*theta5 + tdot2.*theta1.*theta4.*theta5 + tdot4.*theta1.*theta2.*theta5 + tdot5.*theta1.*theta2.*theta4, tdot1.*theta2.*theta4.*theta6 + tdot2.*theta1.*theta4.*theta6 + tdot4.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta4, tdot1.*theta3.*theta4.*theta5 + tdot3.*theta1.*theta4.*theta5 + tdot4.*theta1.*theta3.*theta5 + tdot5.*theta1.*theta3.*theta4, tdot1.*theta2.*theta5.*theta6 + tdot2.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta5, tdot1.*theta3.*theta4.*theta6 + tdot3.*theta1.*theta4.*theta6 + tdot4.*theta1.*theta3.*theta6 + tdot6.*theta1.*theta3.*theta4, tdot2.*theta3.*theta4.*theta5 + tdot3.*theta2.*theta4.*theta5 + tdot4.*theta2.*theta3.*theta5 + tdot5.*theta2.*theta3.*theta4, tdot1.*theta3.*theta5.*theta6 + tdot3.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta3.*theta6 + tdot6.*theta1.*theta3.*theta5, tdot2.*theta3.*theta4.*theta6 + tdot3.*theta2.*theta4.*theta6 + tdot4.*theta2.*theta3.*theta6 + tdot6.*theta2.*theta3.*theta4, tdot1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta4.*theta6 + tdot6.*theta1.*theta4.*theta5, tdot2.*theta3.*theta5.*theta6 + tdot3.*theta2.*theta5.*theta6 + tdot5.*theta2.*theta3.*theta6 + tdot6.*theta2.*theta3.*theta5, tdot2.*theta4.*theta5.*theta6 + tdot4.*theta2.*theta5.*theta6 + tdot5.*theta2.*theta4.*theta6 + tdot6.*theta2.*theta4.*theta5, tdot3.*theta4.*theta5.*theta6 + tdot4.*theta3.*theta5.*theta6 + tdot5.*theta3.*theta4.*theta6 + tdot6.*theta3.*theta4.*theta5, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta5.^2 + tdot2.*theta1.*theta3.*theta5.^2 + tdot3.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta3.^2.*theta5 + tdot2.*theta1.*theta3.^2.*theta5 + tdot5.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.^2.*theta3.*theta5 + tdot3.*theta1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta5, tdot2.*theta1.^2.*theta3.*theta5 + tdot3.*theta1.^2.*theta2.*theta5 + tdot5.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta3.*theta6.^2 + tdot2.*theta1.*theta3.*theta6.^2 + tdot3.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.*theta4.*theta5.^2 + tdot2.*theta1.*theta4.*theta5.^2 + tdot4.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.*theta3.^2.*theta6 + tdot2.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.*theta4.^2.*theta5 + tdot2.*theta1.*theta4.^2.*theta5 + tdot5.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.^2.*theta3.*theta6 + tdot3.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.^2.*theta4.*theta5 + tdot4.*theta1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.*theta2.*theta4.*theta5, tdot2.*theta1.^2.*theta3.*theta6 + tdot3.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta6, tdot2.*theta1.^2.*theta4.*theta5 + tdot4.*theta1.^2.*theta2.*theta5 + tdot5.*theta1.^2.*theta2.*theta4 + 2.*tdot1.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.*theta4.*theta6.^2 + tdot2.*theta1.*theta4.*theta6.^2 + tdot4.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta4.*theta6, tdot1.*theta2.*theta4.^2.*theta6 + tdot2.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4.*theta6, tdot1.*theta3.*theta4.*theta5.^2 + tdot3.*theta1.*theta4.*theta5.^2 + tdot4.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta4.*theta5, tdot1.*theta3.*theta4.^2.*theta5 + tdot3.*theta1.*theta4.^2.*theta5 + tdot5.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4.*theta5, tdot1.*theta2.^2.*theta4.*theta6 + tdot4.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.*theta2.*theta4.*theta6, tdot1.*theta3.^2.*theta4.*theta5 + tdot4.*theta1.*theta3.^2.*theta5 + tdot5.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.*theta3.*theta4.*theta5, tdot2.*theta1.^2.*theta4.*theta6 + tdot4.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta4 + 2.*tdot1.*theta1.*theta2.*theta4.*theta6, tdot3.*theta1.^2.*theta4.*theta5 + tdot4.*theta1.^2.*theta3.*theta5 + tdot5.*theta1.^2.*theta3.*theta4 + 2.*tdot1.*theta1.*theta3.*theta4.*theta5, tdot1.*theta2.*theta5.*theta6.^2 + tdot2.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta5.*theta6, tdot1.*theta2.*theta5.^2.*theta6 + tdot2.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta5.*theta6, tdot1.*theta3.*theta4.*theta6.^2 + tdot3.*theta1.*theta4.*theta6.^2 + tdot4.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta4.*theta6, tdot1.*theta3.*theta4.^2.*theta6 + tdot3.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4.*theta6, tdot1.*theta2.^2.*theta5.*theta6 + tdot5.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta5 + 2.*tdot2.*theta1.*theta2.*theta5.*theta6, tdot1.*theta3.^2.*theta4.*theta6 + tdot4.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.*theta3.*theta4.*theta6, tdot2.*theta3.*theta4.*theta5.^2 + tdot3.*theta2.*theta4.*theta5.^2 + tdot4.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta4.*theta5, tdot2.*theta3.*theta4.^2.*theta5 + tdot3.*theta2.*theta4.^2.*theta5 + tdot5.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4.*theta5, tdot2.*theta3.^2.*theta4.*theta5 + tdot4.*theta2.*theta3.^2.*theta5 + tdot5.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.*theta3.*theta4.*theta5, tdot2.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta5 + 2.*tdot1.*theta1.*theta2.*theta5.*theta6, tdot3.*theta1.^2.*theta4.*theta6 + tdot4.*theta1.^2.*theta3.*theta6 + tdot6.*theta1.^2.*theta3.*theta4 + 2.*tdot1.*theta1.*theta3.*theta4.*theta6, tdot3.*theta2.^2.*theta4.*theta5 + tdot4.*theta2.^2.*theta3.*theta5 + tdot5.*theta2.^2.*theta3.*theta4 + 2.*tdot2.*theta2.*theta3.*theta4.*theta5, tdot1.*theta3.*theta5.*theta6.^2 + tdot3.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta5.*theta6, tdot1.*theta3.*theta5.^2.*theta6 + tdot3.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta5.*theta6, tdot1.*theta3.^2.*theta5.*theta6 + tdot5.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2.*theta5 + 2.*tdot3.*theta1.*theta3.*theta5.*theta6, tdot2.*theta3.*theta4.*theta6.^2 + tdot3.*theta2.*theta4.*theta6.^2 + tdot4.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta4.*theta6, tdot2.*theta3.*theta4.^2.*theta6 + tdot3.*theta2.*theta4.^2.*theta6 + tdot6.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4.*theta6, tdot2.*theta3.^2.*theta4.*theta6 + tdot4.*theta2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.*theta3.*theta4.*theta6, tdot3.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta3.*theta6 + tdot6.*theta1.^2.*theta3.*theta5 + 2.*tdot1.*theta1.*theta3.*theta5.*theta6, tdot3.*theta2.^2.*theta4.*theta6 + tdot4.*theta2.^2.*theta3.*theta6 + tdot6.*theta2.^2.*theta3.*theta4 + 2.*tdot2.*theta2.*theta3.*theta4.*theta6, tdot1.*theta4.*theta5.*theta6.^2 + tdot4.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.*theta4.*theta5.*theta6, tdot1.*theta4.*theta5.^2.*theta6 + tdot4.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.*theta4.*theta5.*theta6, tdot1.*theta4.^2.*theta5.*theta6 + tdot5.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta4.^2.*theta5 + 2.*tdot4.*theta1.*theta4.*theta5.*theta6, tdot2.*theta3.*theta5.*theta6.^2 + tdot3.*theta2.*theta5.*theta6.^2 + tdot5.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta5.*theta6, tdot2.*theta3.*theta5.^2.*theta6 + tdot3.*theta2.*theta5.^2.*theta6 + tdot6.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta5.*theta6, tdot2.*theta3.^2.*theta5.*theta6 + tdot5.*theta2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2.*theta5 + 2.*tdot3.*theta2.*theta3.*theta5.*theta6, tdot4.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta4.*theta6 + tdot6.*theta1.^2.*theta4.*theta5 + 2.*tdot1.*theta1.*theta4.*theta5.*theta6, tdot3.*theta2.^2.*theta5.*theta6 + tdot5.*theta2.^2.*theta3.*theta6 + tdot6.*theta2.^2.*theta3.*theta5 + 2.*tdot2.*theta2.*theta3.*theta5.*theta6, tdot2.*theta4.*theta5.*theta6.^2 + tdot4.*theta2.*theta5.*theta6.^2 + tdot5.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.*theta4.*theta5.*theta6, tdot2.*theta4.*theta5.^2.*theta6 + tdot4.*theta2.*theta5.^2.*theta6 + tdot6.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.*theta4.*theta5.*theta6, tdot2.*theta4.^2.*theta5.*theta6 + tdot5.*theta2.*theta4.^2.*theta6 + tdot6.*theta2.*theta4.^2.*theta5 + 2.*tdot4.*theta2.*theta4.*theta5.*theta6, tdot4.*theta2.^2.*theta5.*theta6 + tdot5.*theta2.^2.*theta4.*theta6 + tdot6.*theta2.^2.*theta4.*theta5 + 2.*tdot2.*theta2.*theta4.*theta5.*theta6, tdot3.*theta4.*theta5.*theta6.^2 + tdot4.*theta3.*theta5.*theta6.^2 + tdot5.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.*theta4.*theta5.*theta6, tdot3.*theta4.*theta5.^2.*theta6 + tdot4.*theta3.*theta5.^2.*theta6 + tdot6.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.*theta4.*theta5.*theta6, tdot3.*theta4.^2.*theta5.*theta6 + tdot5.*theta3.*theta4.^2.*theta6 + tdot6.*theta3.*theta4.^2.*theta5 + 2.*tdot4.*theta3.*theta4.*theta5.*theta6, tdot4.*theta3.^2.*theta5.*theta6 + tdot5.*theta3.^2.*theta4.*theta6 + tdot6.*theta3.^2.*theta4.*theta5 + 2.*tdot3.*theta3.*theta4.*theta5.*theta6, tdot1.*theta2.*theta3.*theta4.*theta5 + tdot2.*theta1.*theta3.*theta4.*theta5 + tdot3.*theta1.*theta2.*theta4.*theta5 + tdot4.*theta1.*theta2.*theta3.*theta5 + tdot5.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta4.*theta6 + tdot2.*theta1.*theta3.*theta4.*theta6 + tdot3.*theta1.*theta2.*theta4.*theta6 + tdot4.*theta1.*theta2.*theta3.*theta6 + tdot6.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta5.*theta6 + tdot2.*theta1.*theta3.*theta5.*theta6 + tdot3.*theta1.*theta2.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta3.*theta6 + tdot6.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta4.*theta5.*theta6 + tdot2.*theta1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta2.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta4.*theta6 + tdot6.*theta1.*theta2.*theta4.*theta5, tdot1.*theta3.*theta4.*theta5.*theta6 + tdot3.*theta1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta3.*theta5.*theta6 + tdot5.*theta1.*theta3.*theta4.*theta6 + tdot6.*theta1.*theta3.*theta4.*theta5, tdot2.*theta3.*theta4.*theta5.*theta6 + tdot3.*theta2.*theta4.*theta5.*theta6 + tdot4.*theta2.*theta3.*theta5.*theta6 + tdot5.*theta2.*theta3.*theta4.*theta6 + tdot6.*theta2.*theta3.*theta4.*theta5, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -2.*theta1.*theta5.^2, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.^3, -2.*theta1.*theta6.^2, -3.*theta1.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6.^3, -3.*theta1.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta5, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, -3.*theta1.^2.*theta5, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6, zeroCol, -4.*theta1.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta2.*theta5.^2, -theta3.*theta4.^2, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta2.*theta5, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta2.*theta5.^3, -theta2.*theta6.^2, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^2.*theta6, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -2.*theta1.*theta3.*theta5, -3.*theta1.^2.*theta2.*theta5, -3.*theta1.^2.*theta3.*theta4, zeroCol, -theta2.*theta6.^3, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -2.*theta1.*theta4.*theta5, -3.*theta1.^2.*theta2.*theta6, -3.*theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.^2.*theta3.*theta6, -3.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6, -3.*theta1.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta2.^2.*theta5.^2, -theta3.^2.*theta4.^2, -2.*theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta2.^2.*theta5, -2.*theta1.*theta3.^2.*theta4, -theta2.^2.*theta6.^2, -theta3.^2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta6.^2, -2.*theta1.*theta3.*theta5.^2, -2.*theta1.*theta2.^2.*theta6, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, -2.*theta1.*theta3.*theta6.^2, -2.*theta1.*theta4.*theta5.^2, -2.*theta1.*theta3.^2.*theta6, -2.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6.^2, -2.*theta1.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta2.*theta5, -theta3.*theta4, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta5, -theta2.*theta3.*theta6, -theta2.*theta4.*theta5, -theta2.*theta4.*theta6, -theta3.*theta4.*theta5, -theta2.*theta5.*theta6, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta2.*theta3.*theta6.^2, -theta2.*theta4.*theta5.^2, -theta2.*theta3.^2.*theta6, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta3.*theta6, -theta2.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta6, -theta3.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta4.*theta6, -2.*theta1.*theta3.*theta4.*theta5, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta2.^2.*theta5.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.*theta6, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.^3, -2.*theta2.*theta5.^2, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.^3, -2.*theta2.*theta6.^2, -3.*theta2.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6.^3, -3.*theta2.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, -3.*theta2.^2.*theta5, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6, zeroCol, -4.*theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta5, -3.*theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -3.*theta1.*theta2.^2.*theta5, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -2.*theta2.*theta3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -2.*theta2.*theta3.*theta5, -3.*theta2.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, -2.*theta2.*theta4.*theta5, -3.*theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.^2.*theta3.*theta6, -3.*theta2.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta2.^2.*theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, -2.*theta1.*theta2.*theta5.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -2.*theta1.*theta2.*theta6.^2, zeroCol, -theta3.^2.*theta4.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, -theta3.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.^2.*theta5, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6.^2, -2.*theta2.*theta4.*theta5.^2, -2.*theta2.*theta3.^2.*theta6, -2.*theta2.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.^2.*theta6, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6.^2, -2.*theta2.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3, -theta1.*theta4, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta3.*theta4, zeroCol, zeroCol, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta3.*theta5, -theta1.*theta3.*theta6, -theta1.*theta4.*theta5, -theta1.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5, zeroCol, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, -theta4.*theta5.*theta6, zeroCol, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta1.^2.*theta3.*theta5, -theta1.*theta3.*theta6.^2, -theta1.*theta4.*theta5.^2, -theta1.*theta3.^2.*theta6, -theta1.*theta4.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta1.^2.*theta3.*theta6, -theta1.^2.*theta4.*theta5, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, zeroCol, -theta1.^2.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, -theta1.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta5.*theta6, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta2.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta5.*theta6, -theta1.*theta4.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.*theta6, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^3, -2.*theta3.*theta5.^2, -3.*theta3.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta5.^3, -2.*theta3.*theta6.^2, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.*theta6.^3, -3.*theta3.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, -theta2, zeroCol, zeroCol, zeroCol, zeroCol, -theta4, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta3.^3, zeroCol, zeroCol, -theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, -3.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -3.*theta3.^2.*theta5, zeroCol, -4.*theta3.^3.*theta4, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta6, zeroCol, -4.*theta3.^3.*theta5, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, -4.*theta3.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta2.^2.*theta4, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -3.*theta1.*theta3.^2.*theta5, zeroCol, -theta2.*theta4.^3, -theta2.*theta5.^2, -2.*theta2.*theta3.*theta5, -3.*theta2.*theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, -3.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta6, -3.*theta2.*theta3.^2.*theta5, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2.*theta6, zeroCol, zeroCol, -theta4.*theta5.^2, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta6, zeroCol, -2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6, -3.*theta3.^2.*theta4.*theta5, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, -2.*theta3.*theta5.*theta6, -3.*theta3.^2.*theta4.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta3.*theta5, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta5.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta5.^2, -2.*theta2.^2.*theta3.*theta5, zeroCol, -2.*theta2.*theta3.*theta6.^2, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta6.^2, zeroCol, -2.*theta2.^2.*theta3.*theta6, zeroCol, zeroCol, zeroCol, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta5.^2, -2.*theta3.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.^2.*theta6, -theta5.^2.*theta6.^2, -2.*theta3.*theta5.*theta6.^2, -2.*theta3.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta4, zeroCol, -theta1.*theta5, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta4.*theta5, zeroCol, -theta4.*theta6, -theta5.*theta6, zeroCol, -theta1.*theta2.*theta4, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta4.*theta5, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta4.*theta5, -theta1.*theta5.*theta6, -theta2.*theta4.*theta6, zeroCol, -theta2.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.^2.*theta5, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -theta1.^2.*theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, -2.*theta1.*theta3.*theta4.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta4.*theta5, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta3.*theta5.*theta6, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -2.*theta2.*theta3.*theta4.*theta6, -theta1.^2.*theta5.*theta6, -theta2.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta3.*theta5.*theta6, zeroCol, -theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta1.*theta2.*theta4.*theta5, -theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta5.*theta6, zeroCol, -theta1.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta4.^2, zeroCol, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta4.^2, zeroCol, -2.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5.^2, zeroCol, zeroCol, -2.*theta4.*theta5.^3, -2.*theta4.*theta6.^2, -3.*theta4.^2.*theta5.^2, -2.*theta4.*theta6.^3, -3.*theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, zeroCol, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, zeroCol, zeroCol, -3.*theta2.*theta4.^2, zeroCol, -2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta4.^3, zeroCol, zeroCol, -3.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, zeroCol, zeroCol, zeroCol, -4.*theta3.*theta4.^3, zeroCol, zeroCol, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5, -theta3.^4, zeroCol, zeroCol, zeroCol, -theta5.^3, -theta6.^2, zeroCol, zeroCol, -2.*theta4.*theta6, zeroCol, -3.*theta4.^2.*theta5, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, -3.*theta4.^2.*theta6, zeroCol, -4.*theta4.^3.*theta5, -theta6.^4, zeroCol, -4.*theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, zeroCol, -4.*theta4.^3, zeroCol, zeroCol, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, -3.*theta1.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5, -3.*theta2.*theta3.*theta4.^2, zeroCol, zeroCol, -theta2.*theta3.^3, zeroCol, -theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta3, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta4.*theta5, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -theta2.^2.*theta5, zeroCol, -theta1.*theta6.^3, zeroCol, -3.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.*theta4.^2.*theta5, -theta3.*theta5.^2, -2.*theta3.*theta4.*theta5, zeroCol, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, -theta3.^2.*theta5, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, -3.*theta2.*theta4.^2.*theta6, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -2.*theta3.*theta4.*theta6, -3.*theta3.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, zeroCol, -3.*theta3.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.^3.*theta6, zeroCol, zeroCol, -theta5.*theta6.^2, -theta5.^2.*theta6, zeroCol, -2.*theta4.*theta5.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, -3.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, zeroCol, -2.*theta1.*theta3.^2.*theta4, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta5.^2, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta4.*theta6, zeroCol, -theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta4.*theta6, -theta3.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta5, zeroCol, -2.*theta3.*theta4.*theta6.^2, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, -2.*theta4.*theta5.*theta6.^2, -2.*theta4.*theta5.^2.*theta6, zeroCol, -theta1.*theta2, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta2.*theta3, zeroCol, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, zeroCol, -theta5.*theta6, -theta1.*theta2.*theta3, zeroCol, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, -theta1.*theta3.*theta5, zeroCol, -theta1.*theta3.*theta6, -theta2.*theta3.*theta5, zeroCol, -theta2.*theta3.*theta6, -theta1.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6, -theta3.*theta5.*theta6, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.^2.*theta5, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta2.^2.*theta6, -theta1.*theta3.^2.*theta5, -theta1.^2.*theta2.*theta6, -theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta1.*theta3.^2.*theta6, -theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.^2.*theta5, zeroCol, -theta1.^2.*theta3.*theta6, -theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.^2.*theta6, zeroCol, -theta2.^2.*theta3.*theta6, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta4.*theta5.*theta6, -theta2.^2.*theta5.*theta6, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta3.^2.*theta5.*theta6, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta5.*theta6, -theta1.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.*theta6, zeroCol,];
        R5= [ zeroCol, zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^3.*theta5, zeroCol, -2.*theta2.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^3.*theta5, zeroCol, -2.*theta3.^2.*theta5, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.^3.*theta5, -2.*theta4.^2.*theta5, zeroCol, zeroCol, -3.*theta4.^2.*theta5.^2, zeroCol, -2.*theta4.^3.*theta5, zeroCol, zeroCol, -2.*theta5.*theta6.^2, -2.*theta5.*theta6.^3, -3.*theta5.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta5.^3, zeroCol, zeroCol, -3.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta5.^3, zeroCol, zeroCol, -3.*theta3.*theta5.^2, zeroCol, -2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta5.^3, zeroCol, -3.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, zeroCol, -4.*theta4.*theta5.^3, zeroCol, -theta6.^2, zeroCol, zeroCol, -2.*theta5.*theta6, -theta4.^4, zeroCol, -theta6.^3, zeroCol, -3.*theta5.^2.*theta6, -theta6.^4, -4.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta5, zeroCol, zeroCol, -3.*theta5.^2, zeroCol, zeroCol, -4.*theta5.^3, zeroCol, -5.*theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, -3.*theta1.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta5.^2, zeroCol, -2.*theta1.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, -2.*theta2.*theta3.*theta5, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -3.*theta2.*theta3.*theta5.^2, zeroCol, -2.*theta2.*theta4.*theta5, zeroCol, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta5.*theta6, zeroCol, -3.*theta2.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta2.*theta4.^3, -2.*theta3.*theta4.*theta5, -theta3.*theta4.^2, -theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta4, -theta3.^2.*theta4, -theta1.*theta6.^3, -3.*theta1.*theta5.^2.*theta6, zeroCol, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta3.*theta4.^3, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, zeroCol, -theta3.^3.*theta4, -theta2.*theta6.^3, -3.*theta2.*theta5.^2.*theta6, zeroCol, -theta3.*theta6.^2, zeroCol, -2.*theta3.*theta5.*theta6, -theta2.^3.*theta6, -theta3.^2.*theta6, zeroCol, -theta3.*theta6.^3, -3.*theta3.*theta5.^2.*theta6, -theta4.*theta6.^2, -2.*theta4.*theta5.*theta6, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.*theta6.^3, -3.*theta4.*theta5.^2.*theta6, -theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta5, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta5, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.^2.*theta5, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta5, -theta2.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -theta2.^2.*theta4.^2, -2.*theta1.*theta5.*theta6.^2, zeroCol, -2.*theta3.*theta4.^2.*theta5, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.^2.*theta4.*theta5, -theta3.^2.*theta4.^2, -2.*theta2.*theta5.*theta6.^2, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.*theta5.*theta6.^2, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta5.*theta6, -2.*theta4.*theta5.*theta6.^2, -theta4.^2.*theta6.^2, -2.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, zeroCol, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta3.*theta4, -theta2.*theta6, zeroCol, -theta3.*theta6, -theta4.*theta6, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta2.*theta6, zeroCol, -theta2.*theta3.*theta4, -theta1.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta3.*theta6, -theta2.*theta4.*theta6, -theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta4.^2, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.^2, zeroCol, -theta1.*theta3.^2.*theta4, zeroCol, -theta1.^2.*theta3.*theta4, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta2.*theta6, zeroCol, -theta2.^2.*theta3.*theta4, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.^2.*theta6, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.^2.*theta6, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta3.*theta6, -theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.^2.*theta6, -theta2.^2.*theta4.*theta6, -theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, -theta1.*theta2.*theta3.*theta4, zeroCol, -theta1.*theta2.*theta3.*theta6, -theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.*theta6, zeroCol,];
        R6= [ zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6.^2, -2.*theta1.^3.*theta6, zeroCol, -2.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6.^2, -2.*theta2.^3.*theta6, zeroCol, -2.*theta3.^2.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta6.^2, -2.*theta3.^3.*theta6, zeroCol, -2.*theta4.^2.*theta6, zeroCol, -3.*theta4.^2.*theta6.^2, -2.*theta4.^3.*theta6, -2.*theta5.^2.*theta6, -3.*theta5.^2.*theta6.^2, -2.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, -theta3, zeroCol, -theta4, -theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta6.^3, zeroCol, -3.*theta2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta6.^3, zeroCol, -3.*theta3.*theta6.^2, zeroCol, -2.*theta4.*theta6, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta6.^3, zeroCol, -3.*theta4.*theta6.^2, -2.*theta5.*theta6, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, -4.*theta4.*theta6.^3, -3.*theta5.*theta6.^2, -theta4.^4, -theta5.^3, -4.*theta5.*theta6.^3, -theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta6, zeroCol, zeroCol, -3.*theta6.^2, zeroCol, -4.*theta6.^3, -5.*theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta3.*theta6, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, zeroCol, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, -theta1.^3.*theta3, zeroCol, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta5.*theta6, -theta1.*theta4.^3, -theta1.*theta5.^2, -3.*theta2.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, zeroCol, -3.*theta1.*theta5.*theta6.^2, -theta1.*theta5.^3, -3.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta5.*theta6, -theta2.*theta4.^3, -theta2.*theta5.^2, zeroCol, -2.*theta3.*theta4.*theta6, -theta3.*theta4.^2, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, zeroCol, -3.*theta2.*theta5.*theta6.^2, -theta2.*theta5.^3, -3.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta5.*theta6, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, -3.*theta3.*theta5.*theta6.^2, -theta3.*theta5.^3, -2.*theta4.*theta5.*theta6, -theta4.*theta5.^2, -theta3.^3.*theta5, -theta4.^2.*theta5, -3.*theta4.*theta5.*theta6.^2, -theta4.*theta5.^3, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta6, -2.*theta2.*theta3.^2.*theta6, zeroCol, -2.*theta1.^2.*theta4.*theta6, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta5.^2.*theta6, -2.*theta2.*theta4.^2.*theta6, zeroCol, -2.*theta1.^2.*theta5.*theta6, -theta1.^2.*theta5.^2, -2.*theta2.^2.*theta4.*theta6, -theta2.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta5.^2.*theta6, -2.*theta3.*theta4.^2.*theta6, -2.*theta2.^2.*theta5.*theta6, -theta2.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta6, -theta3.^2.*theta4.^2, -2.*theta3.*theta5.^2.*theta6, -2.*theta3.^2.*theta5.*theta6, -theta3.^2.*theta5.^2, -2.*theta4.*theta5.^2.*theta6, -2.*theta4.^2.*theta5.*theta6, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, -theta1.*theta5, -theta2.*theta4, zeroCol, -theta2.*theta5, -theta3.*theta4, -theta3.*theta5, -theta4.*theta5, zeroCol, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta3.*theta4, zeroCol, -theta1.*theta3.*theta5, -theta2.*theta3.*theta4, -theta1.*theta4.*theta5, -theta2.*theta3.*theta5, -theta2.*theta4.*theta5, -theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta3.^2, zeroCol, -theta1.*theta2.^2.*theta3, zeroCol, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta4.^2, zeroCol, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta4.^2, -theta1.*theta2.^2.*theta5, -theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta3.*theta5, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta1.^2.*theta4.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta5, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta4.*theta5, -theta1.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta5, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;R5;R6;];
    case 107
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
            theta5=DOF(:, 5);
            tdot5=DOFVel(:, 5);
            theta6=DOF(:, 6);
            tdot6=DOFVel(:, 6);
        LMT = [ theta1, theta2, theta3, theta4, theta5, theta6, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^2.*theta5.^2, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta1.^2.*theta5.^3, theta1.^2.*theta6.^2, theta1.^3.*theta5.^2, theta2.^2.*theta4.^3, theta2.^2.*theta5.^2, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta1.^2.*theta6.^3, theta1.^3.*theta6.^2, theta2.^2.*theta5.^3, theta2.^2.*theta6.^2, theta2.^3.*theta5.^2, theta3.^2.*theta4.^3, theta3.^2.*theta5.^2, theta3.^3.*theta4.^2, theta2.^2.*theta6.^3, theta2.^3.*theta6.^2, theta3.^2.*theta5.^3, theta3.^2.*theta6.^2, theta3.^3.*theta5.^2, theta4.^2.*theta5.^2, theta3.^2.*theta6.^3, theta3.^3.*theta6.^2, theta4.^2.*theta5.^3, theta4.^2.*theta6.^2, theta4.^3.*theta5.^2, theta4.^2.*theta6.^3, theta4.^3.*theta6.^2, theta5.^2.*theta6.^2, theta5.^2.*theta6.^3, theta5.^3.*theta6.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta1.*theta5, theta2.*theta4, theta1.*theta6, theta2.*theta5, theta3.*theta4, theta2.*theta6, theta3.*theta5, theta3.*theta6, theta4.*theta5, theta4.*theta6, theta5.*theta6, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta1.*theta5.^2, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^2.*theta5, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta1.*theta5.^3, theta1.*theta6.^2, theta2.*theta3.^4, theta2.*theta4.^3, theta2.*theta5.^2, theta3.*theta4.^2, theta1.^2.*theta6, theta1.^3.*theta5, theta2.^2.*theta5, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta1.*theta5.^4, theta1.*theta6.^3, theta2.*theta4.^4, theta2.*theta5.^3, theta2.*theta6.^2, theta3.*theta4.^3, theta3.*theta5.^2, theta1.^3.*theta6, theta2.^2.*theta6, theta1.^4.*theta5, theta2.^3.*theta5, theta3.^2.*theta5, theta2.^4.*theta4, theta3.^3.*theta4, theta1.*theta6.^4, theta2.*theta5.^4, theta2.*theta6.^3, theta3.*theta4.^4, theta3.*theta5.^3, theta3.*theta6.^2, theta4.*theta5.^2, theta1.^4.*theta6, theta2.^3.*theta6, theta3.^2.*theta6, theta2.^4.*theta5, theta3.^3.*theta5, theta4.^2.*theta5, theta3.^4.*theta4, theta2.*theta6.^4, theta3.*theta5.^4, theta3.*theta6.^3, theta4.*theta5.^3, theta4.*theta6.^2, theta2.^4.*theta6, theta3.^3.*theta6, theta4.^2.*theta6, theta3.^4.*theta5, theta4.^3.*theta5, theta3.*theta6.^4, theta4.*theta5.^4, theta4.*theta6.^3, theta5.*theta6.^2, theta3.^4.*theta6, theta4.^3.*theta6, theta5.^2.*theta6, theta4.^4.*theta5, theta4.*theta6.^4, theta5.*theta6.^3, theta4.^4.*theta6, theta5.^3.*theta6, theta5.*theta6.^4, theta5.^4.*theta6, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta5.^2, theta3.^5, theta4.^4, theta5.^3, theta6.^2, theta4.^5, theta5.^4, theta6.^3, theta5.^5, theta6.^4, theta6.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta2.*theta5.^2, theta1.*theta3.*theta4.^2, theta1.*theta2.^2.*theta5, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta2.*theta5, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta2.*theta5.^3, theta1.*theta2.*theta6.^2, theta1.*theta3.*theta4.^3, theta1.*theta3.*theta5.^2, theta1.*theta2.^2.*theta6, theta1.*theta2.^3.*theta5, theta1.*theta3.^2.*theta5, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^2.*theta2.*theta6, theta1.^2.*theta3.*theta5, theta1.^3.*theta2.*theta5, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta1.*theta2.*theta6.^3, theta1.*theta3.*theta5.^3, theta1.*theta3.*theta6.^2, theta1.*theta4.*theta5.^2, theta1.*theta2.^3.*theta6, theta1.*theta3.^2.*theta6, theta1.*theta3.^3.*theta5, theta1.*theta4.^2.*theta5, theta2.*theta3.*theta4.^3, theta2.*theta3.*theta5.^2, theta2.*theta3.^2.*theta5, theta2.*theta3.^3.*theta4, theta1.^2.*theta3.*theta6, theta1.^2.*theta4.*theta5, theta1.^3.*theta2.*theta6, theta1.^3.*theta3.*theta5, theta2.^2.*theta3.*theta5, theta2.^3.*theta3.*theta4, theta1.*theta3.*theta6.^3, theta1.*theta4.*theta5.^3, theta1.*theta4.*theta6.^2, theta1.*theta3.^3.*theta6, theta1.*theta4.^2.*theta6, theta1.*theta4.^3.*theta5, theta2.*theta3.*theta5.^3, theta2.*theta3.*theta6.^2, theta2.*theta4.*theta5.^2, theta2.*theta3.^2.*theta6, theta2.*theta3.^3.*theta5, theta2.*theta4.^2.*theta5, theta1.^2.*theta4.*theta6, theta1.^3.*theta3.*theta6, theta1.^3.*theta4.*theta5, theta2.^2.*theta3.*theta6, theta2.^2.*theta4.*theta5, theta2.^3.*theta3.*theta5, theta1.*theta4.*theta6.^3, theta1.*theta5.*theta6.^2, theta1.*theta4.^3.*theta6, theta1.*theta5.^2.*theta6, theta2.*theta3.*theta6.^3, theta2.*theta4.*theta5.^3, theta2.*theta4.*theta6.^2, theta2.*theta3.^3.*theta6, theta2.*theta4.^2.*theta6, theta2.*theta4.^3.*theta5, theta3.*theta4.*theta5.^2, theta3.*theta4.^2.*theta5, theta1.^2.*theta5.*theta6, theta1.^3.*theta4.*theta6, theta2.^2.*theta4.*theta6, theta2.^3.*theta3.*theta6, theta2.^3.*theta4.*theta5, theta3.^2.*theta4.*theta5, theta1.*theta5.*theta6.^3, theta1.*theta5.^3.*theta6, theta2.*theta4.*theta6.^3, theta2.*theta5.*theta6.^2, theta2.*theta4.^3.*theta6, theta2.*theta5.^2.*theta6, theta3.*theta4.*theta5.^3, theta3.*theta4.*theta6.^2, theta3.*theta4.^2.*theta6, theta3.*theta4.^3.*theta5, theta1.^3.*theta5.*theta6, theta2.^2.*theta5.*theta6, theta2.^3.*theta4.*theta6, theta3.^2.*theta4.*theta6, theta3.^3.*theta4.*theta5, theta2.*theta5.*theta6.^3, theta2.*theta5.^3.*theta6, theta3.*theta4.*theta6.^3, theta3.*theta5.*theta6.^2, theta3.*theta4.^3.*theta6, theta3.*theta5.^2.*theta6, theta2.^3.*theta5.*theta6, theta3.^2.*theta5.*theta6, theta3.^3.*theta4.*theta6, theta3.*theta5.*theta6.^3, theta3.*theta5.^3.*theta6, theta4.*theta5.*theta6.^2, theta4.*theta5.^2.*theta6, theta3.^3.*theta5.*theta6, theta4.^2.*theta5.*theta6, theta4.*theta5.*theta6.^3, theta4.*theta5.^3.*theta6, theta4.^3.*theta5.*theta6, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta2.^2.*theta5.^2, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta5.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta2.^2.*theta5, theta1.^2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta6.^2, theta1.*theta3.^2.*theta5.^2, theta2.*theta3.^2.*theta4.^2, theta1.^2.*theta2.*theta6.^2, theta1.^2.*theta3.*theta5.^2, theta1.^2.*theta2.^2.*theta6, theta1.^2.*theta3.^2.*theta5, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta3.^2.*theta6.^2, theta1.*theta4.^2.*theta5.^2, theta2.*theta3.^2.*theta5.^2, theta1.^2.*theta3.*theta6.^2, theta1.^2.*theta4.*theta5.^2, theta1.^2.*theta3.^2.*theta6, theta1.^2.*theta4.^2.*theta5, theta2.^2.*theta3.*theta5.^2, theta2.^2.*theta3.^2.*theta5, theta1.*theta4.^2.*theta6.^2, theta2.*theta3.^2.*theta6.^2, theta2.*theta4.^2.*theta5.^2, theta1.^2.*theta4.*theta6.^2, theta1.^2.*theta4.^2.*theta6, theta2.^2.*theta3.*theta6.^2, theta2.^2.*theta4.*theta5.^2, theta2.^2.*theta3.^2.*theta6, theta2.^2.*theta4.^2.*theta5, theta1.*theta5.^2.*theta6.^2, theta2.*theta4.^2.*theta6.^2, theta3.*theta4.^2.*theta5.^2, theta1.^2.*theta5.*theta6.^2, theta1.^2.*theta5.^2.*theta6, theta2.^2.*theta4.*theta6.^2, theta2.^2.*theta4.^2.*theta6, theta3.^2.*theta4.*theta5.^2, theta3.^2.*theta4.^2.*theta5, theta2.*theta5.^2.*theta6.^2, theta3.*theta4.^2.*theta6.^2, theta2.^2.*theta5.*theta6.^2, theta2.^2.*theta5.^2.*theta6, theta3.^2.*theta4.*theta6.^2, theta3.^2.*theta4.^2.*theta6, theta3.*theta5.^2.*theta6.^2, theta3.^2.*theta5.*theta6.^2, theta3.^2.*theta5.^2.*theta6, theta4.*theta5.^2.*theta6.^2, theta4.^2.*theta5.*theta6.^2, theta4.^2.*theta5.^2.*theta6, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta2.*theta5, theta1.*theta3.*theta4, theta1.*theta2.*theta6, theta1.*theta3.*theta5, theta2.*theta3.*theta4, theta1.*theta3.*theta6, theta1.*theta4.*theta5, theta2.*theta3.*theta5, theta1.*theta4.*theta6, theta2.*theta3.*theta6, theta2.*theta4.*theta5, theta1.*theta5.*theta6, theta2.*theta4.*theta6, theta3.*theta4.*theta5, theta2.*theta5.*theta6, theta3.*theta4.*theta6, theta3.*theta5.*theta6, theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6, theta1.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6, theta1.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6, theta1.*theta3.*theta4.*theta6, theta2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6, theta2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6, theta2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta5.^2, theta1.*theta2.*theta3.^2.*theta5, theta1.*theta2.^2.*theta3.*theta5, theta1.^2.*theta2.*theta3.*theta5, theta1.*theta2.*theta3.*theta6.^2, theta1.*theta2.*theta4.*theta5.^2, theta1.*theta2.*theta3.^2.*theta6, theta1.*theta2.*theta4.^2.*theta5, theta1.*theta2.^2.*theta3.*theta6, theta1.*theta2.^2.*theta4.*theta5, theta1.^2.*theta2.*theta3.*theta6, theta1.^2.*theta2.*theta4.*theta5, theta1.*theta2.*theta4.*theta6.^2, theta1.*theta2.*theta4.^2.*theta6, theta1.*theta3.*theta4.*theta5.^2, theta1.*theta3.*theta4.^2.*theta5, theta1.*theta2.^2.*theta4.*theta6, theta1.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta4.*theta6, theta1.^2.*theta3.*theta4.*theta5, theta1.*theta2.*theta5.*theta6.^2, theta1.*theta2.*theta5.^2.*theta6, theta1.*theta3.*theta4.*theta6.^2, theta1.*theta3.*theta4.^2.*theta6, theta1.*theta2.^2.*theta5.*theta6, theta1.*theta3.^2.*theta4.*theta6, theta2.*theta3.*theta4.*theta5.^2, theta2.*theta3.*theta4.^2.*theta5, theta2.*theta3.^2.*theta4.*theta5, theta1.^2.*theta2.*theta5.*theta6, theta1.^2.*theta3.*theta4.*theta6, theta2.^2.*theta3.*theta4.*theta5, theta1.*theta3.*theta5.*theta6.^2, theta1.*theta3.*theta5.^2.*theta6, theta1.*theta3.^2.*theta5.*theta6, theta2.*theta3.*theta4.*theta6.^2, theta2.*theta3.*theta4.^2.*theta6, theta2.*theta3.^2.*theta4.*theta6, theta1.^2.*theta3.*theta5.*theta6, theta2.^2.*theta3.*theta4.*theta6, theta1.*theta4.*theta5.*theta6.^2, theta1.*theta4.*theta5.^2.*theta6, theta1.*theta4.^2.*theta5.*theta6, theta2.*theta3.*theta5.*theta6.^2, theta2.*theta3.*theta5.^2.*theta6, theta2.*theta3.^2.*theta5.*theta6, theta1.^2.*theta4.*theta5.*theta6, theta2.^2.*theta3.*theta5.*theta6, theta2.*theta4.*theta5.*theta6.^2, theta2.*theta4.*theta5.^2.*theta6, theta2.*theta4.^2.*theta5.*theta6, theta2.^2.*theta4.*theta5.*theta6, theta3.*theta4.*theta5.*theta6.^2, theta3.*theta4.*theta5.^2.*theta6, theta3.*theta4.^2.*theta5.*theta6, theta3.^2.*theta4.*theta5.*theta6, theta1.*theta2.*theta3.*theta4.*theta5, theta1.*theta2.*theta3.*theta4.*theta6, theta1.*theta2.*theta3.*theta5.*theta6, theta1.*theta2.*theta4.*theta5.*theta6, theta1.*theta3.*theta4.*theta5.*theta6, theta2.*theta3.*theta4.*theta5.*theta6, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, tdot5, tdot6, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot1.*theta1.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta5, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot1.*theta1.*theta5.^3 + 3.*tdot5.*theta1.^2.*theta5.^2, 2.*tdot1.*theta1.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta6, 2.*tdot5.*theta1.^3.*theta5 + 3.*tdot1.*theta1.^2.*theta5.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot2.*theta2.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta5, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot1.*theta1.*theta6.^3 + 3.*tdot6.*theta1.^2.*theta6.^2, 2.*tdot6.*theta1.^3.*theta6 + 3.*tdot1.*theta1.^2.*theta6.^2, 2.*tdot2.*theta2.*theta5.^3 + 3.*tdot5.*theta2.^2.*theta5.^2, 2.*tdot2.*theta2.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta6, 2.*tdot5.*theta2.^3.*theta5 + 3.*tdot2.*theta2.^2.*theta5.^2, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot3.*theta3.*theta5.^2 + 2.*tdot5.*theta3.^2.*theta5, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, 2.*tdot2.*theta2.*theta6.^3 + 3.*tdot6.*theta2.^2.*theta6.^2, 2.*tdot6.*theta2.^3.*theta6 + 3.*tdot2.*theta2.^2.*theta6.^2, 2.*tdot3.*theta3.*theta5.^3 + 3.*tdot5.*theta3.^2.*theta5.^2, 2.*tdot3.*theta3.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta6, 2.*tdot5.*theta3.^3.*theta5 + 3.*tdot3.*theta3.^2.*theta5.^2, 2.*tdot4.*theta4.*theta5.^2 + 2.*tdot5.*theta4.^2.*theta5, 2.*tdot3.*theta3.*theta6.^3 + 3.*tdot6.*theta3.^2.*theta6.^2, 2.*tdot6.*theta3.^3.*theta6 + 3.*tdot3.*theta3.^2.*theta6.^2, 2.*tdot4.*theta4.*theta5.^3 + 3.*tdot5.*theta4.^2.*theta5.^2, 2.*tdot4.*theta4.*theta6.^2 + 2.*tdot6.*theta4.^2.*theta6, 2.*tdot5.*theta4.^3.*theta5 + 3.*tdot4.*theta4.^2.*theta5.^2, 2.*tdot4.*theta4.*theta6.^3 + 3.*tdot6.*theta4.^2.*theta6.^2, 2.*tdot6.*theta4.^3.*theta6 + 3.*tdot4.*theta4.^2.*theta6.^2, 2.*tdot5.*theta5.*theta6.^2 + 2.*tdot6.*theta5.^2.*theta6, 2.*tdot5.*theta5.*theta6.^3 + 3.*tdot6.*theta5.^2.*theta6.^2, 2.*tdot6.*theta5.^3.*theta6 + 3.*tdot5.*theta5.^2.*theta6.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta5 + tdot5.*theta1, tdot2.*theta4 + tdot4.*theta2, tdot1.*theta6 + tdot6.*theta1, tdot2.*theta5 + tdot5.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot2.*theta6 + tdot6.*theta2, tdot3.*theta5 + tdot5.*theta3, tdot3.*theta6 + tdot6.*theta3, tdot4.*theta5 + tdot5.*theta4, tdot4.*theta6 + tdot6.*theta4, tdot5.*theta6 + tdot6.*theta5, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot1.*theta5.^2 + 2.*tdot5.*theta1.*theta5, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot5.*theta1.^2 + 2.*tdot1.*theta1.*theta5, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot1.*theta5.^3 + 3.*tdot5.*theta1.*theta5.^2, tdot1.*theta6.^2 + 2.*tdot6.*theta1.*theta6, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot2.*theta5.^2 + 2.*tdot5.*theta2.*theta5, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot6.*theta1.^2 + 2.*tdot1.*theta1.*theta6, tdot5.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta5, tdot5.*theta2.^2 + 2.*tdot2.*theta2.*theta5, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot1.*theta5.^4 + 4.*tdot5.*theta1.*theta5.^3, tdot1.*theta6.^3 + 3.*tdot6.*theta1.*theta6.^2, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot2.*theta5.^3 + 3.*tdot5.*theta2.*theta5.^2, tdot2.*theta6.^2 + 2.*tdot6.*theta2.*theta6, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot3.*theta5.^2 + 2.*tdot5.*theta3.*theta5, tdot6.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta6, tdot6.*theta2.^2 + 2.*tdot2.*theta2.*theta6, tdot5.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta5, tdot5.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta5, tdot5.*theta3.^2 + 2.*tdot3.*theta3.*theta5, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot1.*theta6.^4 + 4.*tdot6.*theta1.*theta6.^3, tdot2.*theta5.^4 + 4.*tdot5.*theta2.*theta5.^3, tdot2.*theta6.^3 + 3.*tdot6.*theta2.*theta6.^2, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot3.*theta5.^3 + 3.*tdot5.*theta3.*theta5.^2, tdot3.*theta6.^2 + 2.*tdot6.*theta3.*theta6, tdot4.*theta5.^2 + 2.*tdot5.*theta4.*theta5, tdot6.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta6, tdot6.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta6, tdot6.*theta3.^2 + 2.*tdot3.*theta3.*theta6, tdot5.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta5, tdot5.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta5, tdot5.*theta4.^2 + 2.*tdot4.*theta4.*theta5, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, tdot2.*theta6.^4 + 4.*tdot6.*theta2.*theta6.^3, tdot3.*theta5.^4 + 4.*tdot5.*theta3.*theta5.^3, tdot3.*theta6.^3 + 3.*tdot6.*theta3.*theta6.^2, tdot4.*theta5.^3 + 3.*tdot5.*theta4.*theta5.^2, tdot4.*theta6.^2 + 2.*tdot6.*theta4.*theta6, tdot6.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta6, tdot6.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta6, tdot6.*theta4.^2 + 2.*tdot4.*theta4.*theta6, tdot5.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta5, tdot5.*theta4.^3 + 3.*tdot4.*theta4.^2.*theta5, tdot3.*theta6.^4 + 4.*tdot6.*theta3.*theta6.^3, tdot4.*theta5.^4 + 4.*tdot5.*theta4.*theta5.^3, tdot4.*theta6.^3 + 3.*tdot6.*theta4.*theta6.^2, tdot5.*theta6.^2 + 2.*tdot6.*theta5.*theta6, tdot6.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta6, tdot6.*theta4.^3 + 3.*tdot4.*theta4.^2.*theta6, tdot6.*theta5.^2 + 2.*tdot5.*theta5.*theta6, tdot5.*theta4.^4 + 4.*tdot4.*theta4.^3.*theta5, tdot4.*theta6.^4 + 4.*tdot6.*theta4.*theta6.^3, tdot5.*theta6.^3 + 3.*tdot6.*theta5.*theta6.^2, tdot6.*theta4.^4 + 4.*tdot4.*theta4.^3.*theta6, tdot6.*theta5.^3 + 3.*tdot5.*theta5.^2.*theta6, tdot5.*theta6.^4 + 4.*tdot6.*theta5.*theta6.^3, tdot6.*theta5.^4 + 4.*tdot5.*theta5.^3.*theta6, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 2.*tdot5.*theta5, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 3.*tdot5.*theta5.^2, 2.*tdot6.*theta6, 5.*tdot4.*theta4.^4, 4.*tdot5.*theta5.^3, 3.*tdot6.*theta6.^2, 5.*tdot5.*theta5.^4, 4.*tdot6.*theta6.^3, 5.*tdot6.*theta6.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta2.*theta5.^2 + tdot2.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta5, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta5, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot2.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta5, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta2.*theta5.^3 + tdot2.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta2.*theta5.^2, tdot1.*theta2.*theta6.^2 + tdot2.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta6, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.*theta5.^2 + tdot3.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta5, tdot1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta6, tdot1.*theta2.^3.*theta5 + tdot5.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta5, tdot1.*theta3.^2.*theta5 + tdot5.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta5, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta6, tdot3.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta5, tdot2.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta5, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot1.*theta2.*theta6.^3 + tdot2.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta2.*theta6.^2, tdot1.*theta3.*theta5.^3 + tdot3.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta3.*theta5.^2, tdot1.*theta3.*theta6.^2 + tdot3.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta6, tdot1.*theta4.*theta5.^2 + tdot4.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta4.*theta5, tdot1.*theta2.^3.*theta6 + tdot6.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta6, tdot1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta6, tdot1.*theta3.^3.*theta5 + tdot5.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta5, tdot1.*theta4.^2.*theta5 + tdot5.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta4.*theta5, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.*theta5.^2 + tdot3.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta5, tdot2.*theta3.^2.*theta5 + tdot5.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta5, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta6, tdot4.*theta1.^2.*theta5 + tdot5.*theta1.^2.*theta4 + 2.*tdot1.*theta1.*theta4.*theta5, tdot2.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta6, tdot3.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta5, tdot3.*theta2.^2.*theta5 + tdot5.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta5, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta3.*theta6.^3 + tdot3.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta3.*theta6.^2, tdot1.*theta4.*theta5.^3 + tdot4.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta4.*theta5.^2, tdot1.*theta4.*theta6.^2 + tdot4.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta4.*theta6, tdot1.*theta3.^3.*theta6 + tdot6.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta6, tdot1.*theta4.^2.*theta6 + tdot6.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta4.*theta6, tdot1.*theta4.^3.*theta5 + tdot5.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2.*theta5, tdot2.*theta3.*theta5.^3 + tdot3.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta3.*theta5.^2, tdot2.*theta3.*theta6.^2 + tdot3.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta6, tdot2.*theta4.*theta5.^2 + tdot4.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta4.*theta5, tdot2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta6, tdot2.*theta3.^3.*theta5 + tdot5.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta5, tdot2.*theta4.^2.*theta5 + tdot5.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta4.*theta5, tdot4.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta4 + 2.*tdot1.*theta1.*theta4.*theta6, tdot3.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta6, tdot4.*theta1.^3.*theta5 + tdot5.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.*theta5, tdot3.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta6, tdot4.*theta2.^2.*theta5 + tdot5.*theta2.^2.*theta4 + 2.*tdot2.*theta2.*theta4.*theta5, tdot3.*theta2.^3.*theta5 + tdot5.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta5, tdot1.*theta4.*theta6.^3 + tdot4.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta4.*theta6.^2, tdot1.*theta5.*theta6.^2 + tdot5.*theta1.*theta6.^2 + 2.*tdot6.*theta1.*theta5.*theta6, tdot1.*theta4.^3.*theta6 + tdot6.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2.*theta6, tdot1.*theta5.^2.*theta6 + tdot6.*theta1.*theta5.^2 + 2.*tdot5.*theta1.*theta5.*theta6, tdot2.*theta3.*theta6.^3 + tdot3.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta3.*theta6.^2, tdot2.*theta4.*theta5.^3 + tdot4.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta4.*theta5.^2, tdot2.*theta4.*theta6.^2 + tdot4.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta4.*theta6, tdot2.*theta3.^3.*theta6 + tdot6.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta6, tdot2.*theta4.^2.*theta6 + tdot6.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta4.*theta6, tdot2.*theta4.^3.*theta5 + tdot5.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2.*theta5, tdot3.*theta4.*theta5.^2 + tdot4.*theta3.*theta5.^2 + 2.*tdot5.*theta3.*theta4.*theta5, tdot3.*theta4.^2.*theta5 + tdot5.*theta3.*theta4.^2 + 2.*tdot4.*theta3.*theta4.*theta5, tdot5.*theta1.^2.*theta6 + tdot6.*theta1.^2.*theta5 + 2.*tdot1.*theta1.*theta5.*theta6, tdot4.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.*theta6, tdot4.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta4 + 2.*tdot2.*theta2.*theta4.*theta6, tdot3.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta6, tdot4.*theta2.^3.*theta5 + tdot5.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.*theta5, tdot4.*theta3.^2.*theta5 + tdot5.*theta3.^2.*theta4 + 2.*tdot3.*theta3.*theta4.*theta5, tdot1.*theta5.*theta6.^3 + tdot5.*theta1.*theta6.^3 + 3.*tdot6.*theta1.*theta5.*theta6.^2, tdot1.*theta5.^3.*theta6 + tdot6.*theta1.*theta5.^3 + 3.*tdot5.*theta1.*theta5.^2.*theta6, tdot2.*theta4.*theta6.^3 + tdot4.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta4.*theta6.^2, tdot2.*theta5.*theta6.^2 + tdot5.*theta2.*theta6.^2 + 2.*tdot6.*theta2.*theta5.*theta6, tdot2.*theta4.^3.*theta6 + tdot6.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2.*theta6, tdot2.*theta5.^2.*theta6 + tdot6.*theta2.*theta5.^2 + 2.*tdot5.*theta2.*theta5.*theta6, tdot3.*theta4.*theta5.^3 + tdot4.*theta3.*theta5.^3 + 3.*tdot5.*theta3.*theta4.*theta5.^2, tdot3.*theta4.*theta6.^2 + tdot4.*theta3.*theta6.^2 + 2.*tdot6.*theta3.*theta4.*theta6, tdot3.*theta4.^2.*theta6 + tdot6.*theta3.*theta4.^2 + 2.*tdot4.*theta3.*theta4.*theta6, tdot3.*theta4.^3.*theta5 + tdot5.*theta3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2.*theta5, tdot5.*theta1.^3.*theta6 + tdot6.*theta1.^3.*theta5 + 3.*tdot1.*theta1.^2.*theta5.*theta6, tdot5.*theta2.^2.*theta6 + tdot6.*theta2.^2.*theta5 + 2.*tdot2.*theta2.*theta5.*theta6, tdot4.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.*theta6, tdot4.*theta3.^2.*theta6 + tdot6.*theta3.^2.*theta4 + 2.*tdot3.*theta3.*theta4.*theta6, tdot4.*theta3.^3.*theta5 + tdot5.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.*theta5, tdot2.*theta5.*theta6.^3 + tdot5.*theta2.*theta6.^3 + 3.*tdot6.*theta2.*theta5.*theta6.^2, tdot2.*theta5.^3.*theta6 + tdot6.*theta2.*theta5.^3 + 3.*tdot5.*theta2.*theta5.^2.*theta6, tdot3.*theta4.*theta6.^3 + tdot4.*theta3.*theta6.^3 + 3.*tdot6.*theta3.*theta4.*theta6.^2, tdot3.*theta5.*theta6.^2 + tdot5.*theta3.*theta6.^2 + 2.*tdot6.*theta3.*theta5.*theta6, tdot3.*theta4.^3.*theta6 + tdot6.*theta3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2.*theta6, tdot3.*theta5.^2.*theta6 + tdot6.*theta3.*theta5.^2 + 2.*tdot5.*theta3.*theta5.*theta6, tdot5.*theta2.^3.*theta6 + tdot6.*theta2.^3.*theta5 + 3.*tdot2.*theta2.^2.*theta5.*theta6, tdot5.*theta3.^2.*theta6 + tdot6.*theta3.^2.*theta5 + 2.*tdot3.*theta3.*theta5.*theta6, tdot4.*theta3.^3.*theta6 + tdot6.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.*theta6, tdot3.*theta5.*theta6.^3 + tdot5.*theta3.*theta6.^3 + 3.*tdot6.*theta3.*theta5.*theta6.^2, tdot3.*theta5.^3.*theta6 + tdot6.*theta3.*theta5.^3 + 3.*tdot5.*theta3.*theta5.^2.*theta6, tdot4.*theta5.*theta6.^2 + tdot5.*theta4.*theta6.^2 + 2.*tdot6.*theta4.*theta5.*theta6, tdot4.*theta5.^2.*theta6 + tdot6.*theta4.*theta5.^2 + 2.*tdot5.*theta4.*theta5.*theta6, tdot5.*theta3.^3.*theta6 + tdot6.*theta3.^3.*theta5 + 3.*tdot3.*theta3.^2.*theta5.*theta6, tdot5.*theta4.^2.*theta6 + tdot6.*theta4.^2.*theta5 + 2.*tdot4.*theta4.*theta5.*theta6, tdot4.*theta5.*theta6.^3 + tdot5.*theta4.*theta6.^3 + 3.*tdot6.*theta4.*theta5.*theta6.^2, tdot4.*theta5.^3.*theta6 + tdot6.*theta4.*theta5.^3 + 3.*tdot5.*theta4.*theta5.^2.*theta6, tdot5.*theta4.^3.*theta6 + tdot6.*theta4.^3.*theta5 + 3.*tdot4.*theta4.^2.*theta5.*theta6, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.^2.*theta5, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot2.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta2.*theta5, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot5.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta5 + 2.*tdot2.*theta1.^2.*theta2.*theta5, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.^2.*theta6, tdot1.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.^2.*theta5, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot2.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta2.*theta6, tdot3.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta3.*theta5, tdot6.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta6 + 2.*tdot2.*theta1.^2.*theta2.*theta6, tdot5.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta5 + 2.*tdot3.*theta1.^2.*theta3.*theta5, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.^2.*theta6, tdot1.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.*theta4.^2.*theta5, tdot2.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.^2.*theta5, tdot3.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta3.*theta6, tdot4.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.^2.*theta4.*theta5, tdot6.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta6 + 2.*tdot3.*theta1.^2.*theta3.*theta6, tdot5.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta4.^2.*theta5 + 2.*tdot4.*theta1.^2.*theta4.*theta5, tdot3.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta3.*theta5, tdot5.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta5 + 2.*tdot3.*theta2.^2.*theta3.*theta5, tdot1.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.*theta4.^2.*theta6, tdot2.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.^2.*theta6, tdot2.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.*theta4.^2.*theta5, tdot4.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta4.*theta6, tdot6.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta4.^2.*theta6 + 2.*tdot4.*theta1.^2.*theta4.*theta6, tdot3.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta3.*theta6, tdot4.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.^2.*theta4.*theta5, tdot6.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta6 + 2.*tdot3.*theta2.^2.*theta3.*theta6, tdot5.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta4.^2.*theta5 + 2.*tdot4.*theta2.^2.*theta4.*theta5, tdot1.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta1.*theta5.*theta6.^2 + 2.*tdot6.*theta1.*theta5.^2.*theta6, tdot2.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.*theta4.^2.*theta6, tdot3.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.*theta4.^2.*theta5, tdot5.*theta1.^2.*theta6.^2 + 2.*tdot1.*theta1.*theta5.*theta6.^2 + 2.*tdot6.*theta1.^2.*theta5.*theta6, tdot6.*theta1.^2.*theta5.^2 + 2.*tdot1.*theta1.*theta5.^2.*theta6 + 2.*tdot5.*theta1.^2.*theta5.*theta6, tdot4.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta4.*theta6, tdot6.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta4.^2.*theta6 + 2.*tdot4.*theta2.^2.*theta4.*theta6, tdot4.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.^2.*theta4.*theta5, tdot5.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta3.*theta4.^2.*theta5 + 2.*tdot4.*theta3.^2.*theta4.*theta5, tdot2.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta2.*theta5.*theta6.^2 + 2.*tdot6.*theta2.*theta5.^2.*theta6, tdot3.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.*theta4.^2.*theta6, tdot5.*theta2.^2.*theta6.^2 + 2.*tdot2.*theta2.*theta5.*theta6.^2 + 2.*tdot6.*theta2.^2.*theta5.*theta6, tdot6.*theta2.^2.*theta5.^2 + 2.*tdot2.*theta2.*theta5.^2.*theta6 + 2.*tdot5.*theta2.^2.*theta5.*theta6, tdot4.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta4.*theta6, tdot6.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta3.*theta4.^2.*theta6 + 2.*tdot4.*theta3.^2.*theta4.*theta6, tdot3.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta3.*theta5.*theta6.^2 + 2.*tdot6.*theta3.*theta5.^2.*theta6, tdot5.*theta3.^2.*theta6.^2 + 2.*tdot3.*theta3.*theta5.*theta6.^2 + 2.*tdot6.*theta3.^2.*theta5.*theta6, tdot6.*theta3.^2.*theta5.^2 + 2.*tdot3.*theta3.*theta5.^2.*theta6 + 2.*tdot5.*theta3.^2.*theta5.*theta6, tdot4.*theta5.^2.*theta6.^2 + 2.*tdot5.*theta4.*theta5.*theta6.^2 + 2.*tdot6.*theta4.*theta5.^2.*theta6, tdot5.*theta4.^2.*theta6.^2 + 2.*tdot4.*theta4.*theta5.*theta6.^2 + 2.*tdot6.*theta4.^2.*theta5.*theta6, tdot6.*theta4.^2.*theta5.^2 + 2.*tdot4.*theta4.*theta5.^2.*theta6 + 2.*tdot5.*theta4.^2.*theta5.*theta6, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta2.*theta5 + tdot2.*theta1.*theta5 + tdot5.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot1.*theta2.*theta6 + tdot2.*theta1.*theta6 + tdot6.*theta1.*theta2, tdot1.*theta3.*theta5 + tdot3.*theta1.*theta5 + tdot5.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta3.*theta6 + tdot3.*theta1.*theta6 + tdot6.*theta1.*theta3, tdot1.*theta4.*theta5 + tdot4.*theta1.*theta5 + tdot5.*theta1.*theta4, tdot2.*theta3.*theta5 + tdot3.*theta2.*theta5 + tdot5.*theta2.*theta3, tdot1.*theta4.*theta6 + tdot4.*theta1.*theta6 + tdot6.*theta1.*theta4, tdot2.*theta3.*theta6 + tdot3.*theta2.*theta6 + tdot6.*theta2.*theta3, tdot2.*theta4.*theta5 + tdot4.*theta2.*theta5 + tdot5.*theta2.*theta4, tdot1.*theta5.*theta6 + tdot5.*theta1.*theta6 + tdot6.*theta1.*theta5, tdot2.*theta4.*theta6 + tdot4.*theta2.*theta6 + tdot6.*theta2.*theta4, tdot3.*theta4.*theta5 + tdot4.*theta3.*theta5 + tdot5.*theta3.*theta4, tdot2.*theta5.*theta6 + tdot5.*theta2.*theta6 + tdot6.*theta2.*theta5, tdot3.*theta4.*theta6 + tdot4.*theta3.*theta6 + tdot6.*theta3.*theta4, tdot3.*theta5.*theta6 + tdot5.*theta3.*theta6 + tdot6.*theta3.*theta5, tdot4.*theta5.*theta6 + tdot5.*theta4.*theta6 + tdot6.*theta4.*theta5, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta5 + tdot2.*theta1.*theta3.*theta5 + tdot3.*theta1.*theta2.*theta5 + tdot5.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta6 + tdot2.*theta1.*theta3.*theta6 + tdot3.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta3, tdot1.*theta2.*theta4.*theta5 + tdot2.*theta1.*theta4.*theta5 + tdot4.*theta1.*theta2.*theta5 + tdot5.*theta1.*theta2.*theta4, tdot1.*theta2.*theta4.*theta6 + tdot2.*theta1.*theta4.*theta6 + tdot4.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta4, tdot1.*theta3.*theta4.*theta5 + tdot3.*theta1.*theta4.*theta5 + tdot4.*theta1.*theta3.*theta5 + tdot5.*theta1.*theta3.*theta4, tdot1.*theta2.*theta5.*theta6 + tdot2.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta6 + tdot6.*theta1.*theta2.*theta5, tdot1.*theta3.*theta4.*theta6 + tdot3.*theta1.*theta4.*theta6 + tdot4.*theta1.*theta3.*theta6 + tdot6.*theta1.*theta3.*theta4, tdot2.*theta3.*theta4.*theta5 + tdot3.*theta2.*theta4.*theta5 + tdot4.*theta2.*theta3.*theta5 + tdot5.*theta2.*theta3.*theta4, tdot1.*theta3.*theta5.*theta6 + tdot3.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta3.*theta6 + tdot6.*theta1.*theta3.*theta5, tdot2.*theta3.*theta4.*theta6 + tdot3.*theta2.*theta4.*theta6 + tdot4.*theta2.*theta3.*theta6 + tdot6.*theta2.*theta3.*theta4, tdot1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta5.*theta6 + tdot5.*theta1.*theta4.*theta6 + tdot6.*theta1.*theta4.*theta5, tdot2.*theta3.*theta5.*theta6 + tdot3.*theta2.*theta5.*theta6 + tdot5.*theta2.*theta3.*theta6 + tdot6.*theta2.*theta3.*theta5, tdot2.*theta4.*theta5.*theta6 + tdot4.*theta2.*theta5.*theta6 + tdot5.*theta2.*theta4.*theta6 + tdot6.*theta2.*theta4.*theta5, tdot3.*theta4.*theta5.*theta6 + tdot4.*theta3.*theta5.*theta6 + tdot5.*theta3.*theta4.*theta6 + tdot6.*theta3.*theta4.*theta5, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta5.^2 + tdot2.*theta1.*theta3.*theta5.^2 + tdot3.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta3.^2.*theta5 + tdot2.*theta1.*theta3.^2.*theta5 + tdot5.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.^2.*theta3.*theta5 + tdot3.*theta1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta5, tdot2.*theta1.^2.*theta3.*theta5 + tdot3.*theta1.^2.*theta2.*theta5 + tdot5.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta3.*theta6.^2 + tdot2.*theta1.*theta3.*theta6.^2 + tdot3.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.*theta4.*theta5.^2 + tdot2.*theta1.*theta4.*theta5.^2 + tdot4.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.*theta3.^2.*theta6 + tdot2.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.*theta4.^2.*theta5 + tdot2.*theta1.*theta4.^2.*theta5 + tdot5.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.^2.*theta3.*theta6 + tdot3.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta6, tdot1.*theta2.^2.*theta4.*theta5 + tdot4.*theta1.*theta2.^2.*theta5 + tdot5.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.*theta2.*theta4.*theta5, tdot2.*theta1.^2.*theta3.*theta6 + tdot3.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta6, tdot2.*theta1.^2.*theta4.*theta5 + tdot4.*theta1.^2.*theta2.*theta5 + tdot5.*theta1.^2.*theta2.*theta4 + 2.*tdot1.*theta1.*theta2.*theta4.*theta5, tdot1.*theta2.*theta4.*theta6.^2 + tdot2.*theta1.*theta4.*theta6.^2 + tdot4.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta4.*theta6, tdot1.*theta2.*theta4.^2.*theta6 + tdot2.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4.*theta6, tdot1.*theta3.*theta4.*theta5.^2 + tdot3.*theta1.*theta4.*theta5.^2 + tdot4.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta4.*theta5, tdot1.*theta3.*theta4.^2.*theta5 + tdot3.*theta1.*theta4.^2.*theta5 + tdot5.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4.*theta5, tdot1.*theta2.^2.*theta4.*theta6 + tdot4.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.*theta2.*theta4.*theta6, tdot1.*theta3.^2.*theta4.*theta5 + tdot4.*theta1.*theta3.^2.*theta5 + tdot5.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.*theta3.*theta4.*theta5, tdot2.*theta1.^2.*theta4.*theta6 + tdot4.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta4 + 2.*tdot1.*theta1.*theta2.*theta4.*theta6, tdot3.*theta1.^2.*theta4.*theta5 + tdot4.*theta1.^2.*theta3.*theta5 + tdot5.*theta1.^2.*theta3.*theta4 + 2.*tdot1.*theta1.*theta3.*theta4.*theta5, tdot1.*theta2.*theta5.*theta6.^2 + tdot2.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta2.*theta6.^2 + 2.*tdot6.*theta1.*theta2.*theta5.*theta6, tdot1.*theta2.*theta5.^2.*theta6 + tdot2.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta2.*theta5.^2 + 2.*tdot5.*theta1.*theta2.*theta5.*theta6, tdot1.*theta3.*theta4.*theta6.^2 + tdot3.*theta1.*theta4.*theta6.^2 + tdot4.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta4.*theta6, tdot1.*theta3.*theta4.^2.*theta6 + tdot3.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4.*theta6, tdot1.*theta2.^2.*theta5.*theta6 + tdot5.*theta1.*theta2.^2.*theta6 + tdot6.*theta1.*theta2.^2.*theta5 + 2.*tdot2.*theta1.*theta2.*theta5.*theta6, tdot1.*theta3.^2.*theta4.*theta6 + tdot4.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.*theta3.*theta4.*theta6, tdot2.*theta3.*theta4.*theta5.^2 + tdot3.*theta2.*theta4.*theta5.^2 + tdot4.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta4.*theta5, tdot2.*theta3.*theta4.^2.*theta5 + tdot3.*theta2.*theta4.^2.*theta5 + tdot5.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4.*theta5, tdot2.*theta3.^2.*theta4.*theta5 + tdot4.*theta2.*theta3.^2.*theta5 + tdot5.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.*theta3.*theta4.*theta5, tdot2.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta2.*theta6 + tdot6.*theta1.^2.*theta2.*theta5 + 2.*tdot1.*theta1.*theta2.*theta5.*theta6, tdot3.*theta1.^2.*theta4.*theta6 + tdot4.*theta1.^2.*theta3.*theta6 + tdot6.*theta1.^2.*theta3.*theta4 + 2.*tdot1.*theta1.*theta3.*theta4.*theta6, tdot3.*theta2.^2.*theta4.*theta5 + tdot4.*theta2.^2.*theta3.*theta5 + tdot5.*theta2.^2.*theta3.*theta4 + 2.*tdot2.*theta2.*theta3.*theta4.*theta5, tdot1.*theta3.*theta5.*theta6.^2 + tdot3.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta3.*theta6.^2 + 2.*tdot6.*theta1.*theta3.*theta5.*theta6, tdot1.*theta3.*theta5.^2.*theta6 + tdot3.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta3.*theta5.^2 + 2.*tdot5.*theta1.*theta3.*theta5.*theta6, tdot1.*theta3.^2.*theta5.*theta6 + tdot5.*theta1.*theta3.^2.*theta6 + tdot6.*theta1.*theta3.^2.*theta5 + 2.*tdot3.*theta1.*theta3.*theta5.*theta6, tdot2.*theta3.*theta4.*theta6.^2 + tdot3.*theta2.*theta4.*theta6.^2 + tdot4.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta4.*theta6, tdot2.*theta3.*theta4.^2.*theta6 + tdot3.*theta2.*theta4.^2.*theta6 + tdot6.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4.*theta6, tdot2.*theta3.^2.*theta4.*theta6 + tdot4.*theta2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.*theta3.*theta4.*theta6, tdot3.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta3.*theta6 + tdot6.*theta1.^2.*theta3.*theta5 + 2.*tdot1.*theta1.*theta3.*theta5.*theta6, tdot3.*theta2.^2.*theta4.*theta6 + tdot4.*theta2.^2.*theta3.*theta6 + tdot6.*theta2.^2.*theta3.*theta4 + 2.*tdot2.*theta2.*theta3.*theta4.*theta6, tdot1.*theta4.*theta5.*theta6.^2 + tdot4.*theta1.*theta5.*theta6.^2 + tdot5.*theta1.*theta4.*theta6.^2 + 2.*tdot6.*theta1.*theta4.*theta5.*theta6, tdot1.*theta4.*theta5.^2.*theta6 + tdot4.*theta1.*theta5.^2.*theta6 + tdot6.*theta1.*theta4.*theta5.^2 + 2.*tdot5.*theta1.*theta4.*theta5.*theta6, tdot1.*theta4.^2.*theta5.*theta6 + tdot5.*theta1.*theta4.^2.*theta6 + tdot6.*theta1.*theta4.^2.*theta5 + 2.*tdot4.*theta1.*theta4.*theta5.*theta6, tdot2.*theta3.*theta5.*theta6.^2 + tdot3.*theta2.*theta5.*theta6.^2 + tdot5.*theta2.*theta3.*theta6.^2 + 2.*tdot6.*theta2.*theta3.*theta5.*theta6, tdot2.*theta3.*theta5.^2.*theta6 + tdot3.*theta2.*theta5.^2.*theta6 + tdot6.*theta2.*theta3.*theta5.^2 + 2.*tdot5.*theta2.*theta3.*theta5.*theta6, tdot2.*theta3.^2.*theta5.*theta6 + tdot5.*theta2.*theta3.^2.*theta6 + tdot6.*theta2.*theta3.^2.*theta5 + 2.*tdot3.*theta2.*theta3.*theta5.*theta6, tdot4.*theta1.^2.*theta5.*theta6 + tdot5.*theta1.^2.*theta4.*theta6 + tdot6.*theta1.^2.*theta4.*theta5 + 2.*tdot1.*theta1.*theta4.*theta5.*theta6, tdot3.*theta2.^2.*theta5.*theta6 + tdot5.*theta2.^2.*theta3.*theta6 + tdot6.*theta2.^2.*theta3.*theta5 + 2.*tdot2.*theta2.*theta3.*theta5.*theta6, tdot2.*theta4.*theta5.*theta6.^2 + tdot4.*theta2.*theta5.*theta6.^2 + tdot5.*theta2.*theta4.*theta6.^2 + 2.*tdot6.*theta2.*theta4.*theta5.*theta6, tdot2.*theta4.*theta5.^2.*theta6 + tdot4.*theta2.*theta5.^2.*theta6 + tdot6.*theta2.*theta4.*theta5.^2 + 2.*tdot5.*theta2.*theta4.*theta5.*theta6, tdot2.*theta4.^2.*theta5.*theta6 + tdot5.*theta2.*theta4.^2.*theta6 + tdot6.*theta2.*theta4.^2.*theta5 + 2.*tdot4.*theta2.*theta4.*theta5.*theta6, tdot4.*theta2.^2.*theta5.*theta6 + tdot5.*theta2.^2.*theta4.*theta6 + tdot6.*theta2.^2.*theta4.*theta5 + 2.*tdot2.*theta2.*theta4.*theta5.*theta6, tdot3.*theta4.*theta5.*theta6.^2 + tdot4.*theta3.*theta5.*theta6.^2 + tdot5.*theta3.*theta4.*theta6.^2 + 2.*tdot6.*theta3.*theta4.*theta5.*theta6, tdot3.*theta4.*theta5.^2.*theta6 + tdot4.*theta3.*theta5.^2.*theta6 + tdot6.*theta3.*theta4.*theta5.^2 + 2.*tdot5.*theta3.*theta4.*theta5.*theta6, tdot3.*theta4.^2.*theta5.*theta6 + tdot5.*theta3.*theta4.^2.*theta6 + tdot6.*theta3.*theta4.^2.*theta5 + 2.*tdot4.*theta3.*theta4.*theta5.*theta6, tdot4.*theta3.^2.*theta5.*theta6 + tdot5.*theta3.^2.*theta4.*theta6 + tdot6.*theta3.^2.*theta4.*theta5 + 2.*tdot3.*theta3.*theta4.*theta5.*theta6, tdot1.*theta2.*theta3.*theta4.*theta5 + tdot2.*theta1.*theta3.*theta4.*theta5 + tdot3.*theta1.*theta2.*theta4.*theta5 + tdot4.*theta1.*theta2.*theta3.*theta5 + tdot5.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta4.*theta6 + tdot2.*theta1.*theta3.*theta4.*theta6 + tdot3.*theta1.*theta2.*theta4.*theta6 + tdot4.*theta1.*theta2.*theta3.*theta6 + tdot6.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.*theta5.*theta6 + tdot2.*theta1.*theta3.*theta5.*theta6 + tdot3.*theta1.*theta2.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta3.*theta6 + tdot6.*theta1.*theta2.*theta3.*theta5, tdot1.*theta2.*theta4.*theta5.*theta6 + tdot2.*theta1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta2.*theta5.*theta6 + tdot5.*theta1.*theta2.*theta4.*theta6 + tdot6.*theta1.*theta2.*theta4.*theta5, tdot1.*theta3.*theta4.*theta5.*theta6 + tdot3.*theta1.*theta4.*theta5.*theta6 + tdot4.*theta1.*theta3.*theta5.*theta6 + tdot5.*theta1.*theta3.*theta4.*theta6 + tdot6.*theta1.*theta3.*theta4.*theta5, tdot2.*theta3.*theta4.*theta5.*theta6 + tdot3.*theta2.*theta4.*theta5.*theta6 + tdot4.*theta2.*theta3.*theta5.*theta6 + tdot5.*theta2.*theta3.*theta4.*theta6 + tdot6.*theta2.*theta3.*theta4.*theta5, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -2.*theta1.*theta5.^2, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.^3, -2.*theta1.*theta6.^2, -3.*theta1.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6.^3, -3.*theta1.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta5, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, -3.*theta1.^2.*theta5, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6, zeroCol, -4.*theta1.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta2.*theta5.^2, -theta3.*theta4.^2, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta2.*theta5, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta2.*theta5.^3, -theta2.*theta6.^2, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^2.*theta6, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -2.*theta1.*theta3.*theta5, -3.*theta1.^2.*theta2.*theta5, -3.*theta1.^2.*theta3.*theta4, zeroCol, -theta2.*theta6.^3, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -2.*theta1.*theta4.*theta5, -3.*theta1.^2.*theta2.*theta6, -3.*theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.^2.*theta3.*theta6, -3.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6, -3.*theta1.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta2.^2.*theta5.^2, -theta3.^2.*theta4.^2, -2.*theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta2.^2.*theta5, -2.*theta1.*theta3.^2.*theta4, -theta2.^2.*theta6.^2, -theta3.^2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta6.^2, -2.*theta1.*theta3.*theta5.^2, -2.*theta1.*theta2.^2.*theta6, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, -2.*theta1.*theta3.*theta6.^2, -2.*theta1.*theta4.*theta5.^2, -2.*theta1.*theta3.^2.*theta6, -2.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta5.*theta6.^2, -2.*theta1.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta2.*theta5, -theta3.*theta4, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta5, -theta2.*theta3.*theta6, -theta2.*theta4.*theta5, -theta2.*theta4.*theta6, -theta3.*theta4.*theta5, -theta2.*theta5.*theta6, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta2.*theta3.*theta6.^2, -theta2.*theta4.*theta5.^2, -theta2.*theta3.^2.*theta6, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta3.*theta6, -theta2.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta6, -theta3.^2.*theta4.*theta5, -2.*theta1.*theta2.*theta4.*theta6, -2.*theta1.*theta3.*theta4.*theta5, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta2.^2.*theta5.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.*theta6, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.^3, -2.*theta2.*theta5.^2, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.^3, -2.*theta2.*theta6.^2, -3.*theta2.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6.^3, -3.*theta2.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta5, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, -3.*theta2.^2.*theta5, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6, zeroCol, -4.*theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta5, -3.*theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, -3.*theta1.*theta2.^2.*theta5, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -2.*theta2.*theta3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta3.^2.*theta5, -theta3.^3.*theta4, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -2.*theta2.*theta3.*theta5, -3.*theta2.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -theta4.*theta5.^2, -theta3.^2.*theta6, -theta3.^3.*theta5, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, -2.*theta2.*theta4.*theta5, -3.*theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.*theta6.^3, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.^2.*theta3.*theta6, -3.*theta2.^2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta2.^2.*theta4.*theta6, zeroCol, zeroCol, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, -2.*theta1.*theta2.*theta5.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -2.*theta1.*theta2.*theta6.^2, zeroCol, -theta3.^2.*theta4.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, -theta3.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.^2.*theta5, zeroCol, -theta3.^2.*theta6.^2, -theta4.^2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6.^2, -2.*theta2.*theta4.*theta5.^2, -2.*theta2.*theta3.^2.*theta6, -2.*theta2.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.^2.*theta6, zeroCol, zeroCol, -theta5.^2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6.^2, -2.*theta2.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3, -theta1.*theta4, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta3.*theta4, zeroCol, zeroCol, -theta3.*theta5, zeroCol, -theta3.*theta6, -theta4.*theta5, zeroCol, -theta4.*theta6, zeroCol, -theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta3.*theta5, -theta1.*theta3.*theta6, -theta1.*theta4.*theta5, -theta1.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5, zeroCol, -theta3.*theta4.*theta6, zeroCol, -theta3.*theta5.*theta6, -theta4.*theta5.*theta6, zeroCol, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta5, -theta1.^2.*theta3.*theta5, -theta1.*theta3.*theta6.^2, -theta1.*theta4.*theta5.^2, -theta1.*theta3.^2.*theta6, -theta1.*theta4.^2.*theta5, -2.*theta1.*theta2.*theta3.*theta6, -2.*theta1.*theta2.*theta4.*theta5, -theta1.^2.*theta3.*theta6, -theta1.^2.*theta4.*theta5, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, zeroCol, -theta1.^2.*theta4.*theta6, zeroCol, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, -theta1.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta3.*theta4.*theta6.^2, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -theta3.^2.*theta5.*theta6, zeroCol, -2.*theta2.*theta3.*theta5.*theta6, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta2.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta5.*theta6, -theta1.*theta4.*theta5.*theta6, zeroCol, -theta3.*theta4.*theta5.*theta6, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.^3, -2.*theta3.*theta5.^2, -3.*theta3.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta5.^3, -2.*theta3.*theta6.^2, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.*theta6.^3, -3.*theta3.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, -theta2, zeroCol, zeroCol, zeroCol, zeroCol, -theta4, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta3.^3, zeroCol, zeroCol, -theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.^3, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, -3.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta4.^4, -theta5.^3, -theta6.^2, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -3.*theta3.^2.*theta5, zeroCol, -4.*theta3.^3.*theta4, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta6, zeroCol, -4.*theta3.^3.*theta5, zeroCol, -theta6.^4, zeroCol, zeroCol, zeroCol, -4.*theta3.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -theta1.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, zeroCol, -theta1.^2.*theta5, zeroCol, -theta1.^3.*theta4, -theta2.^2.*theta4, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta6, -3.*theta1.*theta3.^2.*theta5, zeroCol, -theta2.*theta4.^3, -theta2.*theta5.^2, -2.*theta2.*theta3.*theta5, -3.*theta2.*theta3.^2.*theta4, -theta1.^2.*theta6, zeroCol, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta1.*theta6.^3, zeroCol, zeroCol, -3.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta6, -3.*theta2.*theta3.^2.*theta5, zeroCol, zeroCol, -theta1.^3.*theta6, zeroCol, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, zeroCol, -3.*theta2.*theta3.^2.*theta6, zeroCol, zeroCol, -theta4.*theta5.^2, -theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta6, zeroCol, -2.*theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.^3, -theta4.*theta6.^2, -theta4.^2.*theta6, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6, -3.*theta3.^2.*theta4.*theta5, zeroCol, zeroCol, -theta4.*theta6.^3, -theta5.*theta6.^2, -theta4.^3.*theta6, -theta5.^2.*theta6, zeroCol, -2.*theta3.*theta5.*theta6, -3.*theta3.^2.*theta4.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.^2, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta3.*theta5, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta3.*theta5.^2, -theta1.^2.*theta6.^2, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta5.^2, -2.*theta2.^2.*theta3.*theta5, zeroCol, -2.*theta2.*theta3.*theta6.^2, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta6.^2, zeroCol, -2.*theta2.^2.*theta3.*theta6, zeroCol, zeroCol, zeroCol, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3.*theta4.*theta5.^2, -2.*theta3.*theta4.^2.*theta5, zeroCol, -theta4.^2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.^2.*theta6, -theta5.^2.*theta6.^2, -2.*theta3.*theta5.*theta6.^2, -2.*theta3.*theta5.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta4, zeroCol, -theta1.*theta5, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta4.*theta5, zeroCol, -theta4.*theta6, -theta5.*theta6, zeroCol, -theta1.*theta2.*theta4, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta4.*theta5, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta4.*theta5, -theta1.*theta5.*theta6, -theta2.*theta4.*theta6, zeroCol, -theta2.*theta5.*theta6, zeroCol, -theta4.*theta5.*theta6, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.^2.*theta5, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -theta1.^2.*theta2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta4.*theta6.^2, -theta1.*theta4.^2.*theta6, zeroCol, -2.*theta1.*theta3.*theta4.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta4.*theta5, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta3.*theta5.*theta6, -theta2.*theta4.*theta6.^2, -theta2.*theta4.^2.*theta6, -2.*theta2.*theta3.*theta4.*theta6, -theta1.^2.*theta5.*theta6, -theta2.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta3.*theta5.*theta6, zeroCol, -theta2.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta4.*theta5.*theta6.^2, -theta4.*theta5.^2.*theta6, -theta4.^2.*theta5.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta1.*theta2.*theta4.*theta5, -theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta5.*theta6, zeroCol, -theta1.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.*theta6, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, zeroCol, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta4.^2, zeroCol, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta4.^2, zeroCol, -2.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5.^2, zeroCol, zeroCol, -2.*theta4.*theta5.^3, -2.*theta4.*theta6.^2, -3.*theta4.^2.*theta5.^2, -2.*theta4.*theta6.^3, -3.*theta4.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, zeroCol, zeroCol, -theta5, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta4, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, zeroCol, zeroCol, -3.*theta2.*theta4.^2, zeroCol, -2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta4.^3, zeroCol, zeroCol, -3.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, zeroCol, zeroCol, zeroCol, -4.*theta3.*theta4.^3, zeroCol, zeroCol, -theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4.*theta5, -theta3.^4, zeroCol, zeroCol, zeroCol, -theta5.^3, -theta6.^2, zeroCol, zeroCol, -2.*theta4.*theta6, zeroCol, -3.*theta4.^2.*theta5, zeroCol, -theta5.^4, -theta6.^3, zeroCol, zeroCol, -3.*theta4.^2.*theta6, zeroCol, -4.*theta4.^3.*theta5, -theta6.^4, zeroCol, -4.*theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, zeroCol, -4.*theta4.^3, zeroCol, zeroCol, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, -3.*theta1.*theta3.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, zeroCol, -theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.*theta5, -3.*theta2.*theta3.*theta4.^2, zeroCol, zeroCol, -theta2.*theta3.^3, zeroCol, -theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta3, zeroCol, -theta1.*theta5.^3, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -3.*theta1.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta2.*theta4.*theta5, -theta1.^2.*theta6, zeroCol, -theta1.^3.*theta5, zeroCol, -theta2.^2.*theta5, zeroCol, -theta1.*theta6.^3, zeroCol, -3.*theta1.*theta4.^2.*theta6, zeroCol, zeroCol, -theta2.*theta5.^3, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -3.*theta2.*theta4.^2.*theta5, -theta3.*theta5.^2, -2.*theta3.*theta4.*theta5, zeroCol, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, -theta2.^3.*theta5, -theta3.^2.*theta5, zeroCol, zeroCol, -theta2.*theta6.^3, zeroCol, -3.*theta2.*theta4.^2.*theta6, zeroCol, -theta3.*theta5.^3, -theta3.*theta6.^2, -2.*theta3.*theta4.*theta6, -3.*theta3.*theta4.^2.*theta5, zeroCol, zeroCol, -theta2.^3.*theta6, -theta3.^2.*theta6, -theta3.^3.*theta5, zeroCol, zeroCol, -theta3.*theta6.^3, zeroCol, -3.*theta3.*theta4.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta3.^3.*theta6, zeroCol, zeroCol, -theta5.*theta6.^2, -theta5.^2.*theta6, zeroCol, -2.*theta4.*theta5.*theta6, -theta5.*theta6.^3, -theta5.^3.*theta6, -3.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, zeroCol, -2.*theta1.*theta3.^2.*theta4, zeroCol, -2.*theta1.^2.*theta3.*theta4, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, -theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, zeroCol, -2.*theta1.*theta4.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta5.^2, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta4.*theta6, zeroCol, -theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -2.*theta2.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta4.*theta6, -theta3.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta5, zeroCol, -2.*theta3.*theta4.*theta6.^2, zeroCol, zeroCol, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta4.*theta6, zeroCol, zeroCol, zeroCol, -theta5.^2.*theta6.^2, -2.*theta4.*theta5.*theta6.^2, -2.*theta4.*theta5.^2.*theta6, zeroCol, -theta1.*theta2, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta2.*theta3, zeroCol, -theta1.*theta5, zeroCol, -theta1.*theta6, zeroCol, -theta2.*theta5, zeroCol, -theta2.*theta6, -theta3.*theta5, zeroCol, -theta3.*theta6, zeroCol, -theta5.*theta6, -theta1.*theta2.*theta3, zeroCol, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta2.*theta6, -theta1.*theta3.*theta5, zeroCol, -theta1.*theta3.*theta6, -theta2.*theta3.*theta5, zeroCol, -theta2.*theta3.*theta6, -theta1.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6, -theta3.*theta5.*theta6, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2.*theta5.^2, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.^2.*theta5, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta2.^2.*theta6, -theta1.*theta3.^2.*theta5, -theta1.^2.*theta2.*theta6, -theta1.^2.*theta3.*theta5, zeroCol, zeroCol, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta4.*theta6, zeroCol, -theta1.*theta3.^2.*theta6, -theta2.*theta3.*theta5.^2, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.^2.*theta5, zeroCol, -theta1.^2.*theta3.*theta6, -theta2.^2.*theta3.*theta5, zeroCol, zeroCol, zeroCol, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.^2.*theta6, zeroCol, -theta2.^2.*theta3.*theta6, -theta1.*theta5.*theta6.^2, -theta1.*theta5.^2.*theta6, -2.*theta1.*theta4.*theta5.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5.*theta6, zeroCol, -theta2.*theta5.*theta6.^2, -theta2.*theta5.^2.*theta6, -2.*theta2.*theta4.*theta5.*theta6, -theta2.^2.*theta5.*theta6, -theta3.*theta5.*theta6.^2, -theta3.*theta5.^2.*theta6, -2.*theta3.*theta4.*theta5.*theta6, -theta3.^2.*theta5.*theta6, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta5.*theta6, -theta1.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.*theta6, zeroCol,];
        R5= [ zeroCol, zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta5.^2, zeroCol, -2.*theta1.^3.*theta5, zeroCol, -2.*theta2.^2.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta5.^2, zeroCol, -2.*theta2.^3.*theta5, zeroCol, -2.*theta3.^2.*theta5, zeroCol, zeroCol, zeroCol, -3.*theta3.^2.*theta5.^2, zeroCol, -2.*theta3.^3.*theta5, -2.*theta4.^2.*theta5, zeroCol, zeroCol, -3.*theta4.^2.*theta5.^2, zeroCol, -2.*theta4.^3.*theta5, zeroCol, zeroCol, -2.*theta5.*theta6.^2, -2.*theta5.*theta6.^3, -3.*theta5.^2.*theta6.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, zeroCol, -theta3, zeroCol, -theta4, zeroCol, -theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta5, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta5.^2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta5, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta5.^3, zeroCol, zeroCol, -3.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta3.*theta5, zeroCol, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta5.^3, zeroCol, zeroCol, -3.*theta3.*theta5.^2, zeroCol, -2.*theta4.*theta5, zeroCol, zeroCol, zeroCol, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta5.^3, zeroCol, -3.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta3.^4, -theta4.^3, zeroCol, -4.*theta4.*theta5.^3, zeroCol, -theta6.^2, zeroCol, zeroCol, -2.*theta5.*theta6, -theta4.^4, zeroCol, -theta6.^3, zeroCol, -3.*theta5.^2.*theta6, -theta6.^4, -4.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta5, zeroCol, zeroCol, -3.*theta5.^2, zeroCol, zeroCol, -4.*theta5.^3, zeroCol, -5.*theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta5, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, -3.*theta1.*theta2.*theta5.^2, zeroCol, zeroCol, -2.*theta1.*theta3.*theta5, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta5.^2, zeroCol, -2.*theta1.*theta4.*theta5, zeroCol, zeroCol, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, -2.*theta2.*theta3.*theta5, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, zeroCol, -theta1.^3.*theta3, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta1.*theta4.^3, -3.*theta2.*theta3.*theta5.^2, zeroCol, -2.*theta2.*theta4.*theta5, zeroCol, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, -theta1.*theta6.^2, zeroCol, -2.*theta1.*theta5.*theta6, zeroCol, -3.*theta2.*theta4.*theta5.^2, zeroCol, zeroCol, zeroCol, -theta2.*theta4.^3, -2.*theta3.*theta4.*theta5, -theta3.*theta4.^2, -theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta2.^3.*theta4, -theta3.^2.*theta4, -theta1.*theta6.^3, -3.*theta1.*theta5.^2.*theta6, zeroCol, -theta2.*theta6.^2, zeroCol, -2.*theta2.*theta5.*theta6, -3.*theta3.*theta4.*theta5.^2, zeroCol, zeroCol, -theta3.*theta4.^3, -theta1.^3.*theta6, -theta2.^2.*theta6, zeroCol, zeroCol, -theta3.^3.*theta4, -theta2.*theta6.^3, -3.*theta2.*theta5.^2.*theta6, zeroCol, -theta3.*theta6.^2, zeroCol, -2.*theta3.*theta5.*theta6, -theta2.^3.*theta6, -theta3.^2.*theta6, zeroCol, -theta3.*theta6.^3, -3.*theta3.*theta5.^2.*theta6, -theta4.*theta6.^2, -2.*theta4.*theta5.*theta6, -theta3.^3.*theta6, -theta4.^2.*theta6, -theta4.*theta6.^3, -3.*theta4.*theta5.^2.*theta6, -theta4.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta5, zeroCol, -2.*theta1.^2.*theta2.*theta5, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta5, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta5, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.^2.*theta5, zeroCol, -2.*theta1.^2.*theta4.*theta5, zeroCol, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta5, -theta2.^2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta4.^2.*theta5, zeroCol, zeroCol, zeroCol, -2.*theta2.^2.*theta4.*theta5, zeroCol, -theta2.^2.*theta4.^2, -2.*theta1.*theta5.*theta6.^2, zeroCol, -2.*theta3.*theta4.^2.*theta5, -theta1.^2.*theta6.^2, -2.*theta1.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.^2.*theta4.*theta5, -theta3.^2.*theta4.^2, -2.*theta2.*theta5.*theta6.^2, zeroCol, -theta2.^2.*theta6.^2, -2.*theta2.^2.*theta5.*theta6, zeroCol, zeroCol, -2.*theta3.*theta5.*theta6.^2, -theta3.^2.*theta6.^2, -2.*theta3.^2.*theta5.*theta6, -2.*theta4.*theta5.*theta6.^2, -theta4.^2.*theta6.^2, -2.*theta4.^2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, zeroCol, -theta2.*theta4, -theta1.*theta6, zeroCol, -theta3.*theta4, -theta2.*theta6, zeroCol, -theta3.*theta6, -theta4.*theta6, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta3.*theta4, -theta1.*theta2.*theta6, zeroCol, -theta2.*theta3.*theta4, -theta1.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6, -theta2.*theta3.*theta6, -theta2.*theta4.*theta6, -theta3.*theta4.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta4.^2, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.*theta5, -theta1.*theta3.*theta4.^2, zeroCol, -theta1.*theta3.^2.*theta4, zeroCol, -theta1.^2.*theta3.*theta4, -theta1.*theta2.*theta6.^2, -2.*theta1.*theta2.*theta5.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2.*theta6, zeroCol, -2.*theta2.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta2.*theta6, zeroCol, -theta2.^2.*theta3.*theta4, -theta1.*theta3.*theta6.^2, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.^2.*theta6, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3.*theta6, zeroCol, -theta1.*theta4.*theta6.^2, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.^2.*theta6, -theta2.*theta3.*theta6.^2, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.^2.*theta6, -theta1.^2.*theta4.*theta6, -theta2.^2.*theta3.*theta6, -theta2.*theta4.*theta6.^2, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.^2.*theta6, -theta2.^2.*theta4.*theta6, -theta3.*theta4.*theta6.^2, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.^2.*theta6, -theta3.^2.*theta4.*theta6, -theta1.*theta2.*theta3.*theta4, zeroCol, -theta1.*theta2.*theta3.*theta6, -theta1.*theta2.*theta4.*theta6, -theta1.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.*theta6, zeroCol,];
        R6= [ zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.^2.*theta6.^2, -2.*theta1.^3.*theta6, zeroCol, -2.*theta2.^2.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta2.^2.*theta6.^2, -2.*theta2.^3.*theta6, zeroCol, -2.*theta3.^2.*theta6, zeroCol, zeroCol, -3.*theta3.^2.*theta6.^2, -2.*theta3.^3.*theta6, zeroCol, -2.*theta4.^2.*theta6, zeroCol, -3.*theta4.^2.*theta6.^2, -2.*theta4.^3.*theta6, -2.*theta5.^2.*theta6, -3.*theta5.^2.*theta6.^2, -2.*theta5.^3.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta2, zeroCol, -theta3, zeroCol, -theta4, -theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta6, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta6.^2, zeroCol, zeroCol, -2.*theta2.*theta6, zeroCol, zeroCol, -theta1.^3, -theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta1.*theta6.^3, zeroCol, -3.*theta2.*theta6.^2, zeroCol, zeroCol, -2.*theta3.*theta6, zeroCol, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, -4.*theta2.*theta6.^3, zeroCol, -3.*theta3.*theta6.^2, zeroCol, -2.*theta4.*theta6, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, zeroCol, -4.*theta3.*theta6.^3, zeroCol, -3.*theta4.*theta6.^2, -2.*theta5.*theta6, -theta3.^4, -theta4.^3, -theta5.^2, zeroCol, -4.*theta4.*theta6.^3, -3.*theta5.*theta6.^2, -theta4.^4, -theta5.^3, -4.*theta5.*theta6.^3, -theta5.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta6, zeroCol, zeroCol, -3.*theta6.^2, zeroCol, -4.*theta6.^3, -5.*theta6.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta6, zeroCol, zeroCol, -theta1.*theta2.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta2.*theta6.^2, zeroCol, -2.*theta1.*theta3.*theta6, zeroCol, -theta1.*theta2.^3, -theta1.*theta3.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta3, zeroCol, -theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta3.*theta6.^2, zeroCol, -2.*theta1.*theta4.*theta6, -theta1.*theta3.^3, -theta1.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta3.*theta6, zeroCol, -theta2.*theta3.^2, zeroCol, zeroCol, -theta1.^2.*theta4, -theta1.^3.*theta3, zeroCol, -theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta1.*theta4.*theta6.^2, -2.*theta1.*theta5.*theta6, -theta1.*theta4.^3, -theta1.*theta5.^2, -3.*theta2.*theta3.*theta6.^2, zeroCol, -2.*theta2.*theta4.*theta6, -theta2.*theta3.^3, -theta2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta5, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.^3.*theta3, zeroCol, zeroCol, -3.*theta1.*theta5.*theta6.^2, -theta1.*theta5.^3, -3.*theta2.*theta4.*theta6.^2, -2.*theta2.*theta5.*theta6, -theta2.*theta4.^3, -theta2.*theta5.^2, zeroCol, -2.*theta3.*theta4.*theta6, -theta3.*theta4.^2, zeroCol, -theta1.^3.*theta5, -theta2.^2.*theta5, -theta2.^3.*theta4, -theta3.^2.*theta4, zeroCol, -3.*theta2.*theta5.*theta6.^2, -theta2.*theta5.^3, -3.*theta3.*theta4.*theta6.^2, -2.*theta3.*theta5.*theta6, -theta3.*theta4.^3, -theta3.*theta5.^2, -theta2.^3.*theta5, -theta3.^2.*theta5, -theta3.^3.*theta4, -3.*theta3.*theta5.*theta6.^2, -theta3.*theta5.^3, -2.*theta4.*theta5.*theta6, -theta4.*theta5.^2, -theta3.^3.*theta5, -theta4.^2.*theta5, -3.*theta4.*theta5.*theta6.^2, -theta4.*theta5.^3, -theta4.^3.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta2.*theta6, zeroCol, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.^2.*theta6, zeroCol, zeroCol, -2.*theta1.^2.*theta3.*theta6, zeroCol, -theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4.^2.*theta6, -2.*theta2.*theta3.^2.*theta6, zeroCol, -2.*theta1.^2.*theta4.*theta6, -theta1.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta6, zeroCol, -theta2.^2.*theta3.^2, zeroCol, -2.*theta1.*theta5.^2.*theta6, -2.*theta2.*theta4.^2.*theta6, zeroCol, -2.*theta1.^2.*theta5.*theta6, -theta1.^2.*theta5.^2, -2.*theta2.^2.*theta4.*theta6, -theta2.^2.*theta4.^2, zeroCol, zeroCol, -2.*theta2.*theta5.^2.*theta6, -2.*theta3.*theta4.^2.*theta6, -2.*theta2.^2.*theta5.*theta6, -theta2.^2.*theta5.^2, -2.*theta3.^2.*theta4.*theta6, -theta3.^2.*theta4.^2, -2.*theta3.*theta5.^2.*theta6, -2.*theta3.^2.*theta5.*theta6, -theta3.^2.*theta5.^2, -2.*theta4.*theta5.^2.*theta6, -2.*theta4.^2.*theta5.*theta6, -theta4.^2.*theta5.^2, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta2, zeroCol, zeroCol, -theta1.*theta3, zeroCol, zeroCol, -theta1.*theta4, -theta2.*theta3, zeroCol, -theta1.*theta5, -theta2.*theta4, zeroCol, -theta2.*theta5, -theta3.*theta4, -theta3.*theta5, -theta4.*theta5, zeroCol, zeroCol, -theta1.*theta2.*theta3, zeroCol, -theta1.*theta2.*theta4, zeroCol, -theta1.*theta2.*theta5, -theta1.*theta3.*theta4, zeroCol, -theta1.*theta3.*theta5, -theta2.*theta3.*theta4, -theta1.*theta4.*theta5, -theta2.*theta3.*theta5, -theta2.*theta4.*theta5, -theta3.*theta4.*theta5, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3.*theta6, zeroCol, -theta1.*theta2.*theta3.^2, zeroCol, -theta1.*theta2.^2.*theta3, zeroCol, -theta1.^2.*theta2.*theta3, zeroCol, -2.*theta1.*theta2.*theta4.*theta6, -theta1.*theta2.*theta4.^2, zeroCol, zeroCol, -theta1.*theta2.^2.*theta4, zeroCol, -theta1.^2.*theta2.*theta4, zeroCol, -2.*theta1.*theta2.*theta5.*theta6, -theta1.*theta2.*theta5.^2, -2.*theta1.*theta3.*theta4.*theta6, -theta1.*theta3.*theta4.^2, -theta1.*theta2.^2.*theta5, -theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta1.^2.*theta2.*theta5, -theta1.^2.*theta3.*theta4, zeroCol, -2.*theta1.*theta3.*theta5.*theta6, -theta1.*theta3.*theta5.^2, -theta1.*theta3.^2.*theta5, -2.*theta2.*theta3.*theta4.*theta6, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta1.^2.*theta3.*theta5, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta4.*theta5.*theta6, -theta1.*theta4.*theta5.^2, -theta1.*theta4.^2.*theta5, -2.*theta2.*theta3.*theta5.*theta6, -theta2.*theta3.*theta5.^2, -theta2.*theta3.^2.*theta5, -theta1.^2.*theta4.*theta5, -theta2.^2.*theta3.*theta5, -2.*theta2.*theta4.*theta5.*theta6, -theta2.*theta4.*theta5.^2, -theta2.*theta4.^2.*theta5, -theta2.^2.*theta4.*theta5, -2.*theta3.*theta4.*theta5.*theta6, -theta3.*theta4.*theta5.^2, -theta3.*theta4.^2.*theta5, -theta3.^2.*theta4.*theta5, zeroCol, -theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.*theta5, -theta1.*theta2.*theta4.*theta5, -theta1.*theta3.*theta4.*theta5, -theta2.*theta3.*theta4.*theta5, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;R5;R6;];
    case 108
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 109
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
        LMT = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot2.*theta4 + tdot4.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 5.*tdot4.*theta4.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;];
    case 110
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
        LMT = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot2.*theta4 + tdot4.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 5.*tdot4.*theta4.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;];
    case 111
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
        LMT = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot2.*theta4 + tdot4.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 5.*tdot4.*theta4.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;];
    case 112
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
        LMT = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot2.*theta4 + tdot4.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 5.*tdot4.*theta4.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;];
    case 113
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 114
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
            theta4=DOF(:, 4);
            tdot4=DOFVel(:, 4);
        LMT = [ theta1, theta2, theta3, theta4, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^2.*theta4.^2, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta1.^2.*theta4.^3, theta1.^3.*theta4.^2, theta2.^2.*theta3.^3, theta2.^2.*theta4.^2, theta2.^3.*theta3.^2, theta2.^2.*theta4.^3, theta2.^3.*theta4.^2, theta3.^2.*theta4.^2, theta3.^2.*theta4.^3, theta3.^3.*theta4.^2, theta1.*theta2, theta1.*theta3, theta1.*theta4, theta2.*theta3, theta2.*theta4, theta3.*theta4, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta1.*theta4.^2, theta2.*theta3.^2, theta1.^2.*theta4, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta1.*theta4.^3, theta2.*theta3.^3, theta2.*theta4.^2, theta1.^3.*theta4, theta2.^2.*theta4, theta1.^4.*theta3, theta2.^3.*theta3, theta1.*theta4.^4, theta2.*theta3.^4, theta2.*theta4.^3, theta3.*theta4.^2, theta1.^4.*theta4, theta2.^3.*theta4, theta3.^2.*theta4, theta2.^4.*theta3, theta2.*theta4.^4, theta3.*theta4.^3, theta2.^4.*theta4, theta3.^3.*theta4, theta3.*theta4.^4, theta3.^4.*theta4, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta4.^2, theta2.^5, theta3.^4, theta4.^3, theta3.^5, theta4.^4, theta4.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.*theta4.^2, theta1.*theta2.^2.*theta4, theta1.*theta2.^3.*theta3, theta1.^2.*theta2.*theta4, theta1.^3.*theta2.*theta3, theta1.*theta2.*theta4.^3, theta1.*theta3.*theta4.^2, theta1.*theta2.^3.*theta4, theta1.*theta3.^2.*theta4, theta1.^2.*theta3.*theta4, theta1.^3.*theta2.*theta4, theta1.*theta3.*theta4.^3, theta1.*theta3.^3.*theta4, theta2.*theta3.*theta4.^2, theta2.*theta3.^2.*theta4, theta1.^3.*theta3.*theta4, theta2.^2.*theta3.*theta4, theta2.*theta3.*theta4.^3, theta2.*theta3.^3.*theta4, theta2.^3.*theta3.*theta4, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.^2.*theta4.^2, theta1.^2.*theta2.*theta4.^2, theta1.^2.*theta2.^2.*theta4, theta1.*theta3.^2.*theta4.^2, theta1.^2.*theta3.*theta4.^2, theta1.^2.*theta3.^2.*theta4, theta2.*theta3.^2.*theta4.^2, theta2.^2.*theta3.*theta4.^2, theta2.^2.*theta3.^2.*theta4, theta1.*theta2.*theta3, theta1.*theta2.*theta4, theta1.*theta3.*theta4, theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4, theta1.*theta2.*theta3.*theta4.^2, theta1.*theta2.*theta3.^2.*theta4, theta1.*theta2.^2.*theta3.*theta4, theta1.^2.*theta2.*theta3.*theta4, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, tdot4, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot1.*theta1.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta4, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot1.*theta1.*theta4.^3 + 3.*tdot4.*theta1.^2.*theta4.^2, 2.*tdot4.*theta1.^3.*theta4 + 3.*tdot1.*theta1.^2.*theta4.^2, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta4, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, 2.*tdot2.*theta2.*theta4.^3 + 3.*tdot4.*theta2.^2.*theta4.^2, 2.*tdot4.*theta2.^3.*theta4 + 3.*tdot2.*theta2.^2.*theta4.^2, 2.*tdot3.*theta3.*theta4.^2 + 2.*tdot4.*theta3.^2.*theta4, 2.*tdot3.*theta3.*theta4.^3 + 3.*tdot4.*theta3.^2.*theta4.^2, 2.*tdot4.*theta3.^3.*theta4 + 3.*tdot3.*theta3.^2.*theta4.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot1.*theta4 + tdot4.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot2.*theta4 + tdot4.*theta2, tdot3.*theta4 + tdot4.*theta3, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot1.*theta4.^2 + 2.*tdot4.*theta1.*theta4, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot4.*theta1.^2 + 2.*tdot1.*theta1.*theta4, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot1.*theta4.^3 + 3.*tdot4.*theta1.*theta4.^2, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot2.*theta4.^2 + 2.*tdot4.*theta2.*theta4, tdot4.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta4, tdot4.*theta2.^2 + 2.*tdot2.*theta2.*theta4, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot1.*theta4.^4 + 4.*tdot4.*theta1.*theta4.^3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot2.*theta4.^3 + 3.*tdot4.*theta2.*theta4.^2, tdot3.*theta4.^2 + 2.*tdot4.*theta3.*theta4, tdot4.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta4, tdot4.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta4, tdot4.*theta3.^2 + 2.*tdot3.*theta3.*theta4, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, tdot2.*theta4.^4 + 4.*tdot4.*theta2.*theta4.^3, tdot3.*theta4.^3 + 3.*tdot4.*theta3.*theta4.^2, tdot4.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta4, tdot4.*theta3.^3 + 3.*tdot3.*theta3.^2.*theta4, tdot3.*theta4.^4 + 4.*tdot4.*theta3.*theta4.^3, tdot4.*theta3.^4 + 4.*tdot3.*theta3.^3.*theta4, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 2.*tdot4.*theta4, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 3.*tdot4.*theta4.^2, 5.*tdot3.*theta3.^4, 4.*tdot4.*theta4.^3, 5.*tdot4.*theta4.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.*theta4.^2 + tdot2.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta4, tdot1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta4, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta4, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta4.^3 + tdot2.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta2.*theta4.^2, tdot1.*theta3.*theta4.^2 + tdot3.*theta1.*theta4.^2 + 2.*tdot4.*theta1.*theta3.*theta4, tdot1.*theta2.^3.*theta4 + tdot4.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta4, tdot1.*theta3.^2.*theta4 + tdot4.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta3.*theta4, tdot3.*theta1.^2.*theta4 + tdot4.*theta1.^2.*theta3 + 2.*tdot1.*theta1.*theta3.*theta4, tdot2.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta4, tdot1.*theta3.*theta4.^3 + tdot3.*theta1.*theta4.^3 + 3.*tdot4.*theta1.*theta3.*theta4.^2, tdot1.*theta3.^3.*theta4 + tdot4.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2.*theta4, tdot2.*theta3.*theta4.^2 + tdot3.*theta2.*theta4.^2 + 2.*tdot4.*theta2.*theta3.*theta4, tdot2.*theta3.^2.*theta4 + tdot4.*theta2.*theta3.^2 + 2.*tdot3.*theta2.*theta3.*theta4, tdot3.*theta1.^3.*theta4 + tdot4.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.*theta4, tdot3.*theta2.^2.*theta4 + tdot4.*theta2.^2.*theta3 + 2.*tdot2.*theta2.*theta3.*theta4, tdot2.*theta3.*theta4.^3 + tdot3.*theta2.*theta4.^3 + 3.*tdot4.*theta2.*theta3.*theta4.^2, tdot2.*theta3.^3.*theta4 + tdot4.*theta2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^3.*theta4 + tdot4.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.^2.*theta4, tdot2.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta2.*theta4, tdot4.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta4 + 2.*tdot2.*theta1.^2.*theta2.*theta4, tdot1.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.*theta3.^2.*theta4, tdot3.*theta1.^2.*theta4.^2 + 2.*tdot1.*theta1.*theta3.*theta4.^2 + 2.*tdot4.*theta1.^2.*theta3.*theta4, tdot4.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta3.^2.*theta4 + 2.*tdot3.*theta1.^2.*theta3.*theta4, tdot2.*theta3.^2.*theta4.^2 + 2.*tdot3.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.*theta3.^2.*theta4, tdot3.*theta2.^2.*theta4.^2 + 2.*tdot2.*theta2.*theta3.*theta4.^2 + 2.*tdot4.*theta2.^2.*theta3.*theta4, tdot4.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta2.*theta3.^2.*theta4 + 2.*tdot3.*theta2.^2.*theta3.*theta4, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, tdot1.*theta2.*theta4 + tdot2.*theta1.*theta4 + tdot4.*theta1.*theta2, tdot1.*theta3.*theta4 + tdot3.*theta1.*theta4 + tdot4.*theta1.*theta3, tdot2.*theta3.*theta4 + tdot3.*theta2.*theta4 + tdot4.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4 + tdot2.*theta1.*theta3.*theta4 + tdot3.*theta1.*theta2.*theta4 + tdot4.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.*theta4.^2 + tdot2.*theta1.*theta3.*theta4.^2 + tdot3.*theta1.*theta2.*theta4.^2 + 2.*tdot4.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.*theta3.^2.*theta4 + tdot2.*theta1.*theta3.^2.*theta4 + tdot4.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3.*theta4, tdot1.*theta2.^2.*theta3.*theta4 + tdot3.*theta1.*theta2.^2.*theta4 + tdot4.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.*theta2.*theta3.*theta4, tdot2.*theta1.^2.*theta3.*theta4 + tdot3.*theta1.^2.*theta2.*theta4 + tdot4.*theta1.^2.*theta2.*theta3 + 2.*tdot1.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -2.*theta1.*theta4.^2, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.*theta4.^3, -3.*theta1.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2, -theta3, -theta4, zeroCol, zeroCol, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, -theta4.^2, zeroCol, -2.*theta1.*theta4, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta1.^2.*theta4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, -theta4.^4, zeroCol, zeroCol, zeroCol, -4.*theta1.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.*theta4.^2, -theta2.^2.*theta4, -theta2.^3.*theta3, -2.*theta1.*theta2.*theta4, -3.*theta1.^2.*theta2.*theta3, -theta2.*theta4.^3, -theta3.*theta4.^2, -theta2.^3.*theta4, -theta3.^2.*theta4, -2.*theta1.*theta3.*theta4, -3.*theta1.^2.*theta2.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.^2.*theta4.^2, -2.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.^2.*theta4, -theta3.^2.*theta4.^2, -2.*theta1.*theta3.*theta4.^2, -2.*theta1.*theta3.^2.*theta4, zeroCol, zeroCol, zeroCol, -theta2.*theta3, -theta2.*theta4, -theta3.*theta4, zeroCol, -theta2.*theta3.*theta4, -theta2.*theta3.*theta4.^2, -theta2.*theta3.^2.*theta4, -theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.*theta4, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, zeroCol, -2.*theta2.*theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3.^3, -2.*theta2.*theta4.^2, -3.*theta2.^2.*theta3.^2, -2.*theta2.*theta4.^3, -3.*theta2.^2.*theta4.^2, zeroCol, zeroCol, zeroCol, -theta1, zeroCol, zeroCol, -theta3, -theta4, zeroCol, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, zeroCol, -theta3.^2, zeroCol, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, zeroCol, -theta3.^3, -theta4.^2, zeroCol, -2.*theta2.*theta4, zeroCol, -3.*theta2.^2.*theta3, zeroCol, -theta3.^4, -theta4.^3, zeroCol, zeroCol, -3.*theta2.^2.*theta4, zeroCol, -4.*theta2.^3.*theta3, -theta4.^4, zeroCol, -4.*theta2.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -theta1.*theta4.^2, -2.*theta1.*theta2.*theta4, -3.*theta1.*theta2.^2.*theta3, -theta1.^2.*theta4, -theta1.^3.*theta3, -theta1.*theta4.^3, zeroCol, -3.*theta1.*theta2.^2.*theta4, zeroCol, zeroCol, -theta1.^3.*theta4, zeroCol, zeroCol, -theta3.*theta4.^2, -theta3.^2.*theta4, zeroCol, -2.*theta2.*theta3.*theta4, -theta3.*theta4.^3, -theta3.^3.*theta4, -3.*theta2.^2.*theta3.*theta4, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -2.*theta1.*theta2.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta2.*theta4, zeroCol, zeroCol, zeroCol, -theta3.^2.*theta4.^2, -2.*theta2.*theta3.*theta4.^2, -2.*theta2.*theta3.^2.*theta4, -theta1.*theta3, -theta1.*theta4, zeroCol, -theta3.*theta4, -theta1.*theta3.*theta4, -theta1.*theta3.*theta4.^2, -theta1.*theta3.^2.*theta4, -2.*theta1.*theta2.*theta3.*theta4, -theta1.^2.*theta3.*theta4, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, zeroCol, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, zeroCol, zeroCol, -3.*theta2.^2.*theta3.^2, zeroCol, -2.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta3.*theta4.^2, -2.*theta3.*theta4.^3, -3.*theta3.^2.*theta4.^2, zeroCol, -theta1, zeroCol, -theta2, zeroCol, -theta4, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, zeroCol, -2.*theta2.*theta3, zeroCol, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, zeroCol, -3.*theta2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta1.^4, -theta2.^3, zeroCol, -4.*theta2.*theta3.^3, zeroCol, -theta4.^2, zeroCol, zeroCol, -2.*theta3.*theta4, -theta2.^4, zeroCol, -theta4.^3, zeroCol, -3.*theta3.^2.*theta4, -theta4.^4, -4.*theta3.^3.*theta4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, zeroCol, -4.*theta3.^3, zeroCol, -5.*theta3.^4, zeroCol, zeroCol, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, zeroCol, zeroCol, -theta1.*theta2.^3, zeroCol, -theta1.^3.*theta2, zeroCol, -theta1.*theta4.^2, zeroCol, -2.*theta1.*theta3.*theta4, -theta1.^2.*theta4, zeroCol, -theta1.*theta4.^3, -3.*theta1.*theta3.^2.*theta4, -theta2.*theta4.^2, -2.*theta2.*theta3.*theta4, -theta1.^3.*theta4, -theta2.^2.*theta4, -theta2.*theta4.^3, -3.*theta2.*theta3.^2.*theta4, -theta2.^3.*theta4, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3.*theta4.^2, -theta1.^2.*theta4.^2, -2.*theta1.^2.*theta3.*theta4, -2.*theta2.*theta3.*theta4.^2, -theta2.^2.*theta4.^2, -2.*theta2.^2.*theta3.*theta4, -theta1.*theta2, zeroCol, -theta1.*theta4, -theta2.*theta4, -theta1.*theta2.*theta4, -theta1.*theta2.*theta4.^2, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.^2.*theta4, -theta1.^2.*theta2.*theta4, zeroCol,];
        R4= [ zeroCol, zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.^2.*theta4, zeroCol, zeroCol, -3.*theta1.^2.*theta4.^2, -2.*theta1.^3.*theta4, zeroCol, -2.*theta2.^2.*theta4, zeroCol, -3.*theta2.^2.*theta4.^2, -2.*theta2.^3.*theta4, -2.*theta3.^2.*theta4, -3.*theta3.^2.*theta4.^2, -2.*theta3.^3.*theta4, zeroCol, zeroCol, -theta1, zeroCol, -theta2, -theta3, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta4, zeroCol, -theta1.^2, zeroCol, zeroCol, zeroCol, zeroCol, -3.*theta1.*theta4.^2, zeroCol, -2.*theta2.*theta4, -theta1.^3, -theta2.^2, zeroCol, zeroCol, -4.*theta1.*theta4.^3, zeroCol, -3.*theta2.*theta4.^2, -2.*theta3.*theta4, -theta1.^4, -theta2.^3, -theta3.^2, zeroCol, -4.*theta2.*theta4.^3, -3.*theta3.*theta4.^2, -theta2.^4, -theta3.^3, -4.*theta3.*theta4.^3, -theta3.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta4, zeroCol, zeroCol, -3.*theta4.^2, zeroCol, -4.*theta4.^3, -5.*theta4.^4, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.*theta4, -theta1.*theta2.^2, zeroCol, -theta1.^2.*theta2, zeroCol, -3.*theta1.*theta2.*theta4.^2, -2.*theta1.*theta3.*theta4, -theta1.*theta2.^3, -theta1.*theta3.^2, -theta1.^2.*theta3, -theta1.^3.*theta2, -3.*theta1.*theta3.*theta4.^2, -theta1.*theta3.^3, -2.*theta2.*theta3.*theta4, -theta2.*theta3.^2, -theta1.^3.*theta3, -theta2.^2.*theta3, -3.*theta2.*theta3.*theta4.^2, -theta2.*theta3.^3, -theta2.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2.*theta4, -2.*theta1.^2.*theta2.*theta4, -theta1.^2.*theta2.^2, -2.*theta1.*theta3.^2.*theta4, -2.*theta1.^2.*theta3.*theta4, -theta1.^2.*theta3.^2, -2.*theta2.*theta3.^2.*theta4, -2.*theta2.^2.*theta3.*theta4, -theta2.^2.*theta3.^2, zeroCol, -theta1.*theta2, -theta1.*theta3, -theta2.*theta3, -theta1.*theta2.*theta3, -2.*theta1.*theta2.*theta3.*theta4, -theta1.*theta2.*theta3.^2, -theta1.*theta2.^2.*theta3, -theta1.^2.*theta2.*theta3, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;R4;];
    case 115
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 116
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
        LMT = [ theta1, theta2, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^3.*theta2.^2, theta1.*theta2, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.^4.*theta2, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta1.^5, theta2.^4, theta2.^5, onesCol,];
        VMT = [ tdot1, tdot2, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 5.*tdot2.*theta2.^4, zeroCol,];
        R1= [ -onesCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -3.*theta1.^2.*theta2.^2, -theta2, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -3.*theta1.^2.*theta2, -theta2.^4, -4.*theta1.^3.*theta2, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol,];
        R2= [ zeroCol, -onesCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, -2.*theta1.^3.*theta2, -theta1, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, -theta1.^3, -4.*theta1.*theta2.^3, -theta1.^4, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, -4.*theta2.^3, -5.*theta2.^4, zeroCol,];
        Mat = [LMT;VMT;R1;R2;];
    case 117
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
        LMT = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        VMT = [ tdot1, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 4.*tdot1.*theta1.^3, 5.*tdot1.*theta1.^4, zeroCol,];
        R1= [ -onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        Mat = [LMT;VMT;R1;];
    case 118
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
        LMT = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        VMT = [ tdot1, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 4.*tdot1.*theta1.^3, 5.*tdot1.*theta1.^4, zeroCol,];
        R1= [ -onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        Mat = [LMT;VMT;R1;];
    case 119
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
        LMT = [ theta1, theta1.^2, theta1.^3, theta1.^4, theta1.^5, onesCol,];
        VMT = [ tdot1, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 4.*tdot1.*theta1.^3, 5.*tdot1.*theta1.^4, zeroCol,];
        R1= [ -onesCol, -2.*theta1, -3.*theta1.^2, -4.*theta1.^3, -5.*theta1.^4, zeroCol,];
        Mat = [LMT;VMT;R1;];
    case 120
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 121
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 122
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 123
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 124
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 125
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 126
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 127
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 128
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 129
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 130
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 131
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 132
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 133
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 134
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 135
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 136
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 137
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 138
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 139
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 140
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 141
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 142
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 143
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 144
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 145
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 146
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 147
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    case 148
            theta1=DOF(:, 1);
            tdot1=DOFVel(:, 1);
            theta2=DOF(:, 2);
            tdot2=DOFVel(:, 2);
            theta3=DOF(:, 3);
            tdot3=DOFVel(:, 3);
        LMT = [ theta1, theta2, theta3, theta1.^2.*theta2.^2, theta1.^2.*theta2.^3, theta1.^2.*theta3.^2, theta1.^3.*theta2.^2, theta1.^2.*theta3.^3, theta1.^3.*theta3.^2, theta2.^2.*theta3.^2, theta2.^2.*theta3.^3, theta2.^3.*theta3.^2, theta1.*theta2, theta1.*theta3, theta2.*theta3, theta1.*theta2.^2, theta1.^2.*theta2, theta1.*theta2.^3, theta1.*theta3.^2, theta1.^2.*theta3, theta1.^3.*theta2, theta1.*theta2.^4, theta1.*theta3.^3, theta2.*theta3.^2, theta1.^3.*theta3, theta2.^2.*theta3, theta1.^4.*theta2, theta1.*theta3.^4, theta2.*theta3.^3, theta1.^4.*theta3, theta2.^3.*theta3, theta2.*theta3.^4, theta2.^4.*theta3, theta1.^2, theta1.^3, theta2.^2, theta1.^4, theta2.^3, theta3.^2, theta1.^5, theta2.^4, theta3.^3, theta2.^5, theta3.^4, theta3.^5, theta1.*theta2.*theta3.^2, theta1.*theta2.^2.*theta3, theta1.^2.*theta2.*theta3, theta1.*theta2.*theta3.^3, theta1.*theta2.^3.*theta3, theta1.^3.*theta2.*theta3, theta1.*theta2.^2.*theta3.^2, theta1.^2.*theta2.*theta3.^2, theta1.^2.*theta2.^2.*theta3, theta1.*theta2.*theta3, onesCol,];
        VMT = [ tdot1, tdot2, tdot3, 2.*tdot1.*theta1.*theta2.^2 + 2.*tdot2.*theta1.^2.*theta2, 2.*tdot1.*theta1.*theta2.^3 + 3.*tdot2.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta3, 2.*tdot2.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.^2, 2.*tdot1.*theta1.*theta3.^3 + 3.*tdot3.*theta1.^2.*theta3.^2, 2.*tdot3.*theta1.^3.*theta3 + 3.*tdot1.*theta1.^2.*theta3.^2, 2.*tdot2.*theta2.*theta3.^2 + 2.*tdot3.*theta2.^2.*theta3, 2.*tdot2.*theta2.*theta3.^3 + 3.*tdot3.*theta2.^2.*theta3.^2, 2.*tdot3.*theta2.^3.*theta3 + 3.*tdot2.*theta2.^2.*theta3.^2, tdot1.*theta2 + tdot2.*theta1, tdot1.*theta3 + tdot3.*theta1, tdot2.*theta3 + tdot3.*theta2, tdot1.*theta2.^2 + 2.*tdot2.*theta1.*theta2, tdot2.*theta1.^2 + 2.*tdot1.*theta1.*theta2, tdot1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2, tdot1.*theta3.^2 + 2.*tdot3.*theta1.*theta3, tdot3.*theta1.^2 + 2.*tdot1.*theta1.*theta3, tdot2.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta2, tdot1.*theta2.^4 + 4.*tdot2.*theta1.*theta2.^3, tdot1.*theta3.^3 + 3.*tdot3.*theta1.*theta3.^2, tdot2.*theta3.^2 + 2.*tdot3.*theta2.*theta3, tdot3.*theta1.^3 + 3.*tdot1.*theta1.^2.*theta3, tdot3.*theta2.^2 + 2.*tdot2.*theta2.*theta3, tdot2.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta2, tdot1.*theta3.^4 + 4.*tdot3.*theta1.*theta3.^3, tdot2.*theta3.^3 + 3.*tdot3.*theta2.*theta3.^2, tdot3.*theta1.^4 + 4.*tdot1.*theta1.^3.*theta3, tdot3.*theta2.^3 + 3.*tdot2.*theta2.^2.*theta3, tdot2.*theta3.^4 + 4.*tdot3.*theta2.*theta3.^3, tdot3.*theta2.^4 + 4.*tdot2.*theta2.^3.*theta3, 2.*tdot1.*theta1, 3.*tdot1.*theta1.^2, 2.*tdot2.*theta2, 4.*tdot1.*theta1.^3, 3.*tdot2.*theta2.^2, 2.*tdot3.*theta3, 5.*tdot1.*theta1.^4, 4.*tdot2.*theta2.^3, 3.*tdot3.*theta3.^2, 5.*tdot2.*theta2.^4, 4.*tdot3.*theta3.^3, 5.*tdot3.*theta3.^4, tdot1.*theta2.*theta3.^2 + tdot2.*theta1.*theta3.^2 + 2.*tdot3.*theta1.*theta2.*theta3, tdot1.*theta2.^2.*theta3 + tdot3.*theta1.*theta2.^2 + 2.*tdot2.*theta1.*theta2.*theta3, tdot2.*theta1.^2.*theta3 + tdot3.*theta1.^2.*theta2 + 2.*tdot1.*theta1.*theta2.*theta3, tdot1.*theta2.*theta3.^3 + tdot2.*theta1.*theta3.^3 + 3.*tdot3.*theta1.*theta2.*theta3.^2, tdot1.*theta2.^3.*theta3 + tdot3.*theta1.*theta2.^3 + 3.*tdot2.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^3.*theta3 + tdot3.*theta1.^3.*theta2 + 3.*tdot1.*theta1.^2.*theta2.*theta3, tdot1.*theta2.^2.*theta3.^2 + 2.*tdot2.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.*theta2.^2.*theta3, tdot2.*theta1.^2.*theta3.^2 + 2.*tdot1.*theta1.*theta2.*theta3.^2 + 2.*tdot3.*theta1.^2.*theta2.*theta3, tdot3.*theta1.^2.*theta2.^2 + 2.*tdot1.*theta1.*theta2.^2.*theta3 + 2.*tdot2.*theta1.^2.*theta2.*theta3, tdot1.*theta2.*theta3 + tdot2.*theta1.*theta3 + tdot3.*theta1.*theta2, zeroCol,];
        R1= [ -onesCol, zeroCol, zeroCol, -2.*theta1.*theta2.^2, -2.*theta1.*theta2.^3, -2.*theta1.*theta3.^2, -3.*theta1.^2.*theta2.^2, -2.*theta1.*theta3.^3, -3.*theta1.^2.*theta3.^2, zeroCol, zeroCol, zeroCol, -theta2, -theta3, zeroCol, -theta2.^2, -2.*theta1.*theta2, -theta2.^3, -theta3.^2, -2.*theta1.*theta3, -3.*theta1.^2.*theta2, -theta2.^4, -theta3.^3, zeroCol, -3.*theta1.^2.*theta3, zeroCol, -4.*theta1.^3.*theta2, -theta3.^4, zeroCol, -4.*theta1.^3.*theta3, zeroCol, zeroCol, zeroCol, -2.*theta1, -3.*theta1.^2, zeroCol, -4.*theta1.^3, zeroCol, zeroCol, -5.*theta1.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -theta2.*theta3.^2, -theta2.^2.*theta3, -2.*theta1.*theta2.*theta3, -theta2.*theta3.^3, -theta2.^3.*theta3, -3.*theta1.^2.*theta2.*theta3, -theta2.^2.*theta3.^2, -2.*theta1.*theta2.*theta3.^2, -2.*theta1.*theta2.^2.*theta3, -theta2.*theta3, zeroCol,];
        R2= [ zeroCol, -onesCol, zeroCol, -2.*theta1.^2.*theta2, -3.*theta1.^2.*theta2.^2, zeroCol, -2.*theta1.^3.*theta2, zeroCol, zeroCol, -2.*theta2.*theta3.^2, -2.*theta2.*theta3.^3, -3.*theta2.^2.*theta3.^2, -theta1, zeroCol, -theta3, -2.*theta1.*theta2, -theta1.^2, -3.*theta1.*theta2.^2, zeroCol, zeroCol, -theta1.^3, -4.*theta1.*theta2.^3, zeroCol, -theta3.^2, zeroCol, -2.*theta2.*theta3, -theta1.^4, zeroCol, -theta3.^3, zeroCol, -3.*theta2.^2.*theta3, -theta3.^4, -4.*theta2.^3.*theta3, zeroCol, zeroCol, -2.*theta2, zeroCol, -3.*theta2.^2, zeroCol, zeroCol, -4.*theta2.^3, zeroCol, -5.*theta2.^4, zeroCol, zeroCol, -theta1.*theta3.^2, -2.*theta1.*theta2.*theta3, -theta1.^2.*theta3, -theta1.*theta3.^3, -3.*theta1.*theta2.^2.*theta3, -theta1.^3.*theta3, -2.*theta1.*theta2.*theta3.^2, -theta1.^2.*theta3.^2, -2.*theta1.^2.*theta2.*theta3, -theta1.*theta3, zeroCol,];
        R3= [ zeroCol, zeroCol, -onesCol, zeroCol, zeroCol, -2.*theta1.^2.*theta3, zeroCol, -3.*theta1.^2.*theta3.^2, -2.*theta1.^3.*theta3, -2.*theta2.^2.*theta3, -3.*theta2.^2.*theta3.^2, -2.*theta2.^3.*theta3, zeroCol, -theta1, -theta2, zeroCol, zeroCol, zeroCol, -2.*theta1.*theta3, -theta1.^2, zeroCol, zeroCol, -3.*theta1.*theta3.^2, -2.*theta2.*theta3, -theta1.^3, -theta2.^2, zeroCol, -4.*theta1.*theta3.^3, -3.*theta2.*theta3.^2, -theta1.^4, -theta2.^3, -4.*theta2.*theta3.^3, -theta2.^4, zeroCol, zeroCol, zeroCol, zeroCol, zeroCol, -2.*theta3, zeroCol, zeroCol, -3.*theta3.^2, zeroCol, -4.*theta3.^3, -5.*theta3.^4, -2.*theta1.*theta2.*theta3, -theta1.*theta2.^2, -theta1.^2.*theta2, -3.*theta1.*theta2.*theta3.^2, -theta1.*theta2.^3, -theta1.^3.*theta2, -2.*theta1.*theta2.^2.*theta3, -2.*theta1.^2.*theta2.*theta3, -theta1.^2.*theta2.^2, -theta1.*theta2, zeroCol,];
        Mat = [LMT;VMT;R1;R2;R3;];
    end
end