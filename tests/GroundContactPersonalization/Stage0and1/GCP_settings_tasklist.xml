<?xml version="1.0" encoding="UTF-8" ?>
<OpenSimDocument Version="40000">
    <GroundContactPersonalizationTool>
        <!--Directory used for writing results.-->
        <results_directory/>
        <!--Directory for input files-->
        <input_directory/>
        <!--Name of the input model file (.osim) to use-->
        <input_model_file>optModel_v6_correct_height.osim</input_model_file>
		<!--Name of the foot model file (.osim), will be generated automatically in final version-->
		<input_foot_model_file>footModel.osim</input_foot_model_file>
		<!--Name of the input motion file (.mot) to use-->
        <input_motion_file>CPRIT_Patient3_NormalGait_1pt0_01_Right_75_ik.mot</input_motion_file>
		<!--Name of the input ground reaction forces file (.mot) to use-->
        <input_grf_file>CPRIT_Patient3_NormalGait_1pt0_01_Right_75_GRF.mot</input_grf_file>
		<!--*Optional* The number of nodes per gait cycle used to define motion using B-splines-->
		<nodes_per_cycle>25</nodes_per_cycle>
		<!--Speed of treadmill belt for recorded motion. Set to 0 if not applicable-->
		<belt_speed>1</belt_speed>
		<!--Settings for ground contact personalization on the right side-->
		<FootPersonalizationTaskList>
			<FootPersonalizationTask>
				<!--Flag indicating whether the foot will be personalized-->
				<is_enabled>true</is_enabled>
				<!--Index of task used to determine order of tasks-->
				<index>1</index>
				<!--Flag indicating whether this is a left foot-->
				<is_left_foot>false</is_left_foot>
				<!--Start time for right side gait cycles in motion and ground reaction force files-->
				<start_time>81.181</start_time>
				<!--End time for motion and ground reaction force files-->
				<end_time>82.286</end_time>
				<!--Names of the force columns in the grf file, ordered X, Y, Z-->
				<force_columns>F2x F2y F2z</force_columns>
				<!--Names of the moment columns in the grf file, ordered X, Y, Z-->
				<moment_columns>M2x M2y M2z</moment_columns>
				<!--Names of the electrical center columns in the grf file, ordered X, Y, Z-->
				<electrical_center_columns>EC2x EC2y EC2z</electrical_center_columns>
				<!--Name of the toe angle coordinate in the model file-->
				<toe_coordinate>mtp_angle_r</toe_coordinate>
				<!--Name of the toe joint in the model file-->
				<toe_joint>mtp_r</toe_joint>
				<!--Names of the markers used to define the foot area-->
				<toe_marker>R.Toe</toe_marker>
				<medial_marker>R.Toe.Medial</medial_marker>
				<lateral_marker>R.Toe.Lateral</lateral_marker>
				<heel_marker>R.Heel</heel_marker>
				<!--Name of midfoot superior marker used to define ground reaction moments-->
				<midfoot_superior_marker>R.Midfoot.Superior</midfoot_superior_marker>
			</FootPersonalizationTask>
			<FootPersonalizationTask>
				<!--Flag indicating whether the foot will be personalized-->
				<is_enabled>true</is_enabled>
				<!--Index of task used to determine order of tasks-->
				<index>2</index>
				<!--Flag indicating whether this is a left foot-->
				<is_left_foot>true</is_left_foot>
				<!--Start time for motion and ground reaction force files-->
				<start_time>81.181</start_time>
				<!--End time for right side gait cycles in motion and ground reaction force files-->
				<end_time>82.286</end_time>
				<!--Names of the force columns in the grf file, ordered X, Y, Z-->
				<force_columns>F1x F1y F1z</force_columns>
				<!--Names of the moment columns in the grf file, ordered X, Y, Z-->
				<moment_columns>M1x M1y M1z</moment_columns>
				<!--Names of the electrical center columns in the grf , ordered X, Y, Z-->
				<electrical_center_columns>EC1x EC1y EC1z</electrical_center_columns>
				<!--Name of the toe angle coordinate in the model file-->
				<toe_coordinate>mtp_angle_l</toe_coordinate>
				<!--Name of the toe joint in the model file-->
				<toe_joint>mtp_l</toe_joint>
				<!--Names of the markers used to define the foot area-->
				<toe_marker>L.Toe</toe_marker>
				<medial_marker>L.Toe.Medial</medial_marker>
				<lateral_marker>L.Toe.Lateral</lateral_marker>
				<heel_marker>L.Heel</heel_marker>
				<!--Name of midfoot superior marker used to define ground reaction moments-->
				<midfoot_superior_marker>L.Midfoot.Superior</midfoot_superior_marker>
			</FootPersonalizationTask>
		</FootPersonalizationTaskList>
		<GroundContactPersonalizationTaskList>
			<GroundContactPersonalizationTask>
                <!--Flag indicating whether or not the task is enabled.-->
                <is_enabled>true</is_enabled>
				<!--Index of task used to determine order of tasks-->
				<index>1</index>
				<!--Settings for design variables for the task-->
				<DesignVariables>
					<!--Stiffness values specific to each point of contact-->
					<springConstants>true</springConstants>
					<!--Damping factor-->
					<dampingFactor>false</dampingFactor>
					<!--Dynamic friction coefficient used in calculating horizontal ground reaction forces-->
					<dynamicFrictionCoefficient>true</dynamicFrictionCoefficient>
					<!--Height value at which linear springs exert force. Only recommended when primarily calibrating vertical force-->
					<restingSpringLength>true</restingSpringLength>
					<!--Coefficients allowing for adjustments to kinematics during optimization-->
					<kinematicsBSplineCoefficients>true</kinematicsBSplineCoefficients>
				</DesignVariables>
				<!--Settings for cost function terms for the task-->
				<CostFunctionTerms>
					<markerPositionError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>false</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>0.02</max_allowable_error>
					</markerPositionError>
					<rotationError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>4</max_allowable_error>
					</rotationError>
					<translationError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>0.01</max_allowable_error>
					</translationError>
					<coordinateCoefficientError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>false</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>0.01</max_allowable_error>
					</coordinateCoefficientError>
					<verticalGrfError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>5</max_allowable_error>
					</verticalGrfError>
					<horizontalGrfError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>20</max_allowable_error>
					</horizontalGrfError>
					<groundReactionMomentError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>10</max_allowable_error>
					</groundReactionMomentError>
					<springConstantErrorFromMean>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>false</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>2000</max_allowable_error>
					</springConstantErrorFromMean>
					<springConstantErrorFromNeighbors>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>2000</max_allowable_error>
					</springConstantErrorFromNeighbors>
				</CostFunctionTerms>
			</GroundContactPersonalizationTask>
			<GroundContactPersonalizationTask>
                <!--Flag indicating whether or not the task is enabled.-->
                <is_enabled>true</is_enabled>
				<!--Index of task used to determine order of tasks-->
				<index>1</index>
				<!--Settings for design variables for the task-->
				<DesignVariables>
					<!--Stiffness values specific to each point of contact-->
					<springConstants>true</springConstants>
					<!--Damping factor-->
					<dampingFactor>false</dampingFactor>
					<!--Dynamic friction coefficient used in calculating horizontal ground reaction forces-->
					<dynamicFrictionCoefficient>true</dynamicFrictionCoefficient>
					<!--Height value at which linear springs exert force. Only recommended when primarily calibrating vertical force-->
					<restingSpringLength>false</restingSpringLength>
					<!--Coefficients allowing for adjustments to kinematics during optimization-->
					<kinematicsBSplineCoefficients>true</kinematicsBSplineCoefficients>
				</DesignVariables>
				<!--Settings for cost function terms for the task-->
				<CostFunctionTerms>
					<markerPositionError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>false</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>0.02</max_allowable_error>
					</markerPositionError>
					<rotationError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>4</max_allowable_error>
					</rotationError>
					<translationError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>0.01</max_allowable_error>
					</translationError>
					<coordinateCoefficientError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>false</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>0.01</max_allowable_error>
					</coordinateCoefficientError>
					<verticalGrfError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>5</max_allowable_error>
					</verticalGrfError>
					<horizontalGrfError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>5</max_allowable_error>
					</horizontalGrfError>
					<groundReactionMomentError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>10</max_allowable_error>
					</groundReactionMomentError>
					<springConstantErrorFromMean>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>false</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>2000</max_allowable_error>
					</springConstantErrorFromMean>
					<springConstantErrorFromNeighbors>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>2000</max_allowable_error>
					</springConstantErrorFromNeighbors>
				</CostFunctionTerms>
			</GroundContactPersonalizationTask>
			<GroundContactPersonalizationTask>
                <!--Flag indicating whether or not the task is enabled.-->
                <is_enabled>true</is_enabled>
				<!--Index of task used to determine order of tasks-->
				<index>1</index>
				<!--Settings for design variables for the task-->
				<DesignVariables>
					<!--Stiffness values specific to each point of contact-->
					<springConstants>true</springConstants>
					<!--Damping factor-->
					<dampingFactor>false</dampingFactor>
					<!--Dynamic friction coefficient used in calculating horizontal ground reaction forces-->
					<dynamicFrictionCoefficient>true</dynamicFrictionCoefficient>
					<!--Height value at which linear springs exert force. Only recommended when primarily calibrating vertical force-->
					<restingSpringLength>false</restingSpringLength>
					<!--Coefficients allowing for adjustments to kinematics during optimization-->
					<kinematicsBSplineCoefficients>true</kinematicsBSplineCoefficients>
				</DesignVariables>
				<!--Settings for cost function terms for the task-->
				<CostFunctionTerms>
					<markerPositionError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>false</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>0.02</max_allowable_error>
					</markerPositionError>
					<markerSlopeError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>false</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>0.1</max_allowable_error>
					</markerSlopeError>
					<rotationError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>4</max_allowable_error>
					</rotationError>
					<translationError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>0.01</max_allowable_error>
					</translationError>
					<coordinateCoefficientError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>false</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>0.001</max_allowable_error>
					</coordinateCoefficientError>
					<verticalGrfError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>5</max_allowable_error>
					</verticalGrfError>
					<verticalGrfSlopeError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>false</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>10</max_allowable_error>
					</verticalGrfSlopeError>
					<horizontalGrfError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>5</max_allowable_error>
					</horizontalGrfError>
					<horizontalGrfSlopeError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>false</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>10</max_allowable_error>
					</horizontalGrfSlopeError>
					<groundReactionMomentError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>2</max_allowable_error>
					</groundReactionMomentError>
					<groundReactionMomentSlopeError>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>false</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>10</max_allowable_error>
					</groundReactionMomentSlopeError>
					<springConstantErrorFromMean>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>false</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>2000</max_allowable_error>
					</springConstantErrorFromMean>
					<springConstantErrorFromNeighbors>
						<!--Flag indicating whether or not the term is enabled in the cost function.-->
						<is_enabled>true</is_enabled>
						<!--Max allowable error or deviation from indicated set point-->
						<max_allowable_error>2000</max_allowable_error>
					</springConstantErrorFromNeighbors>
				</CostFunctionTerms>
			</GroundContactPersonalizationTask>
		</GroundContactPersonalizationTaskList>
		<!--Initial values of design variables-->
		<InitialValues>
			<RestingSpringLength>0.05</RestingSpringLength>
			<SpringConstants>2500</SpringConstants>
			<DampingFactor>1e-4</DampingFactor>
			<DynamicFrictionCoefficient>0.25</DynamicFrictionCoefficient>
		</InitialValues>
        <!--*Optional* The number of allowed iterations of the lsqnonlin optimization, setting this lower can help cancel an optimization that won't converge-->
        <max_iterations>1e3</max_iterations>
		<!--*Optional* The number of allowed cost function calls for the lsqnonlin optimization, setting this lower can help cancel an optimization that won't converge-->
        <max_function_evaluations>3e6</max_function_evaluations>
    </GroundContactPersonalizationTool>
</OpenSimDocument>